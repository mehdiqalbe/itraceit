<div class="row">
    <div class="col-lg-12">
    
    
 <!-- Header Start -->
 <div class="card" style="box-shadow: none;background: #F1F1F1;border:none">
  <div class="card-body innerdiv p-0">
    <!-- headerstart here -->
    <div class="hor-header">
      <div style="overflow: hidden;">
        <div class="row align-items-left ">
          <div style="width:fit-content" class=" my-2 d-flex">
            <button class="app-sidebar__toggle ms-1 " (click)="sidebarToggle()"></button>
          </div>
         
          <div
          class="col-lg-11"
          style="
            font-weight: 600;
            font-size: small;
            text-align: left;
           
          "
        >
        <div  class="order-header col-lg-11 py-2" >
          <h3 style="color: #1D4380;font-family:'Work Sans';font-size: 27px!important;font-weight: 600;" class=" mb-1">
            Irun Dashboard</h3>
          <h5 style="color: #808080;font-family:'Work Sans';font-size: 15px!important;font-weight: 500;">Home / Irun Dashboard</h5>

          
       
        </div>
        
        </div>
          <div class="col-lg-2 text-center ">

          </div>

          <div class="col-lg-1"></div>
          <div class="col-lg-1">
            <!-- <a  routerLink="/ILgic/createTrip"><i class="fa fa-plus-circle" aria-hidden="true" style="font-size: 20px;color: #1D4380;"></i></a>  -->
          </div>
          <div class="col-lg-1 text-center">
            <!-- <a class="header-brand1">
              <img src="assets/images/itraceit_logo1.png" alt="ILGIC Logo" class="header-brand-img desktop-logo"
                style="height:auto;max-height:48px; width: 80%;">
            </a> -->
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- HEADER END -->
      
      <div class="container-flex" style=" padding: 9px;    border-bottom: 1px solid #80808042;">
  
        <div class="row">
  
          <!-- <div class="col-lg-12"> -->
          <div class="col-lg-1">
            <div class="row" style="display: inline-block;">
              <a data-bs-toggle="collapse" data-bs-target="#collapseExample" role="button" aria-expanded="false"
                aria-controls="collapseExample" style="font-size: 13px;font-weight: 500;">
                <i class="fa fa-filter" aria-hidden="true"
                  style="font-size: 20px;color: gray ;margin-top: 8px;"></i>FILTER
              </a>
            </div>
          </div>
          <div class="col-lg-5">
            <div class="row" style="display: inline-block;">
              <div class="viewall">
                <ng-container *ngFor="let data of alert_keys;ind">
                <div class="dropdown" id="searchDropdown">
                  <button class=" dropdown-toggle viewall-icon" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown"
                  aria-expanded="false">
                  <img  [src]="getIconUrlByTitle(data)" class="img-view">
                </button>
                <ul class="dropdown-menu scrollable" aria-labelledby="dropdownMenuButton" id="myDropdownroute">
                  <li style="font-weight: bold;">{{data}}</li>
                  <li _ngcontent-mrr-c230=""> 
                    <a class="dropdown-item a-score" (click)="filterAlerts(data,30,0)">
                      &lt; 30 Minutes
                      <div class="score-show" style="background: #E77817;">{{alert_dashboard[data]?.min_30}}</div>
                    </a>
                  </li>
                
                  <li><a class="dropdown-item  a-score" (click)="filterAlerts(data,60,30)">
                      < 1 Hours <div class="score-show" style="background:#1D4380 ;">{{alert_dashboard[data]?.hr_1}}
                        </div>
                    </a>
                  </li>
                  <li><a class="dropdown-item  a-score" (click)="filterAlerts(data,120,60)">
                      < 2 Hours <div class="score-show" style="background: #00C0F3;">{{alert_dashboard[data]?.hr_2}}
                        </div>
                    </a>
                  </li>
                  <li><a class="dropdown-item  a-score" (click)="filterAlerts(data,180,120)">
                      < 4 Hours <div class="score-show" style="background: #F4858E;">{{alert_dashboard[data]?.hr_3}}
                        </div>
                    </a>
                  </li>
                  <li><a class="dropdown-item  a-score" (click)="filterAlerts(data,240,180)">
                      > 4 Hours
                      <div class="score-show" style="background: #917BB9;">{{alert_dashboard[data]?.hr_4}}</div>
                    </a>
                  </li>
                </ul>
          </div>
                </ng-container>
  <div class="dropdown" id="searchDropdown">
    <button class=" dropdown-toggle viewall-icon" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown"
      aria-expanded="false" (click)="viewmodal()" data-bs-toggle="modal" data-bs-target="#ViewModal">
      <img src="assets/IRUN_CV_IMG/ViewAll.svg" class="img-view" style="height: 27px; width: 53px;margin-top: 4px;">
      <!-- <div> View All</div> -->
    </button>
  </div>
  </div>
  </div>
  </div>
  <div class="col-lg-5" style="padding:0px">
    <div class="row" style="display: inline-block;">
      <span class="fa-stack" style="display: inline-block;margin-top: 5px;">
  
        <button type="button" class="text-dark" tooltipClass="customInactive-tooltip-class" (click)="dashBoardIconF(2)"
          ngbTooltip="NOD" id="nod" value="3"><i class="fe fe-truck" style="font-size: 20px;" id="blink"></i><span
            class="badge rounded-pill badge-notification bg-dark" id="darkicon">{{summaryData.NOD}}</span></button>
  
        <button type="button" class="text-dark" tooltipClass="customActive-tooltip-class" (click)="dashBoardIconF(3)"
          ngbTooltip="InActive"><i class="fe fe-truck" style="font-size: 20px; color:blue" id="blink"></i><span
            class="badge rounded-pill badge-notification bg-primary"
            id="darkicon">{{summaryData.InActive}}</span></button>
        <button type="button" class="text-dark" tooltipClass="customIRunning-tooltip-class" (click)="dashBoardIconF(1)"
          ngbTooltip="Running"><i class="fe fe-truck" style="font-size: 20px;color: green;" id="blink"></i><span
            class="badge rounded-pill badge-notification bg-success" id="darkicon">{{summaryData.Running}}</span></button>
        <button type="button" class="text-dark" tooltipClass="customInStopped-tooltip-class" (click)="dashBoardIconF(0)"
          ngbTooltip="Stopped"><i class="fe fe-truck" style="font-size: 20px;color: red" id="blink"
            [ngbPopover]="popContentstopped" container="body" triggers="mouseenter:mouseleave" position="bottom">
  
            <ng-template #popContentstopped>
              <div class=" " style=" height: 150px;top:0px !important;border: 1px grey;">
                <h5 style="font-weight: 600; color: red;text-align: center;"> Alerts
                </h5>
  
                <table>
                  <tr>
                    <th>Trigger</th>
                    <th>Total</th>
  
                  </tr>
                  <!-- <ng-template *ngFor="let item of stock"> -->
                  <tr style="color: blue;font-size: 12px;font-weight: 700;"
                    *ngFor="let item of LastAlertSummery.Stop |keyvalue">
                    <td>{{item.key}}</td>
                    <td>{{item.value}}</td>
  
                  </tr>
  
                </table>
              </div>
            </ng-template>
  
  
          </i><span class="badge rounded-pill badge-notification bg-danger"
            id="darkicon">{{summaryData.Stop}}</span></button>
        <button type="button" class="text-dark" tooltipClass="customTotal-tooltip-class"
          (click)="dashBoardIconF('Total Vehicles')" ngbTooltip="Total Vehicles"><i class="fe fe-truck"
            style="font-size: 20px;color: grey;" id="blink" (mouseenter)="tInActiveOver($event)"
            (mouseleave)="tInActiveOut($event)"></i><span class="badge rounded-pill badge-notification bg-secondary"
            id="inActive">{{summaryData.All}}</span></button>
  
  
        <button type="button" class="text-dark" data-bs-toggle="modal" data-bs-target="#triggerModal"
          (click)="totaltriggerF()"><i class="fe fe-bell" style="font-size: 20px;color: red"
            (mouseenter)="bellOver($event)" (mouseleave)="bellOut($event)" id="bell" [ngbPopover]="popContent"
            container="body" triggers="mouseenter:mouseleave" position="bottom">
  
            <ng-template #popContent>
              <div class=" " style=" height: 150px;top:0px !important;border: 1px grey;">
                <h5 style="font-weight: 400; color: black;text-align: center;"> Trigger Summary
                </h5>
  
                <table>
                  <tr>
                    <th>Trigger</th>
                    <th>Total</th>
  
                  </tr>
                  <!-- <ng-template *ngFor="let item of stock"> -->
                  <tr style="color: blue;font-size: 12px;font-weight: 700;" *ngFor="let item of stock |keyvalue">
                    <td>{{item.key}}</td>
                    <td>{{item.value}}</td>
  
                  </tr>
  
                </table>
              </div>
            </ng-template>
  
  
  
          </i><span class="badge rounded-pill badge-notification bg-danger"
            id="bellBadge">{{triggerData.Total}}</span></button>
  
  
  
  
        <button type="button" class="text-dark" tooltipClass="customInStopped-tooltip-class"
          (click)="threatTablefilter('')" data-bs-toggle="modal" data-bs-target="#threatsModal"
          ngbTooltip="All Threats"><i class="fa fa-exclamation-triangle" style="font-size: 20px;color: red"
            id="blink"></i><span class="badge rounded-pill badge-notification bg-danger"
            id="darkicon">{{totalThreat}}</span></button>
  
        <button type="button" class="text-dark" tooltipClass="customIRunning-tooltip-class" ngbTooltip="Refresh Page"
          (click)="triggerFullData();dashboardData1();threatDataF();qrtList();"><i class="fa fa-refresh"
            style="font-size: 20px;color: green" id="blink"></i>
        </button>
  
        <button type="button" class="text-dark" (click)="playAudio()"><i class="fa fa-volume-up" *ngIf="soundFlag"
            style="font-size: 20px; color:blue" id="blink" tooltipClass="customActive-tooltip-class"
            ngbTooltip="Critical Alert"></i>
          <i class="fa fa-volume-off" *ngIf="soundFlag!=true" tooltipClass="customInStopped-tooltip-class"
            style="font-size: 20px; color:red" id="blink" ngbTooltip="Critical Alert"></i>
          <audio id="myAudio" src="assets/images/users/Vip Police Siren.mp3" preload="auto">
          </audio>
  
        </button>
  
   
  
      </span>
    </div>
  </div>
  <div class="col-lg-1">
    <button type="button" class="text-dark" tooltipClass="customActive-tooltip-class"
      style="margin-top: 7px;font-size: 7px;" ngbTooltip="Trigger Report" (click)="triggerHistoryClickF()"><i
        class="fa fa-history" style="font-size: 20px; color:blue" id="blink"></i>
  
    </button>
    <!-- /////////////////////////////////////////////////////////////////////////// -->
    <button type="button" class="text-dark" tooltipClass="customTotal-tooltip-class" ngbTooltip="Trigger Summary">
      <a target="blank" routerLink="/Map/summaryTrigger"> <i class="fa fa-file" style="font-size: 20px; color:grey"
          id="blink"></i></a>
    </button>
  </div>
  

  </div>
  </div>
  
  <div class="container-flex" style="    margin-top: 12px; padding: 17px;">
  
    <div class="row">
  
      <div class="col-lg-12">
        <div class="collapse" id="collapseExample">
          <!-- <div class="line"></div> -->
          <div style="display:inline-table;">
            <div class="dropdown" id="searchDropdown">
              <button class="btn btn-outline-primary dropdown-toggle" type="button" id="dropdownMenuButton"
                data-bs-toggle="dropdown" aria-expanded="false">
                <span *ngIf="routeFlag">All Routes</span>
                <span *ngIf="routeFlagD">{{routenamedata}}</span>
                <i class="fa fa-caret-down"></i>
              </button>
              <ul class="dropdown-menu scrollable" aria-labelledby="dropdownMenuButton" id="myDropdownroute">
                <li>
                  <div class="hs-searchbox">
                    <input type="text" class="form-control searchInput" autocomplete="off" id="myInputroute"
                      (keyup)="searchboxRoute()" placeholder="Search">
                  </div>
                </li>
                <li><a class="dropdown-item" (click)="routeF('All Routes')"
                    style="color:blue;font-style: bold;font-weight: 500px;">All Routes</a></li>
                <li *ngFor="let item of routes | keyvalue"><a class="dropdown-item "
                    (click)="routeF(item.value)">{{item.value}}</a></li>
  
                <!-- <li><a class="dropdown-item" href="#">Guldhar</a></li> -->
              </ul>
            </div>
  
  
          </div>&nbsp;
          <div style="display:inline-table;">
            <div class="dropdown" id="searchDropdown">
              <button class="btn btn-outline-primary dropdown-toggle" type="button" id="dropdownMenuButton"
                data-bs-toggle="dropdown" aria-expanded="false">
                <span *ngIf="sourcesFlag">All Sources</span>
                <span *ngIf="sourcesFlagD">{{sourcesnamedata}}</span>&nbsp;
                <i class="fa fa-caret-down"></i>
              </button>
              <ul class="dropdown-menu scrollable" aria-labelledby="dropdownMenuButton" id="myDropdownSource">
                <li>
                  <div class="hs-searchbox">
                    <input type="text" class="form-control searchInput" autocomplete="off" id="myInputSource"
                      (keyup)="searchboxSource()" placeholder="Search">
                  </div>
                </li>
                <li><a class="dropdown-item" (click)="sourcesF('All Sources')"
                    style="color:blue;font-style: bold;font-weight: 500px;">All Sources</a></li>
                <li *ngFor="let item of sources | keyvalue"><a class="dropdown-item"
                    (click)="sourcesF(item.value)">{{item.value}}</a></li>
  
                <!-- <li><a class="dropdown-item" href="#">Guldhar</a></li> -->
  
              </ul>
            </div>
  
  
          </div>&nbsp;
          <div style="display:inline-table;">
            <div class="dropdown">
              <button class="btn btn-outline-primary dropdown-toggle" type="button" id="dropdownMenuButton"
                data-bs-toggle="dropdown" aria-expanded="false">
                <span *ngIf="destinationFlag">All Destinations</span>
                <span *ngIf="destinationFlagD">{{destinationnamedata}}</span>&nbsp;
                <i class="fa fa-caret-down"></i>
              </button>
              <ul class="dropdown-menu scrollable" aria-labelledby="dropdownMenuButton" id="myDropdownDesti">
                <li>
                  <div class="hs-searchbox">
                    <input type="text" class="form-control searchInput" autocomplete="off" id="myInputDesti"
                      (keyup)="searchboxDestination()" placeholder="Search">
                  </div>
                </li>
                <li><a class="dropdown-item" (click)="destinationF('All Destinations')"
                    style="color:blue;font-style: bold;font-weight: 500px;">All Destinations</a></li>
                <li *ngFor="let item of destinationData  | keyvalue"><a class="dropdown-item"
                    (click)="destinationF(item.value)">{{item.value}}</a></li>
  
  
              </ul>
              <!-- <ng-select let item="destinationData |keyvalue"
                bindLabel="item.value"
                placeholder="Select city"
                [(ngModel)]="selectedCity">
                </ng-select> -->
            </div>
  
  
          </div>&nbsp;
          <div style="display:inline-table;">
            <div class="dropdown">
              <button class="btn btn-outline-primary dropdown-toggle" type="button" id="dropdownMenuButton"
                data-bs-toggle="dropdown" aria-expanded="false">
                <span *ngIf="allColorFlag">All Color</span>
                <span *ngIf="colorLabelFlag">
                  <button class="btn btn-outline-primary btn-sm" for="Checkme1" [style.background-color]="colorLabel"
                    style="height: 30px;width: 90px;"></button>
                </span>
                <span *ngIf="hpColorFlag">
                  <button class="btn btn-outline-primary btn-sm" for="Checkme1"
                    style="height: 30px;width: 90px;color: red;" [innerHTML]="colorLabel">
                  </button>
                </span>
                <span *ngIf="colorFlagD"> </span>&nbsp;
                <i class="fa fa-caret-down"></i>
              </button>
              <ul class="dropdown-menu scrollable" aria-labelledby="dropdownMenuButton" id="myDropdownTrigger">
                <!-- <li>
                    <div class="hs-searchbox">
                      <input type="text" class="form-control searchInput" autocomplete="off" id="myInputTrigger"
                        (keyup)="searchboxTrigger()" placeholder="Search">
                    </div>
                  </li> -->
                <li>
                  <a class="dropdown-item" (click)="colorF('All Color')">
                    <div>
  
                      <button class="btn btn-outline-dark btn-sm" for="Checkme1" style="height: 30px;width: 90px;">All
                        Color</button>
                    </div>
                  </a>
                </li>
                <li *ngFor="let item of Api_color |keyvalue">
                  <a class="dropdown-item">
                    <!-- <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="" id="Checkme1"
                          /> -->
                    <button class="btn btn-outline-primary btn-sm" for="Checkme1" [style.background-color]="item.key"
                      (click)="colorF(item.key)" style="height: 30px;width: 90px;"></button>
  
                  </a>
                </li>
                <li>
                  <a class="dropdown-item">
                    <div>
  
                      <button class="btn btn-outline-primary btn-sm" for="Checkme1" (click)="colorF(1)"
                        style="height: 30px;width: 90px;background-color: #f7beb0;"></button>
                    </div>
                  </a>
                </li>
                <li>
                  <a class="dropdown-item">
                    <div>
  
                      <button class="btn btn-outline-primary btn-sm" for="Checkme1" (click)="colorF(2)"
                        style="height: 30px;width: 90px;background-color:white;">
                        <i class="fa fa-star" ngbTooltip="High Priority" style="color: red;"></i></button>
                    </div>
                  </a>
                </li>
  
  
              </ul>
            </div>
  
  
          </div>&nbsp;
          <div style="display:inline-table;">
            <div class="dropdown">
              <button class="btn btn-outline-primary dropdown-toggle" type="button" id="dropdownMenuButton"
                data-bs-toggle="dropdown" aria-expanded="false">
                <span *ngIf="shipmentFlag">All Shipment Method</span>
                <span *ngIf="shipmentFlagD">{{shipmentnamedata}}</span>&nbsp;
                <i class="fa fa-caret-down"></i>
              </button>
              <ul class="dropdown-menu scrollable" aria-labelledby="dropdownMenuButton" id="myDropdownShipment">
                <li>
                  <div class="hs-searchbox">
                    <input type="text" class="form-control searchInput" autocomplete="off" id="myInputShipment"
                      (keyup)="searchboxShipment()" placeholder="Search">
                  </div>
                </li>
                <li><a class="dropdown-item" (click)="shipmentF('All Shipment Method')"
                    style="color:blue;font-style: bold;font-weight: 500px;">All Shipment Method</a></li>
                <li *ngFor="let item of shipments  | keyvalue"><a class="dropdown-item"
                    (click)="shipmentF(item.value)">{{item.value}}</a></li>
                <!-- <li><a class="dropdown-item" href="#">S30</a></li>
                  <li><a class="dropdown-item" href="#">NG60</a></li> -->
              </ul>
            </div>
  
  
          </div>&nbsp;&nbsp;
          <!-- ////////////////////////////////////////////////// start-->
          <!-- <div style="display:inline-table;">
              <button type="button" *ngIf="permission?.assign_qrt_team==1" class="text-dark"
                style="margin-left: 220px;font-size: 20px;" data-bs-toggle="modal" data-bs-target="#qrtDesktopModal">
                <i class="fa fa-male" ngbTooltip="Assign QRT" (click)="shipmentSelectF(event)"></i></button>&nbsp;
  
            </div>
            <div style="display:inline-table;">
              <button type="button" *ngIf="permission?.create_alert==1" class="text-dark" style="font-size: 20px;"
                data-bs-toggle="modal" data-bs-target="#createAlertModal"><i class="fa fa-plus"
                  ngbTooltip="Create Alert" (click)="shipmentSelectF(event)"></i></button>&nbsp;
  
            </div> -->
          <!-- ///////////////////////////////////////////////////end -->
          <div style="display:inline-table;">
  
            <div class="form-check form-switch">
              <!-- <button  class="btn" (click)="filterAlerts()">Filter Alerts</button> -->
              <label for=" " style="display:inline-table;margin-right: 42px;font-weight: 500;">All</label>
              <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckChecked"
                (change)="criticalToggle($event)">
              <label class="form-check-label" for="flexSwitchCheckChecked" style="font-weight: 500;">High
                Shipment</label>
            </div>
  
          </div>
        </div>
      </div>
  
    </div>
    <!-- <div class="row">
      <div class="col-lg-11">
        <marquee style="font-family: Arial, Helvetica, sans-serif;color: red;font-weight: 600;font-style: italic;">
  
          *Data accuracy and attending alert on real-time depends on many external factors like network, device
          status, sudden spike in count of alerts etc. Claim liability as per policy conditions. For accuracy, please
          validate externally.
  
  
        </marquee>
      </div>
    </div> -->
  </div>
  </div>
  <div class="col-lg-12" style="padding-inline: 50px;">
    <ngx-spinner bdColor="rgba(51, 51, 51, 0.8)" size="default" [fullScreen]="true" type="ball-spin-clockwise">
      <p style="color: black">Please Wait.. </p>
    </ngx-spinner>
    <!-- ///////////////////////////////////edit/ -->
    <div style="    position: absolute;
    top: 32px;
    right: 199px;
    z-index: 100;">
    <!-- *ngIf="permission?.priority_activate==1" -->
      <button type="button"  class="text-dark" style="font-size: 20px;"
        data-bs-toggle="modal" data-bs-target="#prioretyModal">
        <i class="fa fa-star" ngbTooltip="Set High Priorety Trip" style="color: red;"></i></button>&nbsp;
        <!-- *ngIf="permission?.assign_qrt_team==1" -->
      <button type="button"  class="text-dark" style="font-size: 20px;"
        data-bs-toggle="modal" data-bs-target="#qrtDesktopModal">
        <i class="fa fa-male" ngbTooltip="Assign QRT" (click)="shipmentSelectF(event)"></i></button>&nbsp;
  
  
        <!-- *ngIf="permission?.create_alert==1" -->
      <button type="button"  class="text-dark" style="font-size: 20px;"
        data-bs-toggle="modal" data-bs-target="#createAlertModal"><i class="fa fa-plus" ngbTooltip="Create Alert"
          (click)="shipmentSelectF(event)"></i></button>&nbsp;
  
  
    </div>
    <div class="info">
      <table class="display nowrap  table" cellspacing="0" id="masterUpload">
        <thead>
          <tr style="text-align: center;">
            <th class="table-primary">Sl.</th>
            <th class="table-primary">ShipmentNo</th>
            <th class="table-primary">Vehicles</th>
  
            <th style="display: none;" id="tableHead">Status.</th>
            <th style="display: none;" id="tableHead">ImeiNo.</th>
  
            <th class="no-sort table-primary">Device</th>
            <!-- <th class="no-sort table-primary">Device</th> -->
            <th class="table-primary">Run Date</th>
            <th class="table-primary">Vehicle Status</th>
  
            <th class="table-primary">Route</th>
            <th class="table-primary">Source</th>
            <th class="table-primary">Destination</th>
            <th class="table-primary">Alert</th>
            <!-- <th class="table-primary">Close Alert</th> -->
            <th class="table-primary">Threat</th>
            <th class="table-primary">Qrt</th>
            <th class="table-primary">Driver Mobile(Name)</th>
  
            <th class="table-primary">Activity Time-1/Time-2/Time-3</th>
  
  
  
  
            <th class="table-primary">Shipment Method</th>
  
  
  
            <th style="display: none;" id="tableHead">Location</th>
  
            <th class="no-sort table-primary">Location</th>
            <th class="table-primary">Region</th>
            <th class="table-primary">Live/Max.Day Speed Km/hr.</th>
  
            <th class="table-primary">Transporter</th>
            <!-- <th class="table-primary">Track</th> -->
            <!-- <th class="table-primary">Trigger Trip</th> -->
            <th class="table-primary">Delay</th>
            <th class="table-primary">Halt Time </th>
            <th style="display: none;" id="tableHead">Color</th>
            <th class="table-primary">Document</th>
            <th class="table-primary">History</th>
            <th style="display: none;" id="tableHead">No action</th>
            <th style="display: none;" id="tableHead">High priority</th>
            <th class="table-primary">Gps</th>
            <th class="table-primary">Fixed E-Lock</th>
            <th class="table-primary">Portable E-Lock</th>
  
            <th style="display: none;" id="tableHead">Critical</th>
            <!-- <th>testmmmmmmmmmmmmmmmm</th> -->
            <!-- <th style="display: none;" id="tableHead" *ngIf="item.alerts.length==0">Color</th> -->
            <!-- <i class="fa fa-lock" ngbTooltip="fa fa-lock"></i> -->
  
  
          </tr>
        </thead>
        <tbody>
          <tr style="text-align: center;" *ngFor="let item of new_array;let ind=index"
            [ngClass]="{'redinfo': (item.FlagNoAction==1 )}">
  
            <td>{{ind+1}}</td>
            <td>{{item.shipment_no}}&nbsp;
              <button type="button" class="text-dark"
                (click)="remove_priorityId(item.id,permission?.priority_deactivate)">
                <i class="fa fa-star" *ngIf="item.Priority==1" ngbTooltip="High Prioraty trip click for change"
                  style="color: red;"></i></button>
            </td>
  
            <td>
              <!-- <button> {{item.name}}</button> -->
              <button *ngIf="item.vehiclestatus==0" style="color:red"
                (click)="liveLocation2(item.lat,item.lng,item.driver_mobile,item.driver_name,item.halt_time,item.transporter_name,item.imei,item.name,item.run_date,item.source_code,item.destination_code,item.deviceTime2,item.lastspeed,item.loc_name,item.shipment_no,item);vehicleStatus(item.vehiclestatus,item.vehiclestatus2,item.vehiclestatus3)"
                [ngbTooltip]="item.livestatus" container="body" placement="top">{{item.name}} </button>
              <button *ngIf="item.vehiclestatus==1" style="color:green"
                (click)="liveLocation2(item.lat,item.lng,item.driver_mobile,item.driver_name,item.halt_time,item.transporter_name,item.imei,item.name,item.run_date,item.source_code,item.destination_code,item.deviceTime2,item.lastspeed,item.loc_name,item.shipment_no,item);vehicleStatus(item.vehiclestatus,item.vehiclestatus2,item.vehiclestatus3)"
                [ngbTooltip]="item.livestatus" container="body" placement="top">{{item.name}} </button>
              <button *ngIf="item.vehiclestatus==2" style="color:black"
                (click)="liveLocation2(item.lat,item.lng,item.driver_mobile,item.driver_name,item.halt_time,item.transporter_name,item.imei,item.name,item.run_date,item.source_code,item.destination_code,item.deviceTime2,item.lastspeed,item.loc_name,item.shipment_no,item);vehicleStatus(item.vehiclestatus,item.vehiclestatus2,item.vehiclestatus3)"
                [ngbTooltip]="item.livestatus" container="body" placement="top">{{item.name}} </button>
              <button *ngIf="item.vehiclestatus==3" style="color:blue"
                (click)="liveLocation2(item.lat,item.lng,item.driver_mobile,item.driver_name,item.halt_time,item.transporter_name,item.imei,item.name,item.run_date,item.source_code,item.destination_code,item.deviceTime2,item.lastspeed,item.loc_name,item.shipment_no,item);vehicleStatus(item.vehiclestatus,item.vehiclestatus2,item.vehiclestatus3)"
                [ngbTooltip]="item.livestatus" container="body" placement="top">{{item.name}} </button>
            </td>
  
             <!-- <td>
              <button *ngIf="item.vehiclestatus==0" style="color:red"
                (click)="liveLocation_new(item.lat,item.lng,item.driver_mobile,item.driver_name,item.halt_time,item.transporter_name,item.imei,item.name,item.run_date,item.source_code,item.destination_code,item.deviceTime2,item.lastspeed,item.loc_name,item.shipment_no,item);vehicleStatus(item.vehiclestatus,item.vehiclestatus2,item.vehiclestatus3)"
                [ngbTooltip]="item.livestatus" container="body" placement="top">{{item.name}} </button>
              <button *ngIf="item.vehiclestatus==1" style="color:green"
                (click)="liveLocation_new(item.lat,item.lng,item.driver_mobile,item.driver_name,item.halt_time,item.transporter_name,item.imei,item.name,item.run_date,item.source_code,item.destination_code,item.deviceTime2,item.lastspeed,item.loc_name,item.shipment_no,item);vehicleStatus(item.vehiclestatus,item.vehiclestatus2,item.vehiclestatus3)"
                [ngbTooltip]="item.livestatus" container="body" placement="top">{{item.name}} </button>
              <button *ngIf="item.vehiclestatus==2" style="color:black"
                (click)="liveLocation_new(item.lat,item.lng,item.driver_mobile,item.driver_name,item.halt_time,item.transporter_name,item.imei,item.name,item.run_date,item.source_code,item.destination_code,item.deviceTime2,item.lastspeed,item.loc_name,item.shipment_no,item);vehicleStatus(item.vehiclestatus,item.vehiclestatus2,item.vehiclestatus3)"
                [ngbTooltip]="item.livestatus" container="body" placement="top">{{item.name}} </button>
              <button *ngIf="item.vehiclestatus==3" style="color:blue"
                (click)="liveLocation_new(item.lat,item.lng,item.driver_mobile,item.driver_name,item.halt_time,item.transporter_name,item.imei,item.name,item.run_date,item.source_code,item.destination_code,item.deviceTime2,item.lastspeed,item.loc_name,item.shipment_no,item);vehicleStatus(item.vehiclestatus,item.vehiclestatus2,item.vehiclestatus3)"
                [ngbTooltip]="item.livestatus" container="body" placement="top">{{item.name}} </button>
            </td> -->
  
            <td style="display:none;">{{item.vehiclestatus}}</td>
  
            <!-- <td>
              <button *ngIf="item.imei!=''" style="color:blue"
                (click)="vehicleTrackF(item.run_date,item.imei,item.name,item.alerts,item.id,item.route_id,item.alerts_summary,item.lat,item.lng)"><span>
                  <i class="fa fa-map-marker" style="font-size: 20px;" [ngbTooltip]="item.imei+'/'+item.imei_type"
                    placement="top" container="body"></i>
  
                </span>1</button>
  
              <button *ngIf="item.imei2_lock=='0'"
                (click)="vehicleTrackF(item.run_date,item.imei2,item.name,item.alerts,item.id,item.route_id,item.alerts_summary,item.lat,item.lng)"><span>
                  <i class="fa fa-unlock" style="font-size: 20px;color:red"
                    [ngbTooltip]="item.imei2 +'/'+'Door Open'+'/'+item.imei_type2" placement="top" container="body">
                  </i>
  
  
                  2</span>
              </button>
              <button *ngIf="item.imei2_lock=='1'"
                (click)="vehicleTrackF(item.run_date,item.imei2,item.name,item.alerts,item.id,item.route_id,item.alerts_summary,item.lat,item.lng)"><span>
                  <i class="fa fa-lock" style="font-size: 20px;color:green"
                    [ngbTooltip]="item.imei2 +'/'+'Door Close'+'/'+item.imei_type2" placement="top" container="body">
                  </i>
  
  
                  2</span>
              </button>
              <button *ngIf="item.imei2!='' &&item.imei2_lock==''"
                (click)="vehicleTrackF(item.run_date,item.imei2,item.name,item.alerts,item.id,item.route_id,item.alerts_summary,item.lat,item.lng)"><span>
                  <i class="fa fa-lock" style="font-size: 20px;color:gray"
                    [ngbTooltip]="item.imei2 +'/'+'Door Status-NA'+'/'+item.imei_type2" placement="top" container="body">
                  </i>
  
  
                  2</span>
              </button>
              <button *ngIf="item.imei3_lock=='0'" style="color:red"
                (click)="vehicleTrackF(item.run_date,item.imei3,item.name,item.alerts,item.id,item.route_id,item.alerts_summary,item.lat,item.lng)"><span>
                  <i class="fa fa-unlock" style="font-size: 20px;"
                    [ngbTooltip]="item.imei3+'/'+'Door Open'+'/'+item.imei_type3" placement="top" container="body">
                  </i>
  
                  3</span>
              </button>
              <button *ngIf="item.imei3_lock=='1'" style="color:green"
                (click)="vehicleTrackF(item.run_date,item.imei3,item.name,item.alerts,item.id,item.route_id,item.alerts_summary,item.lat,item.lng)"><span>
                  <i class="fa fa-lock" style="font-size: 20px;"
                    [ngbTooltip]="item.imei3+'/'+'Door Close'+'/'+item.imei_type3" placement="top" container="body">
                  </i>
  
                  3</span>
              </button>
              <button *ngIf="item.imei3!='' && item.imei3_lock==''" style="color:gray"
                (click)="vehicleTrackF(item.run_date,item.imei3,item.name,item.alerts,item.id,item.route_id,item.alerts_summary,item.lat,item.lng)"><span>
                  <i class="fa fa-lock" style="font-size: 20px;"
                    [ngbTooltip]="item.imei3+'/'+'Door Status NA'+'/'+item.imei_type3" placement="top" container="body">
                  </i>
  
                  3</span>
              </button>
            </td> -->
  
  
            <td>
              <button *ngIf="item.imei!=''" style="color:blue"
                (click)="vehicleTrackF_new(item.run_date,item.imei,item.name,item.alerts,item.id,item.route_id,item.alerts_summary,item.lat,item.lng)"><span>
                  <i class="fa fa-map-marker" style="font-size: 20px;" [ngbTooltip]="item.imei+'/'+item.imei_type"
                    placement="top" container="body"></i>
  
                </span>1</button>
  
              <button *ngIf="item.imei2_lock=='0'"
                (click)="vehicleTrackF_new(item.run_date,item.imei2,item.name,item.alerts,item.id,item.route_id,item.alerts_summary,item.lat,item.lng)"><span>
                  <i class="fa fa-unlock" style="font-size: 20px;color:red"
                    [ngbTooltip]="item.imei2 +'/'+'Door Open'+'/'+item.imei_type2" placement="top" container="body">
                  </i>
  
  
                  2</span>
              </button>
              <button *ngIf="item.imei2_lock=='1'"
                (click)="vehicleTrackF_new(item.run_date,item.imei2,item.name,item.alerts,item.id,item.route_id,item.alerts_summary,item.lat,item.lng)"><span>
                  <i class="fa fa-lock" style="font-size: 20px;color:green"
                    [ngbTooltip]="item.imei2 +'/'+'Door Close'+'/'+item.imei_type2" placement="top" container="body">
                  </i>
  
  
                  2</span>
              </button>
              <button *ngIf="item.imei2!='' &&item.imei2_lock==''"
                (click)="vehicleTrackF_new(item.run_date,item.imei2,item.name,item.alerts,item.id,item.route_id,item.alerts_summary,item.lat,item.lng)"><span>
                  <i class="fa fa-lock" style="font-size: 20px;color:gray"
                    [ngbTooltip]="item.imei2 +'/'+'Door Status-NA'+'/'+item.imei_type2" placement="top" container="body">
                  </i>
  
  
                  2</span>
              </button>
              <button *ngIf="item.imei3_lock=='0'" style="color:red"
                (click)="vehicleTrackF_new(item.run_date,item.imei3,item.name,item.alerts,item.id,item.route_id,item.alerts_summary,item.lat,item.lng)"><span>
                  <i class="fa fa-unlock" style="font-size: 20px;"
                    [ngbTooltip]="item.imei3+'/'+'Door Open'+'/'+item.imei_type3" placement="top" container="body">
                  </i>
  
                  3</span>
              </button>
              <button *ngIf="item.imei3_lock=='1'" style="color:green"
                (click)="vehicleTrackF_new(item.run_date,item.imei3,item.name,item.alerts,item.id,item.route_id,item.alerts_summary,item.lat,item.lng)"><span>
                  <i class="fa fa-lock" style="font-size: 20px;"
                    [ngbTooltip]="item.imei3+'/'+'Door Close'+'/'+item.imei_type3" placement="top" container="body">
                  </i>
  
                  3</span>
              </button>
              <button *ngIf="item.imei3!='' && item.imei3_lock==''" style="color:gray"
                (click)="vehicleTrackF_new(item.run_date,item.imei3,item.name,item.alerts,item.id,item.route_id,item.alerts_summary,item.lat,item.lng)"><span>
                  <i class="fa fa-lock" style="font-size: 20px;"
                    [ngbTooltip]="item.imei3+'/'+'Door Status NA'+'/'+item.imei_type3" placement="top" container="body">
                  </i>
  
                  3</span>
              </button>
            </td>
  
            <td style="display:none;">{{item.imei}} {{item.imei2}}</td>
  
            <td>{{item.run_date}}</td>
            <td>{{item.livestatus}}</td>
            <td>{{item.route_code}} </td>
            <td>{{item.source_code}}</td>
            <td>{{item.destination_code}}</td>
  
  
            <td style="text-align: left;cursor: pointer;" class="td" [id]="item.name"
              (click)="lastAlertF(item);lastalertNew(item.shipment_no);"><i *ngFor="let subItem of item.alerts_summary"
                class="fa fa-square" type="button" [style.color]="subItem?.last_color" style="font-size: 15px;"
                aria-expanded="false">
  
  
  
                <label for="floatingInput"
                  style="color: black;font-weight: 400;font-size: 15px;margin-left: 1px; font-family: sans-serif;">{{subItem?.alert_name}}</label>
                <sup>
                  <span class="badge rounded-pill badge-notification"
                    style="background-color:transparent;color: red;font-size: 10px;">{{subItem.total_count}}</span>
                </sup>&nbsp;</i>
              <label *ngFor=" let esca of item.alerts">
  
                <i *ngIf="esca?.escalation_type=='grace'" class="fa fa-clock-o" style="font-size: 20px;color: #1c84c6;"
                  [ngbTooltip]="esca?.alert_type+'-'+esca?.escalation_type" placement="top" container="body"></i>
                <sup><span *ngIf="esca?.escalation_type=='grace'"
                    class="badge rounded-pill badge-notification bg-secondary" tooltipClass="customInactive-tooltip-class"
                    ngbTooltip="remaining grace in Minutes" placement="top" container="body">
  
  
                    {{countTimer(esca?.escalate_grace_taken_time,esca?.remaining_grace_min)}}</span></sup>
              </label>
  
              <!-- escalation_type -->
  
              <!-- <button *ngFor="let subItem of item.alerts"><i *ngIf="subItem?.escalation_type=='grace'" class="fa fa-clock-o" style="font-size: 20px;"
                  [ngbTooltip]="subItem?.escalation_type" placement="top" container="body">-</i></button> -->
            </td>
            <!-- <td><button type="button" class="text-dark"><i class="fa fa-close" ngbTooltip="All Triger" placement="top"
                  container="body" style="font-size: 15px;" id="blink"></i><span
                  class="badge rounded-pill badge-notification bg-danger"
                  id="darkicon">{{item.alerts.length}}</span></button>
            </td> -->
            <!-- <td>{{item.threat.color}}</td> -->
            <td class="td" (click)="threatTablefilter(item.shipment_no)" style="cursor: pointer;"><i
                *ngIf="item.threat.length!=0" class="fa fa-exclamation-triangle" [ngbTooltip]="item.threat.slice(-1)[0]?.category
                +'/'+item.threat.slice(-1)[0]?.threat_type" id="blinkThreat" placement="top" container="body"
                [ngStyle]="{'color':item.threat.slice(-1)[0]?.color}" style="font-size: 20px;"></i>
              <sup>
                <span *ngIf="item.threat.length!=0" class="badge rounded-pill badge-notification"
                  style="background-color:transparent;color: red;font-size: 10px;">{{item.threat.length}}</span>
              </sup>
            </td>
            <td><i class="fa fa-male" *ngIf="item.qrt_assigned==1" type="button" (click)="qrtHistory(item.shipment_no)"
                placement="top" container="body" ngbTooltip="qrt" data-bs-toggle="modal" data-bs-target="#historyqrt"
                style="font-size: 20px;"></i></td>
            <td style="text-align: left;">{{item.driver_name}}{{(item.driver_mobile)}} </td>
  
            <td>{{item.devTime}}</td>
  
  
  
  
            <td>{{item.shipment_method}}</td>
  
  
  
  
            <td><span *ngIf="item.loc_name!=null">{{(item.loc_name).substring(0,30)}}...</span>
              <span> <i class="fa fa-dot-circle-o" [ngbTooltip]="item.loc_name" placement="top" container="body"
                  style="font-style:bold;font-weight: 500px;cursor: pointer;"></i></span>
  
  
            </td>
            <td style="display:none;">{{item.loc_name}}</td>
            <td>{{item.Region}}</td>
            <td>{{item.lastspeed}} / {{item.daymax_speed}}</td>
  
            <td style="text-align: left;">{{item.transporter_name}}</td>
  
            <!-- <td>no data</td> -->
            <!-- <td>Track View-1 Track View-2 </td> -->
            <td>{{item.eta}} </td>
            <td>{{item.halt_time}}</td>
            <td style="display:none;"><span *ngFor="let colorItem of item.alerts_summary">{{colorItem?.last_color}}</span>
              <!-- <span *ngIf="item.alerts.length==0">#FF0000</span> -->
            </td>
            <!-- <td style="display:none;"><span *ngIf="item.threat.length==0">{{item.alerts[0].color}}</span>
              <span *ngIf="item.alerts.length==0">#FF0000</span>
            </td> -->
  
            <!-- <td></td>   ViewModal   data-bs-toggle="modal"
                  data-bs-target="#ViewModal"  -->
            <td>
              <button ngbTooltip="upload document" placement="top" container="body" data-bs-toggle="modal"
                data-bs-target="#uploadModal" (click)="file_shipmnt(item.shipment_no)"> <i
                  class="fa fa-plus"></i></button>&nbsp;&nbsp;
              <button ngbTooltip="View Document" placement="top" container="body" (click)="viewFileF(item.shipment_no)"
                data-bs-toggle="modal" data-bs-target="#uploadViewModal"> <i class="fa fa-eye"></i></button>
            </td>
            <!-- <td></td> -->
            <td><i class="fa fa-book" type="button" ngbTooltip="View History" placement="top" container="body"
                (click)="viewHitoryDash(item.shipment_no)" data-bs-toggle="modal" data-bs-target="#viewHistorydsk"></i>
            </td>
            <td style="display:none;">{{item.FlagNoAction}}</td>
            <td style="display:none;">{{item.Priority}}</td>
            <td>
              {{item.imei}}</td>
            <td>
              <span *ngIf="item.imei2_lock=='0'">{{item.imei2}}-Open</span>
              <span *ngIf="item.imei2_lock=='1'">{{item.imei2}}-Close</span>
              <span *ngIf="item.imei2_lock==''">{{item.imei2}}-NA</span>
            </td>
            <td> <span *ngIf="item.imei3_lock=='0'">{{item.imei3}}-Open</span>
              <span *ngIf="item.imei3_lock=='1'">{{item.imei3}}-Close</span>
              <span *ngIf="item.imei3_lock==''">{{item.imei3}}-NA</span>
            </td>
            <td style="display:none;">{{item.FlagCritical}}</td>
            <!-- <td>
              <label *ngFor="let esca of item.alerts">
                {{ esca.start_time }}
              </label>
            </td> -->
  
          </tr>
        </tbody>
  
      </table>
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  
  
  </div>
  
  
  
  
  
  
  
  
  
  <!-- //<div class = "full" id = "map" ></div> -->
  <!-- start -->
  <!-- ////////////////////////////////////side bar old/////////////////////// start//////////////// -->
  <!-- <div class="rectangle-864" (click)="show = !show" id="sideBar" style="background-color:rgb(51, 65, 65);">
      <img class=" box-arrow img-responsive mb-50" src="assets/images/users/arrow.png">
  </div>
  <div class="box" [class.opened]="show" [class.closed]="!show">
      <div class="content  "  style="background-color:rgb(3, 95, 95)"> -->
  <!-- <h1>Secutrak</h1>  -->
  <!-- ///////Statrt///////   -->
  <!-- <div style="background-color:rgb(5, 129, 182);">
          <div class="modal-header" style="background-color:rgb(5, 129, 182);">
              <h5 class="modal-title" id="exampleModalLabel">Itraceit</h5>
             
          </div>
          <div class="col-lg-8">
                          
             
              
          </div>
          <div class="modal-body">
              <div class="container">
                 
          </div>
          <div class="col-lg-8">
                          
            
              
          </div>
          <div class="modal-body">
              <div class="container">
                 
          </div>
         
          </div> 
      </div> -->
  
  
  <!-- //////////end// -->
  
  
  <!-- <div class="filters">
              <div class="refersh" >
                  <a  placement="left"  (click)="show=!show">
                  <img class=" refersh-img img-responsive " src="assets/images/users/arrow.png">
                  </a>
              </div>
             
          </div>
          
              <div class="panel panel-primary" style="padding-left: 0; height: 481px; width: 350px;"> -->
  
  
  <!-- ////////////////////////////////////// -->
  
  
  
  
  
  <!-- </div>
      </div>
  </div> -->
  <!-- ///////////////////////////////////old side bar closed/////////////////////////////////// -->
  <!-- end -->
  
  
  <!-- ///////popup modal -->
  
  <!-- 
  
  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Root Planner</h5>
           
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          ////////////// -->
  <!-- <div class="col-lg-8">
                          
              <label for="exampleInputPassword1">Weightage</label>
              
          </div>
          
          <div class="modal-body">
              <div class="container">
                  <div class="row">
                      <div class="col-lg-6">
                          
                          <label for="exampleInputPassword1">From</label>
                          <input type="text"   id="exampleInputPassword1">
                      </div>
                      <div class="col-lg-6">
                          <label for="exampleInputPassword1">To</label>
                          <input type="text"  id="exampleInputPasswo1rd" >
                      </div>
                  </div>
              </div> 
          </div>
  
          <div class="col-lg-8">
                          
              <label for="exampleInputPassword1">Block Root</label>
              
          </div>
  
          <div class="modal-body">
              <div class="container">
                  <div class="row">
                      <div class="col-lg-6">
                          
                          <label for="exampleInputPassword1">From</label>
                          <input type="text"   id="exampleInputPassword1">
                      </div>
                      <div class="col-lg-6">
                          <label for="exampleInputPassword1">To</label>
                          <input type="text"  id="exampleInputPasswo1rd" >
                      </div>
                  </div>
              </div> 
          </div>
  
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal"(click)="show_close()">Close</button>
            <button type="button" class="btn btn-primary" >Map</button> -->
  <!-- </div> -->
  <!-- </div>
      </div>
    </div> -->
  
  
  <!-- ///////////////////////////////////////////////////////////////////map pop///////////////////////// -->
  <div class="modal fade" id="mapModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 1027px;margin-left: 260px;">
      <div class="modal-content" style="height: 634px; width: 835px;">
  
        <div class="modal-header">
          <h6 class="modal-title" id="exampleModalLabel" style="margin-left: 220px;font-weight:400;"></h6>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div id="map">
            <!-- <iframe src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCRzByDjNttORvQ31CJD1H8d2LTc3SHlt4&libraries=drawing" width="100%" height="450"  style="border:0" allowfullscreen frameborder="0"></iframe> -->
          </div>
        </div>
        <div class="modal-footer" style="margin-bottom: 28px;">
  
  
  
  
          <button *ngIf="multilocationArray.imei!=''" type="button" (click)="liveLocation3(multilocationArray.imei,'1')">
            <i class="fa fa-map-marker" tooltipClass="customInactive-tooltip-class" [ngbTooltip]="multilocationArray.imei"
              style="font-size: 20px; " id="blink"
              [style.color]="colorTrack[2]?.third"></i><span>1{{multilocationArray.imei_type}}</span></button>
  
          <button *ngIf="multilocationArray.imei2!=''" type="button"
            (click)="liveLocation3(multilocationArray.imei2,'2')"> <i class="fa fa-map-marker"
              tooltipClass="customInactive-tooltip-class" [ngbTooltip]="multilocationArray.imei2" style="font-size: 20px;"
              id="blink" [style.color]="colorTrack[0]?.first"></i><span>2{{multilocationArray.imei_type2}}</span></button>
          <button *ngIf="multilocationArray.imei3!=''" type="button" (click)="liveLocation3(multilocationArray.ime3,'3')">
            <i class="fa fa-map-marker" tooltipClass="customInactive-tooltip-class"
              [ngbTooltip]="multilocationArray.imei3" style="font-size: 20px;" id="blink"
              [style.color]="colorTrack[1]?.second"></i><span>3{{multilocationArray.imei_type3}}</span></button>
  
  
        </div>
  
        <!-- <button type="button" class="btn-outline-danger btn-sm" data-bs-dismiss="modal">Close</button> -->
  
  
      </div>
    </div>
  </div>
  <!-- ////////////////////////////////////////////////////////s30alert old/////////////////////////// -->
  
  <!-- //////////////////////////////////////////////////////////trigger table click pop up dashboard/////////////////////////// -->
  <div class="modal fade" id="triggerModal" tabindex="-1" aria-labelledby="exampleModalLabel" data-bs-backdrop="static"
    data-bs-keyboard="false" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 1500px;margin-left: 140px;">
      <div class="modal-content" style="height: 634px; width: 835px;">
  
        <ngx-spinner name="LastAlert" bdColor="rgba(51, 51, 51, 0.8)" size="default" [fullScreen]="false"
          type="ball-spin-clockwise">
          <p style="color: black">Wait.. </p>
        </ngx-spinner>
        <form>
          <div class="modal-header" style="background-color: white;">
  
            <!-- <h3 class="modal-title" id="exampleModalLabel"
              style="margin-left: 220px;font-weight:700; color :#1c84c6;font-size: initial;"></h3> -->
            <!-- <button class="btn btn-outline-primary btn-sm">CLose Trigger</button> -->
            <div style="display:inline-table;">
              <div class="dropdown">
                <button class="btn btn-outline-primary dropdown-toggle" type="button" id="dropdownMenuButton"
                  data-bs-toggle="dropdown" aria-expanded="false">
                  <span *ngIf="triggerFlag">All Triggers</span>
                  <span *ngIf="triggerFlagD">{{triggernamedata}}</span>&nbsp;
                  <i class="fa fa-caret-down"></i>
                </button>
                <ul class="dropdown-menu scrollable" aria-labelledby="dropdownMenuButton" id="myDropdownTrigger">
                  <li>
                    <div class="hs-searchbox">
                      <input type="text" class="form-control searchInput" autocomplete="off" id="myInputTrigger"
                        (keyup)="searchboxTrigger()" placeholder="Search">
                    </div>
                  </li>
  
                  <li><a class="dropdown-item" (click)="triggerF('All Triggers')"
                      style="color:blue;font-style: bold;font-weight: 500px;">All Triggers</a></li>
                  <li *ngFor="let item of alertData  | keyvalue"><a class="dropdown-item"
                      (click)="triggerF(item.value)">{{item.value}}</a></li>
                  <!-- <li><a class="dropdown-item" href="#">NG60</a></li> -->
                </ul>
              </div>
  
  
            </div>&nbsp;
            <!-- <div style="display:inline-table;">
              <div class="dropdown">
                <button class="btn btn-outline-primary dropdown-toggle" type="button" id="dropdownMenuButton"
                  data-bs-toggle="dropdown" aria-expanded="false">
                  <span *ngIf="threatFlag">Threat</span>
                  <span *ngIf="threatFlagD">{{threaddata}}</span>&nbsp;
                  <i class="fa fa-caret-down"></i>
                </button>
                <ul class="dropdown-menu scrollable" aria-labelledby="dropdownMenuButton" id="myDropdownTrigger">
                  <li>
                    <div class="hs-searchbox">
                      <input type="text" class="form-control searchInput" autocomplete="off" id="myInputTrigger"
                        (keyup)="searchboxTrigger()" placeholder="Search">
                    </div>
                  </li>
  
                 
                  <li><a class="dropdown-item" (click)="threatF('Threat')"
                      style="color:blue;font-style: bold;font-weight: 500px;">Threat</a></li>
                  <li><a class="dropdown-item" (click)="threatF('Hi Jack')"
                      style="color:blue;font-style: bold;font-weight: 500px;">Hi Jack</a></li>
  
                  <li><a class="dropdown-item" (click)="threatF('TPND')"
                      style="color:blue;font-style: bold;font-weight: 500px;">TPND</a></li>
                  <li><a class="dropdown-item" (click)="threatF('Accident')"
                      style="color:blue;font-style: bold;font-weight: 500px;">Accident</a></li>
                  <li><a class="dropdown-item" (click)="threatF('Theft')"
                      style="color:blue;font-style: bold;font-weight: 500px;">Theft</a></li>
  
  
                  
                </ul>
              </div>
  
  
            </div>&nbsp; -->
            <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"
              (click)="closeLastAlert()"></button>
  
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-lg-12" style="margin-left:155px;">
                <div style="display:inline-table;">
                  <!-- *ngIf="permission?.assign_qrt_team==1" -->
                  <button type="button"  class="btn btn-outline-primary btn-sm"
                    id="tablepopUpButtn" data-bs-toggle="modal" data-bs-target="#qrtModalabove"
                    [disabled]="graceBtnFlag">QRT</button>&nbsp;
  
                </div>
                <div style="display:inline-table;">
                  <!-- *ngIf="permission?.snooz==1" -->
                  <button type="button"  class="btn btn-outline-primary btn-sm"
                    id="tablepopUpButtn" [disabled]="graceBtnFlag" data-bs-toggle="modal"
                    data-bs-target="#graceModalabove">Grace</button>&nbsp;
                </div>
                <div style="display:inline-table;">
                  <!-- *ngIf="permission?.close_alert==1" -->
                  <button type="button"  class="btn btn-outline-danger btn-sm"
                    id="tablepopUpButtn" (click)="xcloseF()" data-bs-toggle="modal" data-bs-target="#closeModalabove"
                    [disabled]="iscloseFlagbtn">Close</button>&nbsp;
                </div>
                <div style="display:inline-table;">
                  <!--  *ngIf="permission?.escalate==1" -->
                  <button type="button"  class="btn btn-outline-primary btn-sm"
                    id="tablepopUpButtn" data-bs-toggle="modal" data-bs-target="#escalationModal"
                    (click)="getEscalationInfo()" [disabled]="escalationbtnFlag">Escalation</button>&nbsp;
                </div>
                <div style="display:inline-table;">
                  <!--  *ngIf="permission?.history_and_summary==1"  -->
                  <button type="button" class="btn btn-outline-primary btn-sm"
                    id="tablepopUpButtn" data-bs-toggle="modal" data-bs-target="#historyAboveAlertDesk"
                    (click)="escalationHistory();graceHistory()" [disabled]="escalationbtnFlag">History</button>
                </div>
              </div>
            </div>
            <div style="overflow-y: auto;">
              <table class="display nowrap table table-Success table-striped table-hover" cellspacing="0"
                id="triggerTableFull" width="100%">
                <thead>
                  <tr style="text-align: center;">
                    <th class="table-primary">S.No.</th>
                    <th class="table-primary">
  
  
                      <input class="form-check-input" type="checkbox" value="" id="flexCheckChecked"
                        name="flexCheckCheckedHead" style="    margin-top: -16px;margin-left: -7px;"
                        (change)="getAllCheckboxItemNew($event)">
  
  
  
  
                    </th>
  
                    <th class="table-primary">Vehicles</th>
                    <th class="table-primary">Trigger Name</th>
                    <th class="table-primary">ShipmentNo</th>
                    <th class="table-primary">Sorce</th>
                    <th class="table-primary">Destination</th>
                    <!-- <th class="table-primary">Threat</th> -->
                    <th class="table-primary">Recieved Time</th>
                    <th class="table-primary">Start Time</th>
                    <th class="table-primary">End Time</th>
                    <th class="table-primary">Location/Message</th>
  
                    <th class="table-primary">Driver(Mobile)</th>
                    <th class="table-primary">Route</th>
                    <th class="table-primary" style="display: none;">delete</th>
  
  
                  </tr>
  
                </thead>
                <tbody *ngIf="TriggerInfo.length">
                  <tr *ngFor="let item of TriggerInfo;let ind=index" style="text-align: center;" [id]="item.id">
                    <td>{{ind+1}}</td>
                    <td>
  
                      <input class="form-check-input" type="checkbox" value="" id="triggerId"
                        style="margin-top: -6px;margin-left: -7px;" name="triggerIdLastAlertNew"
                        (change)="trigTcheckF(item.id,$event);graceCheckF($event,item.AlertType,item.id,item.level,item.TripID,item.VehicleNo)">
  
  
  
                    </td>
                    <td>
                      {{item.VehicleNo}}
                    </td>
                    <!-- <td> {{item.AlertType}}</td> -->
                    <td style="text-align:left ;"><i class="fa fa-square" style="font-size: 15px;"
                        [style.color]="item.color"></i>{{item.AlertType}}
                      <button *ngIf="item.escalate_type=='grace'">
                        <i class="fa fa-clock-o" style="font-size: 20px;" [ngbTooltip]="item.escalation_type"
                          placement="top" container="body"></i></button>
                    </td>
                    <td>{{item.TripID}}</td>
                    <td>{{item.SourceInfo}}</td>
                    <td>{{item.DestinationInfo}}</td>
                    <!-- <td> <i class="fa fa-exclamation-triangle" *ngIf="item.threat.length!=0" [ngbTooltip]="item.threat[0].location" style="color: red;"></i></td> -->
                    <td>{{item.LogTime}}</td>
                    <td>{{item.StartDate}}</td>
                    <td>{{item.EndDate}}</td>
                    <td>{{item.Location}}/{{item.Message}}</td>
  
                    <td>{{item.DriverInfo}}</td>
                    <td>{{item.RouteInfo}}</td>
                    <td style="display: none;">{{item.id}}</td>
  
  
                  </tr>
                </tbody>
              </table>
            </div>
  
          </div>
  
          <!-- <div class="modal-footer" >
  
  
             <i class="fe fe-truck" tooltipClass="customActive-tooltip-class" ngbTooltip="Device 1"
            style="font-size: 20px;color: blue;" id="blink"></i>
           <i class="fe fe-truck" tooltipClass="customInStopped-tooltip-class" ngbTooltip="Device 2"
            style="font-size: 20px;color: red;" id="blink"></i> -->
  
  
          <!-- <button type="button" class="btn btn" data-bs-dismiss="modal"
              style="background-color:#1c84c6;border-color: #1c84c6;color: white ;">Close</button> -->
  
          <!-- </div> -->
        </form>
      </div>
  
    </div>
  </div>
  <!-- //////////////////////////////////////////////////////////grace popup old////////////////////////////// -->
  <div class="modal fade" id="graceModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 1027px;margin-left: 260px;">
      <div class="modal-content" style="height: 634px; width: 440px;">
  
        <div class="modal-header" style="background-color: white;">
          <button type="button" class="btn btn-sm" data-bs-toggle="modal" href="#triggerModal" aria-label="Close"><i
              class="fa fa-arrow-left" ngbTooltip="Back"></i></button>
          <h3 class="modal-title" id="exampleModalLabel"
            style="margin-left: 220px;font-weight:700; color :#1c84c6;font-size: initial;"></h3>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
  
          <form #gracePeriodold="ngForm" (ngSubmit)="gracPeriodF(gracePeriodold.value);gracePeriodold.reset()">
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-6" style="font-size: 15px;">Prev. Status:&nbsp;&nbsp;<i class="fa fa-square"
                    ngbTooltip="Prev. Status" style="color: yellow;font-size: 15px;"></i>
                </div>
                <div class="col-lg-6" style="font-size: 15px;">History View:&nbsp;&nbsp;&nbsp;&nbsp;<a role="button"
                    (click)="graceHistory()"><i class="fa fa-eye" ngbTooltip="Click Here"
                      style="color: black;font-size: 18px;cursor: pointer;font-style: bold;"></i></a>
                  <div *ngIf="graceHistoryFlag" style="overflow: auto;overflow-y: auto;max-height: 160px;">
                    <table class="table table-secondary table-striped" style="width: 400px;" id="ModalTble">
                      <thead>
                        <tr>
                          <th scope="col" style="color: black;">Trigger type</th>
                          <th scope="col" style="color: black;">Grace_period_requested</th>
                          <th scope="col" style="color: black;">Grace_period_starttime</th>
                          <th scope="col" style="color: black;">Grace_taken</th>
                          <th scope="col" style="color: black;">Trip id</th>
                          <th scope="col" style="color: black;">Mail_to</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let item of graceHistoryData[0]">
                          <td>{{item.trigger_type}}</td>
                          <td>{{item.grace_period_requested}}</td>
                          <td>{{item.grace_period_starttime}}</td>
                          <td>{{item.grace_taken}}</td>
                          <td>{{item.trip_id}}</td>
                          <td>{{item.mail_to}}</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
  
              </div>
              <div style="font-size: 15px;">Escalation Level:&nbsp;&nbsp;2</div>
              <div style="margin-top: 10px;color: black;">
                <h4>+Start Grace Period</h4>
              </div>
              <div class="row">
                <div class="col-lg-6" style="font-size: 15px;margin-top: 30px;">Remaining Grace
                  Period:&nbsp;&nbsp;&nbsp;{{remainngGrace/60}}
                  &nbsp;Hours
  
                </div>
              </div>
              <div class="row">
                <div class="col-lg-6" style="font-size: 15px;">Round: {{GraceLoop}}</div>
                <div class="col-lg-6" style="font-size: 15px;">Enter Time(MINUTES)</div>
              </div>
  
              <div class="row">
                <div class="col-lg-6">
                  <table class="table table-secondary table-striped" style="width: 400px;" id="ModalTble">
                    <thead>
                      <tr>
                        <th scope="col" style="color: black;">User</th>
                        <th scope="col" style="color: black;">Sms</th>
                        <th scope="col" style="color: black;">Email</th>
                        <th scope="col" style="color: black;">Level</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let item of grace_infoTbl">
                        <td scope="row">{{item.name}}</td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" [disabled]="item.checked_sms"
                              (change)="graceTblCheckSms($event,item.phone_no)">
  
                          </div>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" [disabled]="item.checked_email"
                              (change)="graceTblCheckEmail($event,item.email_id)">
  
                          </div>
                        </td>
                        <td>{{item.role}}</td>
                      </tr>
                      <!-- <tr>
                        <td scope="row">U2</td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="" id="flexCheckDefault"
                              name="U2Sms" ngModel>
  
                          </div>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="" id="flexCheckDefault"
                              name="U2Email" ngModel>
  
                          </div>
                        </td>
                        <td>Level3</td>
                      </tr>
                      <tr>
                        <td scope="row">U3</td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="true" id="U3Sms"
                              name="U3Sms" ngModel checked disabled>
  
                          </div>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="true" id="U3Email"
                              name="U3Email" ngModel checked disabled>
  
                          </div>
                        </td>
                        <td>Level4</td>
                      </tr>
                      <tr>
                        <td scope="row">U4</td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="true" id="U4Sms" checked
                              disabled name="U4Sms" ngModel>
  
                          </div>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="" id="flexCheckDefault"
                              name="U4Email" ngModel>
  
                          </div>
                        </td>
                        <td>Level4</td>
                      </tr>
                      <tr>
                        <td scope="row">U5</td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="" id="flexCheckDefault"
                              name="U5Sms" ngModel>
  
                          </div>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="" id="flexCheckDefault"
                              name="U5Email" ngModel>
  
                          </div>
                        </td>
                        <td>Level2</td>
                      </tr>
                      <tr>
                        <td scope="row">U6</td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="" id="flexCheckDefault"
                              name="U6Sms" ngModel>
  
                          </div>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="" id="flexCheckDefault"
                              name="U6Email" ngModel>
  
                          </div>
                        </td>
                        <td>Level3</td>
                      </tr>
                      <tr>
                        <td scope="row">U7</td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="" id="flexCheckDefault"
                              name="U7Sms" ngModel>
  
                          </div>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="true" id="U7Email"
                              name="U7Email" ngModel checked disabled>
  
                          </div>
                        </td>
                        <td>Level2</td>
                      </tr> -->
                    </tbody>
                  </table>
                </div>
                <div class="col-lg-6">
                  <div class="form-outline">
                    <input type="number" class="form-control graceCheckBox" name="grace_hour" id="grace_hour" value=""
                      [ngModel]="grace_hour" required>
  
                  </div>&nbsp;
                  <div class="form-outline">
                    <textarea class="form-control" rows="4" placeholder="Enter Remarks Here.." name="graceRemarks"
                      [ngModel]="graceRemarks" required></textarea>
  
                  </div>
                  <div class="col-lg-6">
                    <button class="btn btn-outline-primary btn-sm" type="submit" id="AlertButton" style="max-width: 100px;
                    margin-top: 32px;color: black;margin-left: 145px" aria-expanded="false">SUBMIT</button>
                  </div>
                </div>
              </div>
  
            </div>
          </form>
  
        </div>
        <!-- <div class="modal-footer" style="margin-bottom: 28px;">
  
  
          <i class="fe fe-truck" tooltipClass="customActive-tooltip-class" ngbTooltip="Device 1"
            style="font-size: 20px;color: blue;" id="blink"></i>
          <i class="fe fe-truck" tooltipClass="customInStopped-tooltip-class" ngbTooltip="Device 2"
            style="font-size: 20px;color: red;" id="blink"></i>
  
  
         
  
        </div> -->
      </div>
    </div>
  </div>
  <!-- //////////////////////////////////////////////////grace pop model on desktop last//////////////////////////////////// -->
  <div class="modal fade" id="graceModalDesk" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 500px;margin-left: 260px;">
      <div class="modal-content" style="height: 390px; width: 440px;">
  
        <div class="modal-header" style="background-color: white;">
          <button type="button" class="btn btn-sm" data-bs-toggle="modal" href="#desklastalertModal" aria-label="Close"><i
              class="fa fa-arrow-left" ngbTooltip="Back"></i></button>
          <h3 class="modal-title" id="exampleModalLabel"
            style="margin-left: 220px;font-weight:700; color :#1c84c6;font-size: initial;"></h3>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
  
          <form #gracePeriod="ngForm" (ngSubmit)="gracPeriodF(gracePeriod.value);gracePeriod.reset()">
            <div class="col-lg-12">
              <div class="row">
                <div style="font-size: 15px;">Round: {{GraceLoop}}</div>
              </div>
  
              <div class="row">
                <div style="font-size: 15px;margin-top: 30px;">Remaining Grace
                  Period:&nbsp;&nbsp;&nbsp;{{remainngGrace}}
                  &nbsp;MINUTES
  
                </div>
  
              </div>
              <div class="row">
  
                <div style="font-size: 15px;">Enter Time(MINUTES)</div>
  
              </div>
  
              <div class="row">
                <!-- <div class="col-lg-6">
                  <table class="table table-secondary table-striped" style="width: 400px;" id="ModalTble">
                    <thead>
                      <tr>
                        <th scope="col" style="color: black;">User</th>
                        <th scope="col" style="color: black;">Sms</th>
                        <th scope="col" style="color: black;">Email</th>
                        <th scope="col" style="color: black;">Level</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let item of grace_infoTbl">
                        <td scope="row">{{item.name}}</td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" [disabled]="item.checked_sms"
                              (change)="graceTblCheckSms($event,item.phone_no)">
  
                          </div>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" [disabled]="item.checked_email"
                              (change)="graceTblCheckEmail($event,item.email_id)">
  
                          </div>
                        </td>
                        <td>{{item.role}}</td>
                      </tr>
    
                    </tbody>
                  </table>
                </div> -->
                <div class="row">
                  <div class="form-outline">
                    <input type="number" class="form-control graceCheckBox" name="grace_hour" id="grace_hour" value=""
                      [ngModel]="grace_hour" required>
  
                  </div>&nbsp;
                  <div class="form-outline">
                    <textarea class="form-control" rows="4" placeholder="Enter Remarks Here.." name="graceRemarks"
                      [ngModel]="graceRemarks" required></textarea>
  
                  </div>
                  <div class="row">
                    <button class="btn btn-outline-primary btn-sm" type="submit" id="AlertButton" style="max-width: 100px;
                    
                    margin-top: 32px;color: black;margin-left: 145px" [disabled]="!gracePeriod.form.valid"
                      aria-expanded="false">SUBMIT</button>
                  </div>
                </div>
              </div>
  
            </div>
          </form>
  
        </div>
        <!-- <div class="modal-footer" style="margin-bottom: 28px;">
  
  
          <i class="fe fe-truck" tooltipClass="customActive-tooltip-class" ngbTooltip="Device 1"
            style="font-size: 20px;color: blue;" id="blink"></i>
          <i class="fe fe-truck" tooltipClass="customInStopped-tooltip-class" ngbTooltip="Device 2"
            style="font-size: 20px;color: red;" id="blink"></i>
  
  
         
  
        </div> -->
      </div>
    </div>
  </div>
  <!-- //////////////////////////////////////////////////////close popup old/////////////////////////////////// -->
  <div class="modal fade" id="closeModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 1027px;margin-left: 260px;">
      <div class="modal-content">
  
        <div class="modal-header" style="background-color: white;">
          <button type="button" class="btn btn-sm" data-bs-toggle="modal" data-bs-target="#triggerModal"
            aria-label="Close"><i class="fa fa-arrow-left" ngbTooltip="Back"></i></button>
          <h3 class="modal-title" id="exampleModalLabel"
            style="margin-left: 220px;font-weight:700; color :#1c84c6;font-size: initial;"></h3>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form #closeTab="ngForm" (ngSubmit)="xCloseTabF(closeTab.value);closeTab.reset()">
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-6" style="font-size: 15px;">Prev. Status:&nbsp;&nbsp;<i class="fa fa-square"
                    ngbTooltip="Prev. Status" style="color: yellow;font-size: 15px;"></i>
                </div>
                <div class="col-lg-6" style="font-size: 15px;">History View:&nbsp;&nbsp;&nbsp;&nbsp;<i class="fa fa-eye"
                    ngbTooltip="Click Here" style="color: black;font-size: 18px;cursor: pointer;font-style: bold;"></i>
                </div>
  
              </div>
              <div style="font-size: 15px;">Escalation Level:&nbsp;&nbsp;2</div>
              <div style="margin-top: 10px;color: black;">
                <h4>X-Close Alert</h4>
              </div>
              <div class="row">
                <div class="col-lg-4">
                  <div class="row">
                    <div class="col-lg-1" id="newtrip">To:</div>
                    <div class="col-lg-1">
                      <div class="form-check">
                        <input class="form-check-input closeCheckbox" type="checkbox" value="" id="Driver">
                      </div>
  
                    </div>
                    <div class="col-lg-2" style="margin-left: 30px;"><span class="badge bg-primary"
                        style="font-size: 12px;font-family:sans-serif;">Driver</span></div>
                  </div>
                </div>
  
  
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-1" id="newtrip">To:</div>
                    <div class="col-lg-1">
                      <div class="form-check">
                        <input class="form-check-input closeCheckbox" type="checkbox" value=""
                          id="Escalation-Transporter">
                      </div>
  
                    </div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;"><span class="badge bg-primary"
                        style="font-size: 12px;font-family:sans-serif;">Escalation-Transporter</span>
                    </div>
                  </div>
                </div>
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-1" id="newtrip">To:</div>
                    <div class="col-lg-1">
                      <div class="form-check">
                        <input class="form-check-input closeCheckbox" type="checkbox" value="" id="Escalation-Manager">
                      </div>
  
                    </div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;"><span class="badge bg-primary"
                        style="font-size: 12px;font-family:sans-serif;">Escalation-Manager</span>
                    </div>
                  </div>
                </div>
              </div>
              <!-- ///////////////////////////////new tab///////////////// -->
              <div class="row" style="margin-top: 10px;">
                <div class="col-lg-4">
                  <div class="row">
                    <div class="col-lg-2" id="newtrip">Name:</div>
                    <div class="col-lg-2" style="margin-left: 30px;">
                      <div class="form-outline ">
                        <input type="text" id="closeInputBox" class="form-control" name="driverName" ngModel>
  
                      </div>
                    </div>
                  </div>
                </div>
  
  
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Name:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline ">
                        <input type="text" id="closeInputBox" class="form-control" name="transproterName" ngModel>
  
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Name:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline ">
                        <input type="text" id="closeInputBox" class="form-control" name="managerName" ngModel>
  
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- ///////////////////////////////////////////////////////new tab////////////////// -->
              <div class="row" style="margin-top: 10px;">
                <div class="col-lg-4">
                  <div class="row">
                    <div class="col-lg-2" id="newtrip">At(hours):</div>
                    <div class="col-lg-2" style="margin-left: 30px;">
                      <div class="cs-form">
                        <input type="time" class="form-control" value="10:05 AM" id="closeInputBox" name="driverTime"
                          ngModel>
                      </div>
                    </div>
                  </div>
                </div>
  
  
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">At(hours):</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="cs-form">
                        <input type="time" class="form-control" value="10:05 AM" id="closeInputBox" name="transporterTime"
                          ngModel>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">At(hours):</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="cs-form">
                        <input type="time" class="form-control" value="10:05 AM" id="closeInputBox" name="managerTime"
                          ngModel>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- ////////////////////////////////new tab///////////////////////////////////// -->
              <div class="row" style="margin-top: 10px;">
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Remarks:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline">
                        <textarea class="form-control" id="closeInputBox" rows="4" name="driverRemarks"
                          ngModel></textarea>
  
                      </div>
                    </div>
                  </div>
                </div>
  
  
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Remarks:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline">
                        <textarea class="form-control" id="closeInputBox" rows="4" name="transporterRemarks"
                          ngModel></textarea>
  
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Remarks:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline">
                        <textarea class="form-control" id="closeInputBox" rows="4" name="managerRemarks"
                          ngModel></textarea>
  
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- ////////////////////////////////////second tab row////////////////////////////////// -->
  
              <div class="row" style="margin-top:30px">
                <div class="col-lg-4">
                  <div class="row">
                    <div class="col-lg-1" id="newtrip">To:</div>
                    <div class="col-lg-1">
                      <div class="form-check">
                        <input class="form-check-input closeCheckbox" type="checkbox" value="" id="Escalation-Sr.Manager">
                      </div>
  
                    </div>
                    <div class="col-lg-2" style="margin-left: 30px;">
                      <span class="badge bg-primary"
                        style="font-size: 12px;font-family:sans-serif;">Escalation-Sr.Manager</span>
                    </div>
                  </div>
                </div>
  
  
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-1" id="newtrip">To:</div>
                    <div class="col-lg-1">
                      <div class="form-check">
                        <input class="form-check-input closeCheckbox" type="checkbox" value="" id="Escalation-QR">
                      </div>
  
                    </div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;"><span class="badge bg-primary"
                        style="font-size: 12px;font-family:sans-serif;">Escalation-QR
                        Team</span>
                    </div>
                  </div>
                </div>
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-1" id="newtrip">To:</div>
                    <div class="col-lg-1">
                      <div class="form-check">
                        <input class="form-check-input closeCheckbox" type="checkbox" value="" id="Escalation-Field">
                      </div>
  
                    </div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;"><span class="badge bg-primary"
                        style="font-size: 12px;font-family:sans-serif;">Escalation-Field
                        Officer</span>
                    </div>
                  </div>
                </div>
              </div>
              <!-- ///////////////////////////////new tab///////////////// -->
              <div class="row" style="margin-top: 10px;">
                <div class="col-lg-4">
                  <div class="row">
                    <div class="col-lg-2" id="newtrip">Name:</div>
                    <div class="col-lg-2" style="margin-left: 30px;">
                      <div class="form-outline ">
                        <input type="text" id="closeInputBox" class="form-control" name="srManagerName" ngModel>
  
                      </div>
                    </div>
                  </div>
                </div>
  
  
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Name:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline ">
                        <input type="text" id="closeInputBox" class="form-control" name="qrTeamName" ngModel>
  
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Name:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline ">
                        <input type="text" id="closeInputBox" class="form-control" name="fieldOfficerName" ngModel>
  
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- ///////////////////////////////////////////////////////new tab////////////////// -->
              <div class="row" style="margin-top: 10px;">
                <div class="col-lg-4">
                  <div class="row">
                    <div class="col-lg-2" id="newtrip">At(hours):</div>
                    <div class="col-lg-2" style="margin-left: 30px;">
                      <div class="cs-form">
                        <input type="time" class="form-control" value="10:05 AM" id="closeInputBox" name="srManagerTime"
                          ngModel>
                      </div>
                    </div>
                  </div>
                </div>
  
  
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">At(hours):</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="cs-form">
                        <input type="time" class="form-control" value="10:05 AM" id="closeInputBox" name="qrTeamTime"
                          ngModel>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">At(hours):</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="cs-form">
                        <input type="time" class="form-control" value="10:05 AM" id="closeInputBox"
                          name="fieldOfficerTime" ngModel>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- ////////////////////////////////new tab///////////////////////////////////// -->
              <div class="row" style="margin-top: 10px;">
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Remarks:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline">
                        <textarea class="form-control" id="closeInputBox" rows="4" name="srManagerRemarks"
                          ngModel></textarea>
  
                      </div>
                    </div>
                  </div>
                </div>
  
  
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Remarks:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline">
                        <textarea class="form-control" id="closeInputBox" rows="4" name="qrTeamRemarks"
                          ngModel></textarea>
  
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Remarks:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline">
                        <textarea class="form-control" id="closeInputBox" rows="4" name="fieldOfficerRemarks"
                          ngModel></textarea>
  
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row" style="margin-top: 40px;">
                <button class="btn btn-outline-primary btn-sm" type="submit" id="AlertButton" style="max-width: 100px;
              margin-top:-10px;margin-left: 360px;color: black;" aria-expanded="false">SUBMIT</button>
              </div>
  
            </div>
          </form>
  
        </div>
        <!-- <div class="modal-footer" style="margin-bottom: 28px;">
  
  
          <i class="fe fe-truck" tooltipClass="customActive-tooltip-class" ngbTooltip="Device 1"
            style="font-size: 20px;color: blue;" id="blink"></i>
          <i class="fe fe-truck" tooltipClass="customInStopped-tooltip-class" ngbTooltip="Device 2"
            style="font-size: 20px;color: red;" id="blink"></i>
  
  
         
  
        </div> -->
      </div>
    </div>
  </div>
  <!-- ////////////////////////////////close model on desktop last old///////////////////////////////////////////////////////////////// -->
  <div class="modal fade" id="closeModalDeskold" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 1027px;margin-left: 260px;">
      <div class="modal-content">
  
        <div class="modal-header" style="background-color: white;">
          <button type="button" class="btn btn-sm" data-bs-toggle="modal" data-bs-target="#desklastalertModal"
            aria-label="Close"><i class="fa fa-arrow-left" ngbTooltip="Back"></i></button>
          <h3 class="modal-title" id="exampleModalLabel"
            style="margin-left: 220px;font-weight:700; color :#1c84c6;font-size: initial;"></h3>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form #closeTab="ngForm" (ngSubmit)="xCloseTabF(closeTab.value);closeTab.reset()">
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-6" style="font-size: 15px;">Prev. Status:&nbsp;&nbsp;<i class="fa fa-square"
                    ngbTooltip="Prev. Status" style="color: yellow;font-size: 15px;"></i>
                </div>
                <div class="col-lg-6" style="font-size: 15px;">History View:&nbsp;&nbsp;&nbsp;&nbsp;<i class="fa fa-eye"
                    ngbTooltip="Click Here" style="color: black;font-size: 18px;cursor: pointer;font-style: bold;"></i>
                </div>
  
              </div>
              <div style="font-size: 15px;">Escalation Level:&nbsp;&nbsp;2</div>
              <div style="margin-top: 10px;color: black;">
                <h4>X-Close Alert</h4>
              </div>
              <div class="row">
                <div class="col-lg-4">
                  <div class="row">
                    <div class="col-lg-1" id="newtrip">To:</div>
                    <div class="col-lg-1">
                      <div class="form-check">
                        <input class="form-check-input closeCheckbox" type="checkbox" value="" id="Driver">
                      </div>
  
                    </div>
                    <div class="col-lg-2" style="margin-left: 30px;"><span class="badge bg-primary"
                        style="font-size: 12px;font-family:sans-serif;">Driver</span></div>
                  </div>
                </div>
  
  
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-1" id="newtrip">To:</div>
                    <div class="col-lg-1">
                      <div class="form-check">
                        <input class="form-check-input closeCheckbox" type="checkbox" value=""
                          id="Escalation-Transporter">
                      </div>
  
                    </div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;"><span class="badge bg-primary"
                        style="font-size: 12px;font-family:sans-serif;">Escalation-Transporter</span>
                    </div>
                  </div>
                </div>
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-1" id="newtrip">To:</div>
                    <div class="col-lg-1">
                      <div class="form-check">
                        <input class="form-check-input closeCheckbox" type="checkbox" value="" id="Escalation-Manager">
                      </div>
  
                    </div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;"><span class="badge bg-primary"
                        style="font-size: 12px;font-family:sans-serif;">Escalation-Manager</span>
                    </div>
                  </div>
                </div>
              </div>
              <!-- ///////////////////////////////new tab///////////////// -->
              <div class="row" style="margin-top: 10px;">
                <div class="col-lg-4">
                  <div class="row">
                    <div class="col-lg-2" id="newtrip">Name:</div>
                    <div class="col-lg-2" style="margin-left: 30px;">
                      <div class="form-outline ">
                        <input type="text" id="closeInputBox" class="form-control" name="driverName" ngModel>
  
                      </div>
                    </div>
                  </div>
                </div>
  
  
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Name:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline ">
                        <input type="text" id="closeInputBox" class="form-control" name="transproterName" ngModel>
  
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Name:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline ">
                        <input type="text" id="closeInputBox" class="form-control" name="managerName" ngModel>
  
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- ///////////////////////////////////////////////////////new tab////////////////// -->
              <div class="row" style="margin-top: 10px;">
                <div class="col-lg-4">
                  <div class="row">
                    <div class="col-lg-2" id="newtrip">At(hours):</div>
                    <div class="col-lg-2" style="margin-left: 30px;">
                      <div class="cs-form">
                        <input type="time" class="form-control" value="10:05 AM" id="closeInputBox" name="driverTime"
                          ngModel>
                      </div>
                    </div>
                  </div>
                </div>
  
  
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">At(hours):</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="cs-form">
                        <input type="time" class="form-control" value="10:05 AM" id="closeInputBox" name="transporterTime"
                          ngModel>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">At(hours):</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="cs-form">
                        <input type="time" class="form-control" value="10:05 AM" id="closeInputBox" name="managerTime"
                          ngModel>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- ////////////////////////////////new tab///////////////////////////////////// -->
              <div class="row" style="margin-top: 10px;">
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Remarks:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline">
                        <textarea class="form-control" id="closeInputBox" rows="4" name="driverRemarks"
                          ngModel></textarea>
  
                      </div>
                    </div>
                  </div>
                </div>
  
  
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Remarks:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline">
                        <textarea class="form-control" id="closeInputBox" rows="4" name="transporterRemarks"
                          ngModel></textarea>
  
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Remarks:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline">
                        <textarea class="form-control" id="closeInputBox" rows="4" name="managerRemarks"
                          ngModel></textarea>
  
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- ////////////////////////////////////second tab row////////////////////////////////// -->
  
              <div class="row" style="margin-top:30px">
                <div class="col-lg-4">
                  <div class="row">
                    <div class="col-lg-1" id="newtrip">To:</div>
                    <div class="col-lg-1">
                      <div class="form-check">
                        <input class="form-check-input closeCheckbox" type="checkbox" value="" id="Escalation-Sr.Manager">
                      </div>
  
                    </div>
                    <div class="col-lg-2" style="margin-left: 30px;">
                      <span class="badge bg-primary"
                        style="font-size: 12px;font-family:sans-serif;">Escalation-Sr.Manager</span>
                    </div>
                  </div>
                </div>
  
  
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-1" id="newtrip">To:</div>
                    <div class="col-lg-1">
                      <div class="form-check">
                        <input class="form-check-input closeCheckbox" type="checkbox" value="" id="Escalation-QR">
                      </div>
  
                    </div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;"><span class="badge bg-primary"
                        style="font-size: 12px;font-family:sans-serif;">Escalation-QR
                        Team</span>
                    </div>
                  </div>
                </div>
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-1" id="newtrip">To:</div>
                    <div class="col-lg-1">
                      <div class="form-check">
                        <input class="form-check-input closeCheckbox" type="checkbox" value="" id="Escalation-Field">
                      </div>
  
                    </div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;"><span class="badge bg-primary"
                        style="font-size: 12px;font-family:sans-serif;">Escalation-Field
                        Officer</span>
                    </div>
                  </div>
                </div>
              </div>
              <!-- ///////////////////////////////new tab///////////////// -->
              <div class="row" style="margin-top: 10px;">
                <div class="col-lg-4">
                  <div class="row">
                    <div class="col-lg-2" id="newtrip">Name:</div>
                    <div class="col-lg-2" style="margin-left: 30px;">
                      <div class="form-outline ">
                        <input type="text" id="closeInputBox" class="form-control" name="srManagerName" ngModel>
  
                      </div>
                    </div>
                  </div>
                </div>
  
  
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Name:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline ">
                        <input type="text" id="closeInputBox" class="form-control" name="qrTeamName" ngModel>
  
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Name:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline ">
                        <input type="text" id="closeInputBox" class="form-control" name="fieldOfficerName" ngModel>
  
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- ///////////////////////////////////////////////////////new tab////////////////// -->
              <div class="row" style="margin-top: 10px;">
                <div class="col-lg-4">
                  <div class="row">
                    <div class="col-lg-2" id="newtrip">At(hours):</div>
                    <div class="col-lg-2" style="margin-left: 30px;">
                      <div class="cs-form">
                        <input type="time" class="form-control" value="10:05 AM" id="closeInputBox" name="srManagerTime"
                          ngModel>
                      </div>
                    </div>
                  </div>
                </div>
  
  
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">At(hours):</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="cs-form">
                        <input type="time" class="form-control" value="10:05 AM" id="closeInputBox" name="qrTeamTime"
                          ngModel>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">At(hours):</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="cs-form">
                        <input type="time" class="form-control" value="10:05 AM" id="closeInputBox"
                          name="fieldOfficerTime" ngModel>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- ////////////////////////////////new tab///////////////////////////////////// -->
              <div class="row" style="margin-top: 10px;">
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Remarks:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline">
                        <textarea class="form-control" id="closeInputBox" rows="4" name="srManagerRemarks"
                          ngModel></textarea>
  
                      </div>
                    </div>
                  </div>
                </div>
  
  
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Remarks:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline">
                        <textarea class="form-control" id="closeInputBox" rows="4" name="qrTeamRemarks"
                          ngModel></textarea>
  
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-4">
                  <div class="row" style="white-space: nowrap;">
                    <div class="col-lg-2" id="newtrip">Remarks:</div>
                    <div class="col-lg-2" style="margin-left: 30px;display: inline-block;">
                      <div class="form-outline">
                        <textarea class="form-control" id="closeInputBox" rows="4" name="fieldOfficerRemarks"
                          ngModel></textarea>
  
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row" style="margin-top: 40px;">
                <button class="btn btn-outline-primary btn-sm" type="submit" id="AlertButton" style="max-width: 100px;
              margin-top:-10px;margin-left: 360px;color: black;" aria-expanded="false">SUBMIT</button>
              </div>
  
            </div>
          </form>
  
        </div>
        <!-- <div class="modal-footer" style="margin-bottom: 28px;">
  
  
          <i class="fe fe-truck" tooltipClass="customActive-tooltip-class" ngbTooltip="Device 1"
            style="font-size: 20px;color: blue;" id="blink"></i>
          <i class="fe fe-truck" tooltipClass="customInStopped-tooltip-class" ngbTooltip="Device 2"
            style="font-size: 20px;color: red;" id="blink"></i>
  
  
         
  
        </div> -->
      </div>
    </div>
  </div>
  <!-- /////////////////////////////////////create new alert old ///////////////////////////////////////////////////// -->
  <div class="modal fade" id="createAlertModalx" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 900px;margin-left: 365px;">
      <div class="modal-content" style="height: 634px; width: 835px;">
  
        <div class="modal-header" style="background-color: white;">
          <h5 class="modal-title" id="exampleModalLabel" style="margin-left: 311px;font-weight:500; color :black;">NEW
            ALERT</h5>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" style="background-color: white !important;">
  
          <form>
            <!-- #newTrip="ngForm" (ngSubmit)="newTripF(newTrip.value);newTrip.reset()" -->
  
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-2" id="newtrip">
                  Id(ShipmentNo.)
                </div>
  
                <div class="col-lg-4">
                  <ng-select name="subassets" placeholder="" id="ShipmentNo" (change)="shipmentSelectF($event)"
                    [ngModel]="ShipmentNo" required name="shipment_no">
                    <ng-option value="" selected>--Select Shipment--</ng-option>
                    <ng-option *ngFor="let item of alltrip |keyvalue" [value]="item.key">{{item.key}}</ng-option>
  
                  </ng-select>
                </div>
                <div class="col-lg-2" id="newtrip">
                  Alert Type
                </div>
                <div class="col-lg-4">
                  <ng-select name="subassets" placeholder="" id="Type" (change)="alertTypeF($event)" [ngModel]="Type"
                    required name="type">
                    <ng-option value="" selected>--Select Type--</ng-option>
                    <ng-option value="2">Threat</ng-option>
                    <ng-option value="1">Trigger</ng-option>
  
                  </ng-select>
                </div>
  
  
              </div>
            </div>&nbsp;&nbsp;
  
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-2" id="newtrip">
                  Alert Name
                </div>
                <div class="col-lg-4">
                  <ng-select name="subassets" *ngIf="triggerSelectFlag==true" id="trigger" placeholder=""
                    [ngModel]="trigger" required name="sub_type_name">
                    <ng-option value="" selected>--Select trigger--</ng-option>
                    <ng-option *ngFor="let key of Object.keys (alertData) "
                      [value]="alertData[key]">{{alertData[key]}}</ng-option>
  
                  </ng-select>
                  <ng-select name="subassets" *ngIf="threatSelectFlag==true" placeholder="" [ngModel]="sub_type"
                    name="sub_type_name">
                    <ng-option value="" selected>--Select Threat--</ng-option>
                    <ng-option *ngFor="let key of Object.keys(threatsdata)"
                      [value]="threatsdata[key]">{{threatsdata[key].name}}</ng-option>
  
  
  
                  </ng-select>
  
                </div>
                <div class="col-lg-2" id="newtrip">
                  Route
                </div>
                <div class="col-lg-4">
                  <input type="text" id="form12" [ngModel]="newalertinfo.route" name="route" readonly disabled />
  
                  <!-- {{newalertinfo.route}} -->
                </div>
  
              </div>
            </div>&nbsp;&nbsp;
  
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-2" id="newtrip">
                  Source
                </div>
                <div class="col-lg-4">
                  <input type="text" id="form12" [ngModel]="newalertinfo.source_code" name="source" readonly disabled />
                  <!-- {{newalertinfo.source_code}} -->
                </div>
                <div class="col-lg-2" id="newtrip">
                  DriverInfo
                </div>
                <div class="col-lg-4">
                  <input type="text" id="form12" class="form-control" [ngModel]="newalertinfo.driver_info"
                    name="driver_info" style="font-size: 12px;" readonly />
                  <!-- {{newalertinfo.driver_info}} -->
                </div>
              </div>
            </div>&nbsp;&nbsp;
  
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-2" id="newtrip">
                  Run Date
                </div>
                <div class="col-lg-4">
                  <input type="text" id="form12" class="form-control" [ngModel]="newalertinfo.run_date" name="run_date"
                    readonly />
                  <!-- {{newalertinfo.run_date}} -->
                </div>
  
                <div class="col-lg-2" id="newtrip">
                  Vehicle No
                </div>
                <div class="col-lg-4">
                  <input type="text" id="form12" class="form-control" name="vehicle_no"
                    [ngModel]="newalertinfo?.vehicle_no" readonly />
                  <!-- {{newalertinfo.vehicle_no}} -->
                </div>
              </div>
            </div>&nbsp;&nbsp;
  
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-2" id="newtrip" *ngIf="triggerSelectFlag==true">
                  Level
                </div>
                <div class="col-lg-4" *ngIf="triggerSelectFlag==true">
                  <ng-select name="subassets" id="Level" placeholder="" [ngModel]="Level" required name="level">
                    <ng-option value="" selected>--Level--</ng-option>
                    <!-- *ngFor=" let item of Apicolor_array;ind=index" [value]="ind+1" -->
                    <ng-option [value]="1">1</ng-option>
                    <ng-option [value]="2">2</ng-option>
                    <ng-option [value]="3">3</ng-option>
                    <ng-option [value]="4">4</ng-option>
                    <!-- <ng-option [value]="1">5</ng-option>
                    <ng-option [value]="1">6</ng-option> -->
  
                  </ng-select>
                </div>
                <div class="col-lg-2" id="newtrip">
                  Log Time
                </div>
                <div class="col-lg-4">
                  <div class='input-group date' id='datetimepicker1'>
                    <input type="datetime-local" step="1" class="form-control" [ngModel]="datetimepicker1" required
                      name="log_time" />
  
                  </div>
  
  
                </div>&nbsp;&nbsp;
              </div>
            </div>&nbsp;&nbsp;
  
  
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-2" id="newtrip">
                  Location
                </div>
                <div class="col-lg-4">
                  <div class="form-outline">
                    <input type="text" id="Location" class="form-control" [ngModel]="Location" name="location" />
  
                  </div>
                </div>
                <div class="col-lg-2" id="newtrip">
                  Lat Long
                </div>
                <div class="col-lg-4">
                  <div>
                    <input type="text" id="geo" class="form-control" [ngModel]="geo" name="geocoord" />
                  </div>
                </div>
              </div>
  
            </div>&nbsp;&nbsp;
  
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-2" id="newtrip">
                  Message
                </div>
                <div class="col-lg-10">
                  <div class="form-outline">
                    <textarea class="form-control" id="msgarea" rows="3" [ngModel]="msgarea" name="message"
                      required></textarea>
  
                  </div>
                </div>
  
              </div>
            </div>&nbsp;&nbsp;
            <div class="col-lg-12">
              <button class="btn btn-outline-primary btn-sm" type="submit" id="AlertButton"
                style="margin-top: 15px;margin-left: 339px;" [disabled]="!newTrip.form.valid"
                [ngbTooltip]="newTrip.invalid ? 'some text' : ''">Submit</button>
            </div>
  
  
  
  
          </form>
  
        </div>
        <!-- <div class="modal-footer" style="margin-bottom: 28px;">
  
  
          <i class="fe fe-truck" tooltipClass="customActive-tooltip-class" ngbTooltip="Device 1"
            style="font-size: 20px;color: blue;" id="blink"></i>
          <i class="fe fe-truck" tooltipClass="customInStopped-tooltip-class" ngbTooltip="Device 2"
            style="font-size: 20px;color: red;" id="blink"></i>
  
  
         
        </div> -->
      </div>
  
  
    </div>
  
  </div>
  <!-- ////////////////////////////////////////////////assignQrt from last alert modal/////////////////////////////////////////////////////////////// -->
  <div class="modal fade" id="qrtModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 730px;margin-left: 458px;">
      <div class="modal-content" style="height: 275px;">
  
        <div class="modal-header" style="background-color: white;">
          <button type="button" class="btn btn-sm" data-bs-toggle="modal" data-bs-target="#desklastalertModal"
            aria-label="Close"><i class="fa fa-arrow-left" ngbTooltip="Back"></i></button>
          <h3 class="modal-title" id="exampleModalLabel"
            style="margin-left: 220px;font-weight:700; color :#1c84c6;font-size: initial;"></h3>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form #qrtForm="ngForm" (ngSubmit)="qrtSubmitF(qrtForm.value);qrtForm.reset()">
  
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-2" id="newtrip">
                  Shipment(ID)
                </div>
                <div class="col-lg-4" id="newAlert">{{graceShipment}}
                  <!-- <ng-select name="subassets" placeholder="" ngModel name="shipment_No" (change)="shipmentSelectF($event)"
                    required>
                    <ng-option value="" selected>--Select Trip--</ng-option>
                    <ng-option *ngFor="let item of alltrip |keyvalue" [value]="item.key">{{item.key}}</ng-option>
  
  
  
                  </ng-select> -->
                </div>
                <div class="col-lg-2" id="newtrip">
                  Vehicle(NO)
                </div>
                <div class="col-lg-4">
                  <label type="text" id="newAlert">{{graceVehicle}}</label>
                  <!-- name="vehicle_no" ngModel>{{graceVehicle}}</label> -->
                  <!-- <ng-select name="subassets" placeholder="" ngModel name="vehicle_No" required>
                    <ng-option value="" selected>--Select Vehicle--</ng-option>
                    <ng-option *ngFor="let item of AlltripValue "
                      [value]="item.vehicle_no">{{item.vehicle_no}}</ng-option>
  
  
  
                  </ng-select> -->
                </div>
              </div>
            </div>&nbsp;&nbsp;
  
  
            <div class="col-lg-12">
              <div class="row">
  
                <div class="col-lg-2" id="newtrip">
                  List QRT
                </div>
                <div class="col-lg-6">
                  <ng-select name="subassets" placeholder="" ngModel name="qrtUser" required>
                    <ng-option value="" selected>--Select Name--</ng-option>
                    <ng-option *ngFor="let item of qrtListData"
                      [value]="item.id">{{item.code}}/{{item.name}}/{{item.location}}</ng-option>
  
  
  
                  </ng-select>
                </div>
                <!-- <div class="col-lg-2" id="newtrip">
                  Remarks
                </div> -->
                <div class="col-lg-4">
                  <div class="form-outline">
                    <textarea class="form-control" id="msgarea" rows="2" [ngModel]="msgarea" name="remarks"
                      placeholder="Remarks" required></textarea>
  
                  </div><sup style="color:red;position: absolute;">*</sup>
                </div>
              </div>
            </div>&nbsp;&nbsp;
            <div class="col-lg-12">
              <button class="btn btn-outline-primary btn-sm" type="submit" id="AlertButton"
                style="margin-top: 15px;margin-left: 242px;" [disabled]="!qrtForm.form.valid">Submit</button>
              <!-- [disabled]="!newTrip.form.valid" -->
            </div>&nbsp;&nbsp;
  
          </form>
        </div>
  
      </div>
    </div>
  </div>
  <!-- //////////////////////////////////////////////////////threats table///////////////////////////////////////////////////// -->
  <div class="modal fade" id="threatsModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 1220px;margin-left: 260px;">
      <div class="modal-content" style="height: 634px; width: 835px;">
        <form>
          <div class="modal-header" style="background-color: white;">
            <!-- <h3 class="modal-title" id="exampleModalLabel"
              style="margin-left: 220px;font-weight:700; color :#1c84c6;font-size: initial;"></h3> -->
            <!-- <button class="btn btn-outline-primary btn-sm">CLose Trigger</button> -->
            <!-- <div style="display:inline-table;">
              <div class="dropdown">
                <button class="btn btn-outline-primary dropdown-toggle" type="button" id="dropdownMenuButton"
                  data-bs-toggle="dropdown" aria-expanded="false">
                  <span *ngIf="triggerFlag">All Triggers</span>
                  <span *ngIf="triggerFlagD">{{triggernamedata}}</span>&nbsp;
                  <i class="fa fa-caret-down"></i>
                </button>
                <ul class="dropdown-menu scrollable" aria-labelledby="dropdownMenuButton" id="myDropdownTrigger">
                  <li>
                    <div class="hs-searchbox">
                      <input type="text" class="form-control searchInput" autocomplete="off" id="myInputTrigger"
                        (keyup)="searchboxTrigger()" placeholder="Search">
                    </div>
                  </li>
  
                  <li><a class="dropdown-item" (click)="triggerF('All Triggers')"
                      style="color:blue;font-style: bold;font-weight: 500px;">All Triggers</a></li>
                  <li *ngFor="let item of alertData  | keyvalue"><a class="dropdown-item"
                      (click)="triggerF(item.value)">{{item.value}}</a></li>
                  
                </ul>
              </div>
  
  
            </div>&nbsp; -->
            <div style="display:inline-table;">
              <div class="dropdown">
                <button class="btn btn-outline-primary dropdown-toggle" type="button" id="dropdownMenuButton"
                  data-bs-toggle="dropdown" aria-expanded="false">
                  <span *ngIf="threatFlag">All Threat</span>
                  <span *ngIf="threatFlagD">{{threaddata}}</span>&nbsp;
                  <i class="fa fa-caret-down"></i>
                </button>
                <ul class="dropdown-menu scrollable" aria-labelledby="dropdownMenuButton" id="myDropdownTrigger">
                  <!-- <li>
                    <div class="hs-searchbox">
                      <input type="text" class="form-control searchInput" autocomplete="off" id="myInputTrigger"
                        (keyup)="searchboxTrigger()" placeholder="Search">
                    </div>
                  </li> -->
  
                  <!-- <li><a class="dropdown-item" (click)="triggerF('All Triggers')"
                      style="color:blue;font-style: bold;font-weight: 500px;">All Triggers</a></li> -->
                  <!-- <li *ngFor="let item of alertData  | keyvalue"><a class="dropdown-item"
                      (click)="triggerF(item.value)">{{item.value}}</a></li> -->
                  <li><a class="dropdown-item" (click)="threatF('All Threat')"
                      style="color:blue;font-style: bold;font-weight: 500px;">All Threat</a></li>
                  <li><a class="dropdown-item" (click)="threatF('Hi Jack')"
                      style="color:blue;font-style: bold;font-weight: 500px;">Hi Jack</a></li>
  
                  <li><a class="dropdown-item" (click)="threatF('TPND')"
                      style="color:blue;font-style: bold;font-weight: 500px;">TPND</a></li>
                  <li><a class="dropdown-item" (click)="threatF('Accident')"
                      style="color:blue;font-style: bold;font-weight: 500px;">Accident</a></li>
                  <li><a class="dropdown-item" (click)="threatF('Theft')"
                      style="color:blue;font-style: bold;font-weight: 500px;">Theft</a></li>
  
  
                  <!-- <li><a class="dropdown-item" href="#">NG60</a></li> -->
                </ul>
              </div>
  
  
            </div>&nbsp;
            <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-lg-12" style="margin-left:239px;">
                <!-- <div style="display:inline-table;">
                  <button type="button" class="btn btn-outline-primary btn-sm" id="tablepopUpButtn" data-bs-toggle="modal"
                    data-bs-target="#qrtModal">QRT</button>&nbsp;
  
                </div> -->
                <!-- <div style="display:inline-table;">
                  <button type="button" class="btn btn-outline-primary btn-sm" id="tablepopUpButtn" [disabled]="graceBtnFlag"
                    data-bs-toggle="modal" data-bs-target="#graceModal">Grace</button>&nbsp;
                </div> -->
                <!-- <div style="display:inline-table;">
                  <button type="button" class="btn btn-outline-primary btn-sm" id="tablepopUpButtn" (click)="xcloseF()"
                    data-bs-toggle="modal" data-bs-target="#closeModal">XClose</button>&nbsp;
                </div> -->
                <div style="display:inline-table;">
                  <button type="button" class="btn btn-outline-primary btn-sm" id="tablepopUpButtn" data-bs-toggle="modal"
                    data-bs-target="#actionqrtDesktopModal" [disabled]="threatActionBtnflag">Action</button>
                </div>&nbsp;
                <div style="display:inline-table;">
                  <button type="button" class="btn btn-outline-primary btn-sm" id="tablepopUpButtn" data-bs-toggle="modal"
                    (click)="threatHistory()" data-bs-target="#threatHistorymodal"
                    [disabled]="threatActionBtnflag">History</button>
                </div>
              </div>
            </div>
            <table class="display nowrap table table-Success table-striped table-hover" cellspacing="0" id="threatTable">
              <thead>
                <tr style="text-align: center;">
                  <th class="table-primary">S.No.</th>
                  <th class="table-primary">
  
  
                    <input class="form-check-input" type="checkbox" value="" id="flexCheckChecked"
                      style="margin-top: -16px;margin-left: -7px;" disabled>
  
  
  
  
                  </th>
  
                  <th class="table-primary">Vehicles</th>
                  <th class="table-primary">Alert Type</th>
                  <th class="table-primary">ShipmentNo</th>
                  <th class="table-primary">Sorce</th>
                  <th class="table-primary">Destination</th>
                  <!-- <th class="table-primary">Threat</th> -->
                  <th class="table-primary">Recieved Time</th>
                  <th class="table-primary">Start Time</th>
                  <th class="table-primary">End Time</th>
                  <th class="table-primary">Location/Message</th>
  
                  <th class="table-primary">Driver(Mobile)</th>
                  <th class="table-primary">Route</th>
  
                </tr>
  
              </thead>
              <tbody>
                <tr *ngFor="let item of allThreatData;let ind=index" style="text-align: center;">
                  <td>{{ind+1}}</td>
                  <td>
  
                    <input class="form-check-input" type="checkbox" value="" id="threadCheckId"
                      style="    margin-top: -6px;margin-left: -7px;"
                      (change)="threatTcheckF(item.id,item.TripID,item.AlertType,$event)">
  
  
  
                  </td>
                  <td>
                    {{item.VehicleNo}}
                  </td>
                  <td [style.color]="item.color"> {{item.AlertType}}</td>
                  <td>{{item.TripID}}</td>
                  <td>{{item.SourceInfo}}</td>
                  <td>{{item.DestinationInfo}}</td>
                  <!-- <td> <i class="fa fa-exclamation-triangle" *ngIf="item.threat.length!=0" [ngbTooltip]="item.threat[0].location" style="color: red;"></i></td> -->
                  <td>{{item.LogTime}}</td>
                  <td>{{item.StartDate}}</td>
                  <td>{{item.EndDate}}</td>
                  <td>{{item.Location}}/{{item.Message}}</td>
  
                  <td>{{item.DriverInfo}}</td>
                  <td>{{item.RouteInfo}}</td>
  
                </tr>
              </tbody>
            </table>
  
          </div>
  
  
        </form>
      </div>
  
    </div>
  </div>
  <!-- ///////////////////////////////////////////////////////////////////assign qrt from desktop/////////////////////////////// -->
  <div class="modal fade" id="qrtDesktopModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 730px;margin-left: 458px;">
      <div class="modal-content" style="height: 260px;">
  
        <div class="modal-header" style="background-color: white;">
          <!-- <button type="button" class="btn btn-sm" data-bs-toggle="modal" aria-label="Close"><i class="fa fa-arrow-left"
              ngbTooltip="Back"></i></button> -->
          <h3 class="modal-title" id="exampleModalLabel"
            style="margin-left: 220px;font-weight:700; color :#1c84c6;font-size: initial;"></h3>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form #qrtFormdsk="ngForm" (ngSubmit)="qrtSubmitDskF(qrtFormdsk.value);qrtFormdsk.reset()">
  
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-2" id="newtrip">
                  Shipment(ID)
                </div>
                <div class="col-lg-4">
                  <ng-select name="subassets" placeholder="" ngModel name="shipment_No" (change)="shipmentSelectF($event)"
                    required>
                    <ng-option value="" selected>--Select Trip--</ng-option>
                    <ng-option *ngFor="let item of alltrip |keyvalue" [value]="item.key">{{item.key}}</ng-option>
  
  
  
                  </ng-select>
                </div>
                <div class="col-lg-2" id="newtrip">
                  Vehicle(NO)
                </div>
                <div class="col-lg-4">
                  <label type="text" id="newAlert">{{newalertinfo?.vehicle_no}}</label>
                  <!-- <ng-select name="subassets" placeholder="" ngModel name="vehicle_No" required>
                    <ng-option value="" selected>--Select Vehicle--</ng-option>
                    <ng-option *ngFor="let item of AlltripValue "
                      [value]="item.vehicle_no">{{item.vehicle_no}}</ng-option>
  
  
  
                  </ng-select> -->
                </div>
              </div>
            </div>&nbsp;&nbsp;
  
  
            <div class="col-lg-12">
              <div class="row">
  
                <div class="col-lg-2" id="newtrip">
                  List QRT
                </div>
                <div class="col-lg-6">
                  <ng-select name="subassets" placeholder="" ngModel name="qrtUser" required>
                    <ng-option value="" selected>--Select Name--</ng-option>
                    <ng-option *ngFor="let item of qrtListData"
                      [value]="item.id">{{item.code}}/{{item.name}}/{{item.location}}</ng-option>
  
  
  
                  </ng-select>
                </div>
                <!-- <div class="col-lg-2" id="newtrip">
                  Remarks
                </div> -->
                <div class="col-lg-4">
                  <div class="form-outline">
                    <textarea class="form-control" id="msgarea" rows="2" [ngModel]="msgarea" name="remarks"
                      placeholder="Remarks" required></textarea>
  
                  </div><sup style="color:red;position: absolute;">*</sup>
                </div>
              </div>
            </div>&nbsp;&nbsp;
            <div class="col-lg-12">
              <button class="btn btn-outline-primary btn-sm" type="submit" id="AlertButton"
                style="margin-top: 15px;margin-left: 242px;">Submit</button>
              <!-- [disabled]="!newTrip.form.valid" -->
            </div>&nbsp;&nbsp;
  
          </form>
        </div>
  
      </div>
    </div>
  </div>
  <!-- /////////////////////////////////////////////////////////////////action on threat///////////////////////////////////// -->
  <div class="modal fade" id="actionqrtDesktopModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style="margin-left: 260px;">
      <div class="modal-content">
  
        <div class="modal-header" style="background-color: white;">
          <button type="button" class="btn btn-sm" data-bs-toggle="modal" data-bs-target="#threatsModal"
            aria-label="Close"><i class="fa fa-arrow-left" ngbTooltip="Back"></i></button>
          <h3 class="modal-title" id="exampleModalLabel"
            style="margin-left: 220px;font-weight:700; color :#1c84c6;font-size: initial;"></h3>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
  
          <form #threatAction="ngForm" (ngSubmit)="threatActionF(threatAction.value);threatAction.reset()">
            <div class="col-lg-12">
  
              <div class="row">
                <!-- <div class="col-lg-6">
                  <table class="table table-secondary table-striped" style="width: 400px;">
                    <thead>
                      <tr>
                        <th scope="col" style="color: black;">User</th>
                        <th scope="col" style="color: black;">Sms</th>
                        <th scope="col" style="color: black;">Email</th>
                        <th scope="col" style="color: black;">Level</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td scope="row">U1</td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="" id="U1Sms" name="U1Sms"
                              [ngModel]="U1Sms">
  
                          </div>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="" id="flexCheckDefault"
                              name="U1Email" ngModel>
  
                          </div>
                        </td>
                        <td>Level1</td>
                      </tr>
                      <tr>
                        <td scope="row">U2</td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="" id="flexCheckDefault"
                              name="U2Sms" ngModel>
  
                          </div>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="" id="flexCheckDefault"
                              name="U2Email" ngModel>
  
                          </div>
                        </td>
                        <td>Level3</td>
                      </tr>
                      <tr>
                        <td scope="row">U3</td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="true" id="U3Sms"
                              name="U3Sms" ngModel checked disabled>
  
                          </div>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="true" id="U3Email"
                              name="U3Email" ngModel checked disabled>
  
                          </div>
                        </td>
                        <td>Level4</td>
                      </tr>
                      <tr>
                        <td scope="row">U4</td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="true" id="U4Sms" checked
                              disabled name="U4Sms" ngModel>
  
                          </div>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="" id="flexCheckDefault"
                              name="U4Email" ngModel>
  
                          </div>
                        </td>
                        <td>Level4</td>
                      </tr>
                      <tr>
                        <td scope="row">U5</td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="" id="flexCheckDefault"
                              name="U5Sms" ngModel>
  
                          </div>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="" id="flexCheckDefault"
                              name="U5Email" ngModel>
  
                          </div>
                        </td>
                        <td>Level2</td>
                      </tr>
                      <tr>
                        <td scope="row">U6</td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="" id="flexCheckDefault"
                              name="U6Sms" ngModel>
  
                          </div>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="" id="flexCheckDefault"
                              name="U6Email" ngModel>
  
                          </div>
                        </td>
                        <td>Level3</td>
                      </tr>
                      <tr>
                        <td scope="row">U7</td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="" id="flexCheckDefault"
                              name="U7Sms" ngModel>
  
                          </div>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" value="true" id="U7Email"
                              name="U7Email" ngModel checked disabled>
  
                          </div>
                        </td>
                        <td>Level2</td>
                      </tr>
                    </tbody>
                  </table>
                </div> -->
                <div class="col-lg-12">
                  <div class="form-outline">
                    <ng-select name="subassets" placeholder="" id="actionThreatList" (change)="actionThreatList($event)"
                      [ngModel]="actionThreatList" required name="actionThreatList">
                      <ng-option value="" selected>--Action Type--</ng-option>
                      <ng-option [value]="0">Close</ng-option>
                      <ng-option [value]="1">Threat confirmed</ng-option>
                      <ng-option [value]="2">QRT ICLM engaged</ng-option>
                      <ng-option [value]="3">QRT External engaged</ng-option>
                      <ng-option [value]="4">Ground assistance requested</ng-option>
  
                    </ng-select>
  
                  </div>&nbsp;
                  <div class="form-outline">
                    <textarea class="form-control" rows="2" placeholder="Enter Remarks Here.." name="graceRemarks"
                      [ngModel]="graceRemarks" required></textarea>
  
                  </div>
                  <div class="col-lg-12">
                    <button class="btn btn-outline-primary btn-sm" type="submit" id="AlertButton" style="max-width: 100px;
                    margin-top: 32px;color: black; margin-left: 125px;" aria-expanded="false">SUBMIT</button>
                  </div>
                </div>
              </div>
  
            </div>
          </form>
  
        </div>
        <!-- <div class="modal-footer" style="margin-bottom: 28px;">
  
  
          <i class="fe fe-truck" tooltipClass="customActive-tooltip-class" ngbTooltip="Device 1"
            style="font-size: 20px;color: blue;" id="blink"></i>
          <i class="fe fe-truck" tooltipClass="customInStopped-tooltip-class" ngbTooltip="Device 2"
            style="font-size: 20px;color: red;" id="blink"></i>
  
  
         
  
        </div> -->
      </div>
    </div>
  </div>
  <!-- ////////////////////////////////////////////////////escalation popup above ///////////////////////////////////////////// -->
  <div class="modal fade" id="escalationModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 500px;margin-left: 260px;">
      <div class="modal-content" style="height: 320px;">
  
        <div class="modal-header" style="background-color: white;">
          <button type="button" class="btn btn-sm" data-bs-toggle="modal" data-bs-target="#triggerModal"
            aria-label="Close"><i class="fa fa-arrow-left" ngbTooltip="Back"></i></button>
          <h3 class="modal-title" id="exampleModalLabel"
            style="margin-left: 220px;font-weight:700; color :#1c84c6;font-size: initial;"></h3>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <!-- <div class="col-lg-12" style="font-size: 15px;">History View:&nbsp;&nbsp;&nbsp;&nbsp;<a role="button"
              (click)="escalationHistory()"><i class="fa fa-eye" ngbTooltip="Click Here"
                style="color: black;font-size: 18px;cursor: pointer;font-style: bold;"></i></a> -->
          <!-- <div *ngIf="escalationHistoryFlag" style="overflow: auto;overflow-y: auto;max-height: 160px;">
              <table class="table table-secondary table-striped" style="width: 400px;" id="ModalTble">
                <thead>
                  <tr>
                    <th scope="col" style="color: black;">Trigger type</th>
                    <th scope="col" style="color: black;">Grace_period_requested</th>
                    <th scope="col" style="color: black;">Grace_period_starttime</th>
                    <th scope="col" style="color: black;">Grace_taken</th>
                    <th scope="col" style="color: black;">Trip id</th>
                    <th scope="col" style="color: black;">Mail_to</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of escaHistoryData[0]">
                    <td>{{item.trigger_type}}</td>
                    <td>{{item.grace_period_requested}}</td>
                    <td>{{item.grace_period_starttime}}</td>
                    <td>{{item.grace_taken}}</td>
                    <td>{{item.trip_id}}</td>
                    <td>{{item.mail_to}}</td>
                  </tr>
                </tbody>
              </table>
            </div> -->
          <!-- </div>&nbsp;&nbsp; -->
  
          <form #escalationAbove="ngForm" (ngSubmit)="escalationF(escalationAbove.value);escalationAbove.reset()">
            <div class="col-lg-12">
  
              <div class="row">
                <!-- <div class="col-lg-6">
                  <table class="table table-secondary table-striped" style="width: 400px;" id="ModalTble">
                    <thead>
                      <tr>
                        <th scope="col" style="color: black;">User</th>
                        <th scope="col" style="color: black;">Sms</th>
                        <th scope="col" style="color: black;">Email</th>
                        <th scope="col" style="color: black;">Level</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let item of user_escalationinfo">
                        <td scope="row">{{item.name}}</td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" [disabled]="item.checked_sms"
                              (change)="triggerCheckSmsF($event,item.phone_no)">
                           
  
                          </div>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" [disabled]="item.checked_email"
                              (change)="triggerCheckemailF($event,item.email_id)">
  
                          </div>
                        </td>
                        <td>{{item.role}}</td>
                      </tr>
                  
                    </tbody>
                  </table>
                </div> -->
                <div class="row">
  
                  <div class="form-outline">
                    <ng-select name="subassets" placeholder="" id="actionThreatList" [ngModel]="actionThreatList" required
                      name="actionLevel">
                      <ng-option value="" selected>-- Select Level--</ng-option>
  
                      <ng-option *ngFor="let item of Apicolor_array | slice:color_level;let ind=index" [value]="ind+1">
                        <i class="fa fa-square" [style.color]="item" style="font-size: 20px;"></i>
                      </ng-option>
  
  
  
                    </ng-select>
  
                  </div>&nbsp;
                  <div class="form-outline">
                    <textarea class="form-control" rows="4" placeholder="Enter Remarks Here.." name="graceRemarks"
                      [ngModel]="escalationRemarks" required></textarea>
  
                  </div>
                  <div class="row">
                    <button class="btn btn-outline-primary btn-sm" type="submit" id="AlertButton" style="max-width: 100px;
                    margin-top: 32px;color: black;margin-left: 145px" aria-expanded="false">SUBMIT</button>
                  </div>
                </div>
              </div>
  
            </div>
          </form>
  
        </div>
  
      </div>
    </div>
  </div>
  
  
  <!-- /////////////////////////////////////////escalation poup on desktop//////////////////////////////////////////// -->
  <div class="modal fade" id="escalationModalDesk" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 500px;margin-left: 260px;">
      <div class="modal-content" style="height: 320px;">
  
        <div class="modal-header" style="background-color: white;">
          <button type="button" class="btn btn-sm" data-bs-toggle="modal" data-bs-target="#desklastalertModal"
            aria-label="Close"><i class="fa fa-arrow-left" ngbTooltip="Back"></i></button>
          <h3 class="modal-title" id="exampleModalLabel"
            style="margin-left: 220px;font-weight:700; color :#1c84c6;font-size: initial;"></h3>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <!-- <div class="col-lg-12" style="font-size: 15px;">History View:&nbsp;&nbsp;&nbsp;&nbsp;<a role="button"
              (click)="escalationHistory()"><i class="fa fa-eye" ngbTooltip="Click Here"
                style="color: black;font-size: 18px;cursor: pointer;font-style: bold;"></i></a> -->
          <!-- <div *ngIf="escalationHistoryFlag" style="overflow: auto;overflow-y: auto;max-height: 160px;">
              <table class="table table-secondary table-striped" style="width: 400px;" id="ModalTble">
                <thead>
                  <tr>
                    <th scope="col" style="color: black;">Trigger type</th>
                    <th scope="col" style="color: black;">Grace_period_requested</th>
                    <th scope="col" style="color: black;">Grace_period_starttime</th>
                    <th scope="col" style="color: black;">Grace_taken</th>
                    <th scope="col" style="color: black;">Trip id</th>
                    <th scope="col" style="color: black;">Mail_to</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of escaHistoryData[0]">
                    <td>{{item.trigger_type}}</td>
                    <td>{{item.grace_period_requested}}</td>
                    <td>{{item.grace_period_starttime}}</td>
                    <td>{{item.grace_taken}}</td>
                    <td>{{item.trip_id}}</td>
                    <td>{{item.mail_to}}</td>
                  </tr>
                </tbody>
              </table>
            </div> -->
          <!-- </div>&nbsp;&nbsp; -->
  
          <form #escalation="ngForm" (ngSubmit)="escalationF(escalation.value);escalation.reset()">
            <div class="col-lg-12">
  
              <div class="row">
                <!-- <div class="col-lg-6">
                  <table class="table table-secondary table-striped" style="width: 400px;" id="ModalTble">
                    <thead>
                      <tr>
                        <th scope="col" style="color: black;">User</th>
                        <th scope="col" style="color: black;">Sms</th>
                        <th scope="col" style="color: black;">Email</th>
                        <th scope="col" style="color: black;">Level</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let item of user_escalationinfo">
                        <td scope="row">{{item.name}}</td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" [disabled]="item.checked_sms"
                              (change)="triggerCheckSmsF($event,item.phone_no)">
                            
  
                          </div>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" [disabled]="item.checked_email"
                              (change)="triggerCheckemailF($event,item.email_id)">
  
                          </div>
                        </td>
                        <td>{{item.role}}</td>
                      </tr>
                     
                    </tbody>
                  </table>
                </div> -->
                <div class="row">
  
                  <div class="form-outline">
                    <ng-select name="subassets" placeholder="Select Level" id="actionThreatList"
                      [ngModel]="actionThreatListActLeve" required name="actionLevel">
                      <ng-option value="" selected>-- Select Level--</ng-option>
  
                      <ng-option *ngFor="let item of Apicolor_array | slice:color_level;let ind=index" [value]="ind+1">
                        <i class="fa fa-square" [style.color]="item" style="font-size: 20px;"></i>
                      </ng-option>
  
  
  
                    </ng-select>
  
                  </div>&nbsp;
                  <div class="form-outline">
                    <textarea class="form-control" rows="4" placeholder="Enter Remarks Here.." name="graceRemarks"
                      [ngModel]="escalationRemarks" required></textarea>
  
                  </div>
                  <div class="col-lg-6">
                    <button class="btn btn-outline-primary btn-sm" type="submit" id="AlertButton" style="max-width: 100px;
                    margin-top: 32px;color: black;margin-left: 145px" aria-expanded="false">SUBMIT</button>
                  </div>
                </div>
              </div>
  
            </div>
          </form>
  
        </div>
        <!-- <div class="modal-footer" style="margin-bottom: 28px;">
  
  
          <i class="fe fe-truck" tooltipClass="customActive-tooltip-class" ngbTooltip="Device 1"
            style="font-size: 20px;color: blue;" id="blink"></i>
          <i class="fe fe-truck" tooltipClass="customInStopped-tooltip-class" ngbTooltip="Device 2"
            style="font-size: 20px;color: red;" id="blink"></i>
  
  
         
  
        </div> -->
      </div>
    </div>
  </div>
  <!-- ////////////////////////////////////////////////////////desktop last alert modal//////////////////////////////////////////////// -->
  <div class="modal fade" id="desklastalertModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 1200px;margin-left: 100px;">
      <div class="modal-content" style="height: 634px;">
        <form>
          <div class="modal-header" style="background-color: white;">
  
            <!-- <h3 class="modal-title" id="exampleModalLabel"
              style="margin-left: 220px;font-weight:700; color :#1c84c6;font-size: initial;"></h3> -->
            <!-- <button class="btn btn-outline-primary btn-sm">CLose Trigger</button> -->
            <div style="display:inline-table;">
              <div class="dropdown">
                <button class="btn btn-outline-primary dropdown-toggle" type="button" id="dropdownMenuButton"
                  data-bs-toggle="dropdown" aria-expanded="false">
                  <span *ngIf="triggerFlag">All Triggers</span>
                  <span *ngIf="triggerFlagD">{{triggernamedata}}</span>&nbsp;
                  <i class="fa fa-caret-down"></i>
                </button>
                <ul class="dropdown-menu scrollable" aria-labelledby="dropdownMenuButton" id="myDropdownTrigger">
                  <li>
                    <div class="hs-searchbox">
                      <input type="text" class="form-control searchInput" autocomplete="off" id="myInputTrigger"
                        (keyup)="searchboxTrigger()" placeholder="Search">
                    </div>
                  </li>
  
                  <li><a class="dropdown-item" (click)="triggerDeskF('All Triggers')"
                      style="color:blue;font-style: bold;font-weight: 500px;">All Triggers</a></li>
                  <li *ngFor="let item of alertData  | keyvalue"><a class="dropdown-item"
                      (click)="triggerDeskF(item.value)">{{item.value}}</a></li>
                  <!-- <li><a class="dropdown-item" href="#">NG60</a></li> -->
                </ul>
              </div>
  
  
            </div>&nbsp;
            <!-- <div style="display:inline-table;">
              <div class="dropdown">
                <button class="btn btn-outline-primary dropdown-toggle" type="button" id="dropdownMenuButton"
                  data-bs-toggle="dropdown" aria-expanded="false">
                  <span *ngIf="threatFlag">Threat</span>
                  <span *ngIf="threatFlagD">{{threaddata}}</span>&nbsp;
                  <i class="fa fa-caret-down"></i>
                </button>
                <ul class="dropdown-menu scrollable" aria-labelledby="dropdownMenuButton" id="myDropdownTrigger">
                  <li>
                    <div class="hs-searchbox">
                      <input type="text" class="form-control searchInput" autocomplete="off" id="myInputTrigger"
                        (keyup)="searchboxTrigger()" placeholder="Search">
                    </div>
                  </li>
  
                 
                  <li><a class="dropdown-item" (click)="threatF('Threat')"
                      style="color:blue;font-style: bold;font-weight: 500px;">Threat</a></li>
                  <li><a class="dropdown-item" (click)="threatF('Hi Jack')"
                      style="color:blue;font-style: bold;font-weight: 500px;">Hi Jack</a></li>
  
                  <li><a class="dropdown-item" (click)="threatF('TPND')"
                      style="color:blue;font-style: bold;font-weight: 500px;">TPND</a></li>
                  <li><a class="dropdown-item" (click)="threatF('Accident')"
                      style="color:blue;font-style: bold;font-weight: 500px;">Accident</a></li>
                  <li><a class="dropdown-item" (click)="threatF('Theft')"
                      style="color:blue;font-style: bold;font-weight: 500px;">Theft</a></li>
  
  
                  
                </ul>
              </div>
  
  
            </div>&nbsp; -->
            <button class="btn-close btn-sm" id="btnUncheckAll" data-bs-dismiss="modal" aria-label="Close"></button>
  
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-lg-12" style="margin-left:150px;">
                <!-- <div style="display:inline-table;">
                  <button type="button" *ngIf="permission.add_document_on_trip==1" class="btn btn-outline-dark btn-sm" id="tablepopUpButtn"
                  
                  data-bs-toggle="modal" data-bs-target="#upload_image"
                       style="width: 40px;" [disabled]="uploadimageFlage">
                   <i class="fa fa-upload" ngbTooltip="Upload Image" style="font-size: 20px;color: #1c84c6;"></i></button>
                </div>&nbsp; -->
                <div style="display:inline-table;">
                  <button type="button" *ngIf="permission?.assign_qrt_team==1" class="btn btn-outline-primary btn-sm"
                    id="tablepopUpButtn" data-bs-toggle="modal" data-bs-target="#qrtModal"
                    [disabled]="qrtFlag">QRT</button>&nbsp;
  
                </div>
                <div style="display:inline-table;">
                  <button type="button" *ngIf="permission?.snooz==1" class="btn btn-outline-primary btn-sm"
                    id="tablepopUpButtn" [disabled]="graceBtnFlag" data-bs-toggle="modal"
                    data-bs-target="#graceModalDesk">Grace</button>&nbsp;
                </div>
                <div style="display:inline-table;">
                  <button type="button" *ngIf="permission?.close_alert==1" class="btn btn-outline-danger btn-sm"
                    id="tablepopUpButtn" (click)="xcloseF()" data-bs-toggle="modal" data-bs-target="#closeModalDesk"
                    [disabled]="iscloseFlagbtn">Close</button>&nbsp;
                </div>
  
                <div style="display:inline-table;">
  
                  <button type="button" *ngIf="permission?.escalate==1" class="btn btn-outline-primary btn-sm"
                    id="tablepopUpButtn" data-bs-toggle="modal" data-bs-target="#escalationModalDesk"
                    (click)="getEscalationInfo()" [disabled]="escalationbtnFlag">Escalation</button>&nbsp;
                </div>
                <div style="display:inline-table;">
  
                  <button type="button" *ngIf="permission?.history_and_summary==1" class="btn btn-outline-primary btn-sm"
                    id="tablepopUpButtn" data-bs-toggle="modal" data-bs-target="#historyLastAlertDesk"
                    (click)="escalationHistory();graceHistory()" [disabled]="escalationbtnFlag">History
                    <!-- <i class="fa fa-book" ngbTooltip="View History" placement="top" container="body"></i> -->
                  </button>
                </div>
              </div>
            </div>
            <div style="overflow: auto;">
              <table class="display nowrap table table-Success table-striped table-hover" cellspacing="0"
                id="lastalertTableId">
                <thead>
                  <tr style="text-align: center;">
                    <th class="table-primary">S.No.</th>
                    <th class="table-primary">
  
  
                      <input class="form-check-input" type="checkbox" value="" id="lastalertCheckAll"
                        (change)="getAllCheckboxItemNew($event)" style="margin-top: -16px;margin-left: -7px;" />
  
  
  
  
                    </th>
  
                    <th class="table-primary">Vehicles</th>
                    <th class="table-primary">Trigger Name</th>
                    <th class="table-primary">ShipmentNo</th>
                    <th class="table-primary">Sorce</th>
                    <th class="table-primary">Destination</th>
                    <!-- <th class="table-primary">Threat</th> -->
                    <th class="table-primary">Recieved Time</th>
                    <th class="table-primary">Start Time</th>
                    <th class="table-primary">End Time</th>
                    <th class="table-primary">Location/Message</th>
  
                    <th class="table-primary">Driver(Mobile)</th>
                    <th class="table-primary">Route</th>
  
                  </tr>
  
                </thead>
                <tbody>
                  <!-- *ngIf="lastAlertdata.length" -->
                  <tr *ngFor="let item of lastAlertdata;let ind=index" style="text-align: center;">
                    <td>{{ind+1}}</td>
                    <td>
  
                      <input class="form-check-input" type="checkbox" value="" id="triggerId"
                        style="margin-top: -6px;margin-left: -7px;" name="triggerIdLastAlert"
                        (change)="trigTcheckF(item.id,$event);graceCheckF($event,item.AlertType,item.id,item.level,item.TripID,item.VehicleNo)">
  
  
  
                    </td>
                    <td>
                      {{lastalrtVehicleno}}
                    </td>
                    <td style="text-align:left ;"><i class="fa fa-square" style="font-size: 15px;"
                        [style.color]="item.color"></i>{{item.alert_type}}
                      <button *ngIf="item.escalation_type=='grace'">
                        <i class="fa fa-clock-o" style="font-size: 20px;" [ngbTooltip]="item.escalation_type"
                          placement="top" container="body"></i></button>
                    </td>
                    <td>{{item.shipment_no}}</td>
                    <td>{{item.source_code}}</td>
                    <td>{{item.destination_code}}</td>
                    <!-- <td> <i class="fa fa-exclamation-triangle" *ngIf="item.threat.length!=0" [ngbTooltip]="item.threat[0].location" style="color: red;"></i></td> -->
                    <td>{{item.sts}}</td>
                    <td>{{item.start_time}}</td>
                    <td>{{item.end_time}}</td>
                    <td>{{item.location}}</td>
  
                    <td>{{item.driver_name}}/{{item.driver_mobile}}</td>
                    <td>{{item.route_code}}</td>
  
                  </tr>
                </tbody>
              </table>
            </div>
  
          </div>
  
          <!-- <div class="modal-footer" >
  
  
             <i class="fe fe-truck" tooltipClass="customActive-tooltip-class" ngbTooltip="Device 1"
            style="font-size: 20px;color: blue;" id="blink"></i>
           <i class="fe fe-truck" tooltipClass="customInStopped-tooltip-class" ngbTooltip="Device 2"
            style="font-size: 20px;color: red;" id="blink"></i> -->
  
  
          <!-- <button type="button" class="btn btn" data-bs-dismiss="modal"
              style="background-color:#1c84c6;border-color: #1c84c6;color: white ;">Close</button> -->
  
          <!-- </div> -->
        </form>
      </div>
  
    </div>
  </div>
  <!-- //////////////////////////////////////////////////////////////////////////////vehicle  tracker/////////////////////////////////// -->
  <div class="modal fade" id="v_track_Modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true"
    data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog " style=" max-width: 1500px;">
      <div class="modal-content" style="height: 700px;">
  
        <div class="modal-header">
          <h6 class="modal-title" id="exampleModalLabel">{{map_flag}}</h6>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"
            (click)="closeMap()"></button>
        </div>
        <div class="modal-body">
          <ngx-spinner name="tracking" bdColor="rgba(51, 51, 51, 0.8)" size="default" [fullScreen]="false"
            type="ball-spin-clockwise">
            <p style="color: black">Please Wait.. </p>
          </ngx-spinner>
          <div id="map1">
  
  
          </div>
        </div>
        <div class="modal-footer" style="height: 25px;">
  
          <!-- <button type="button" *ngIf="seconddaryTrack[0][8]!==''"> <i class="fe fe-truck"   tooltipClass="customInactive-tooltip-class" 
            style="font-size: 20px;display: none;" id="blink" ></i></button> -->
          <!-- 
         <button type="button" *ngIf="seconddaryTrack[0][7]!=''"> <i class="fe fe-truck"  tooltipClass="customInactive-tooltip-class" [ngbTooltip]="seconddaryTrack[0][1]"
            style="font-size: 20px;" id="blink" [style.color]="colorTrack[0]?.first" (click)="vehicleTrack1F()"></i></button>
         <button type="button" *ngIf="seconddaryTrack[0][1]!=''"> <i class="fe fe-truck"  tooltipClass="customInactive-tooltip-class" [ngbTooltip]="seconddaryTrack[0][7]"
            style="font-size: 20px;" id="blink" [style.color]="colorTrack[1]?.second" (click)="vehicleTrack2F()"></i></button> -->
  
  
  
  
        </div>
      </div>
    </div>
  </div>
  <!-- ////////////////////////////////////////////dummy modal for testing purposes////////////////////////////////////////////////// -->
  
  <!-- ///////////////////////////////////////////new create alert modal/////////////////////////////// -->
  <div class="modal fade " id="createAlertModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog " style=" max-width: 900px;margin-left: 365px;">
      <div class="modal-content" style="height: 570px; width: 835px;">
  
        <div class="modal-header" style="background-color: lightgray;max-height: 40px;">
          <h5 class="modal-title" id="exampleModalLabel" style="margin-left: 311px;font-weight:500; color :black;">NEW
            ALERT</h5>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" style="background-color: white !important;">
  
          <form #newTrip="ngForm" (ngSubmit)="newTripF(newTrip.value);newTrip.reset()">
  
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-2" id="newtrip">
                  Id(ShipmentNo.)
                </div>
  
                <div class="col-lg-4">
                  <ng-select name="subassets" placeholder="" id="ShipmentNo" (change)="shipmentSelectF($event)"
                    [ngModel]="ShipmentNo" required name="shipment_no">
                    <ng-option value="" selected>--Select Shipment--</ng-option>
                    <ng-option *ngFor="let item of alltrip |keyvalue" [value]="item.key">{{item.key}}</ng-option>
  
                  </ng-select>
                </div>
                <div class="col-lg-2" id="newtrip">
                  DriverInfo
                </div>
                <div class="col-lg-4">
                  <label type="text" id="newAlert" name="driver_info">{{newalertinfo.driver_info}}</label>
                  <!-- {{newalertinfo.driver_info}} -->
                </div>
  
  
              </div>
            </div>&nbsp;&nbsp;
  
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-2" id="newtrip">
                  Alert Type
                </div>
                <div class="col-lg-4">
                  <ng-select name="subassets" placeholder="" id="Type" (change)="alertTypeF($event)" [ngModel]="Type"
                    required name="type">
                    <ng-option value="" selected>--Select Type--</ng-option>
                    <ng-option value="2">Threat</ng-option>
                    <ng-option value="1">Trigger</ng-option>
  
                  </ng-select>
                </div>
                <div class="col-lg-2" id="newtrip">
                  Vehicle No
                </div>
                <div class="col-lg-4">
                  <input type="text" id="newAlert" name="vehicle_no" [ngModel]="newalertinfo?.vehicle_no" readonly
                    disabled />
                  <!-- {{newalertinfo.vehicle_no}} -->
                </div>
  
              </div>
            </div>&nbsp;&nbsp;
  
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-2" id="newtrip">
                  Level
                </div>
                <div class="col-lg-4">
                  <ng-select name="subassets" id="Level" placeholder="Level" [ngModel]="Level" required name="level"
                    [disabled]="!triggerSelectFlag">
                    <ng-option value="" selected>--Level--</ng-option>
                    <!-- *ngFor=" let item of Apicolor_array;ind=index" [value]="ind+1" -->
                    <ng-option [value]="ind+1" *ngFor="let item of Apicolor_array;let ind=index">
                      <i class="fa fa-square" [style.color]="item" style="font-size: 20px;"><label for=""
                          style="font-size: 20px;margin-left: 145px;"> {{ind+1}}</label></i>
                    </ng-option>
                    <!-- <ng-option [value]="2">2</ng-option>
                    <ng-option [value]="3">3</ng-option>
                    <ng-option [value]="4">4</ng-option> -->
                    <!-- <ng-option [value]="1">5</ng-option>
                    <ng-option [value]="1">6</ng-option> -->
  
                  </ng-select>
                </div>
                <div class="col-lg-2" id="newtrip">
                  Run Date
                </div>
                <div class="col-lg-4">
                  <input type="text" id="newAlert" [ngModel]="newalertinfo.run_date" name="run_date" readonly disabled />
                  <!-- {{newalertinfo.run_date}} -->
                </div>
              </div>
            </div>&nbsp;&nbsp;
  
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-2" id="newtrip">
                  Alert Name
                </div>
                <div class="col-lg-4">
                  <ng-select name="subassets" *ngIf="triggerSelectFlag==true" id="trigger" placeholder=""
                    [ngModel]="trigger" required name="sub_type_name">
                    <ng-option value="" selected>--Select trigger--</ng-option>
                    <ng-option *ngFor="let key of Object.keys (alertData) "
                      [value]="alertData[key]">{{alertData[key]}}</ng-option>
  
                  </ng-select>
                  <ng-select name="subassets" *ngIf="threatSelectFlag==true" placeholder="" [ngModel]="sub_type"
                    name="sub_type_name" (change)="threatType($event)">
                    <ng-option value="" selected>--Select Threat--</ng-option>
                    <ng-option *ngFor="let key of Object.keys(threatsdata)"
                      [value]="threatsdata[key]">{{threatsdata[key].name}}</ng-option>
  
  
  
                  </ng-select>&nbsp;
                  <label for="" style="color: red;" *ngIf="threatSubType.length>0 && threatSelectFlag==true">Please select
                    sub type</label>
                  <!-- ///////////////////////////////////////////////threay type//////////////////////////// -->
                  <ng-select name="subassets" *ngIf="threatSubType.length>0" placeholder="" [ngModel]="Threat_sub_type"
                    name="Threat_sub_type">
  
                    <ng-option value="" selected>--Select Threat SubType--</ng-option>
                    <ng-option *ngFor="let item of threatSubType" [value]="item">{{item}}</ng-option>
  
  
  
                  </ng-select>
  
                </div>
  
                <div class="col-lg-2" id="newtrip">
                  Source
                </div>
                <div class="col-lg-4">
                  <input type="text" id="newAlert" [ngModel]="newalertinfo.source_code" name="source" readonly disabled />
                  <!-- {{newalertinfo.source_code}} -->
                </div>
              </div>
            </div>&nbsp;&nbsp;
  
            <!-- <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-2" id="newtrip">
                  Level
                </div>
                <div class="col-lg-4" *ngIf="triggerSelectFlag==true">
                  <ng-select name="subassets" id="Level" placeholder="" [ngModel]="Level" required name="level">
                    <ng-option value="" selected>--Level--</ng-option>
                   *ngFor=" let item of Apicolor_array;ind=index" [value]="ind+1"
                    <ng-option [value]="1">1</ng-option>
                    <ng-option [value]="2">2</ng-option>
                    <ng-option [value]="3">3</ng-option>
                    <ng-option [value]="4">4</ng-option>
                     <ng-option [value]="1">5</ng-option>
                    <ng-option [value]="1">6</ng-option> -->
  
            <!-- </ng-select>
                </div>
                <div class="col-lg-2" id="newtrip">
                  Source
                </div>
                <div class="col-lg-4">
                  <input type="text" id="form12" [ngModel]="newalertinfo.source_code" name="source"
                    readonly disabled/>
                {{newalertinfo.source_code}}
                </div>
  
  
  
              </div>
            </div>&nbsp;&nbsp;-->
  
  
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-2" id="newtrip">
                  Log Time
                </div>
                <div class="col-lg-4">
                  <div class='input-group date' id='datetimepicker1'>
                    <input type="datetime-local" step="1" class="form-control" [value]="currentDateTime"
                      [ngModel]="datetimepicker1" required name="log_time" [max]="currentDateTime" />
  
                  </div>
                </div>
                <div class="col-lg-2" id="newtrip">
                  Route
                </div>
                <div class="col-lg-4">
                  <input type="text" id="newAlert" [ngModel]="newalertinfo.route" name="route" readonly disabled />
  
                  <!-- {{newalertinfo.route}} -->
                </div>
              </div>
  
            </div>&nbsp;&nbsp;
  
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-2" id="newtrip">
                  Location
                </div>
                <div class="col-lg-4">
                  <div class="form-outline">
                    <input type="text" id="newAlert" class="form-control" [ngModel]="Location" name="location">
  
                  </div>
                </div>
                <div class="col-lg-2" id="newtrip">
                  Lat Long
                </div>
                <div class="col-lg-4">
                  <div>
                    <input type="text" id="newAlert" class="form-control" [ngModel]="geo" name="geocoord">
                  </div>
                </div>
  
              </div>
            </div>&nbsp;&nbsp;
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-2" id="newtrip">
                  Message
                </div>
                <div class="col-lg-10">
                  <div class="form-outline">
                    <textarea class="form-control" id="msgarea" rows="3" [ngModel]="msgarea" name="message"
                      required></textarea>
  
                  </div>
                </div>
  
              </div>
            </div>&nbsp;&nbsp;
            <div class="col-lg-12">
              <button class="btn btn-outline-primary btn-sm" type="submit" id="AlertButton"
                style="margin-top: 15px;margin-left: 339px;" [disabled]="!newTrip.form.valid"
                [ngbTooltip]="newTrip.invalid ? 'some text' : ''">Submit</button>
            </div>
  
  
  
  
          </form>
  
        </div>
  
      </div>
  
  
    </div>
  
  </div>
  <!-- ////////////////////////////////////////upload document from desktop///////////////////////////////////////////////////// -->
  <div class="modal fade" id="uploadModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width:550px;margin-left: 530px;height: 45px;">
      <div class="modal-content">
  
        <div class="modal-header" style="height: 60px;background-color: white;">
          <h5 class="modal-title" id="exampleModalLabel" style="font-weight:500; margin-left: 135px;font-size: 16px;">
            UPLOAD FILE</h5>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form #uploadFile="ngForm" (ngSubmit)="UploadFiledskF(uploadFile.value);uploadFile.reset()">
            <div>
              <div class="col-lg-12">
                <div class="row">
                  <div class="col-lg-6" id="newtrip">
                    File-Title
                  </div>
                  <div class="col-lg-6">
                    <input type="text" id="form12" class="form-control" name="file_title" ngModel required>
                  </div>
                </div>
              </div>&nbsp;&nbsp;
              <div class="col-lg-12">
                <div class="row">
                  <div class="col-lg-6" id="newtrip">
                    Select-File
                  </div>
                  <div class="col-lg-6">
                    <div class="form">
                      <input type="file" class="form-control form-control-sm" name="file" id="customFile"
                        (change)="selectFile($event)" ngModel required>
                    </div>
                    <div class="imagePreview" *ngIf="imageurl!= ''">
                      <img [src]="imageurl">
                    </div>
                  </div>
                </div>
              </div>&nbsp;&nbsp;
              <div class="col-lg-12">
                <button class="btn btn-outline-primary btn-sm" type="submit" id="AlertButton" style="margin-left: 182px;"
                  [disabled]="!uploadFile.form.valid">OK</button>
              </div>
  
            </div>
          </form>
        </div>
        <!-- <div class="modal-footer"> -->
  
  
        <!-- <i class="fe fe-truck" tooltipClass="customActive-tooltip-class" ngbTooltip="Device 1"
            style="font-size: 20px;color: blue;" id="blink"></i>
          <i class="fe fe-truck" tooltipClass="customInStopped-tooltip-class" ngbTooltip="Device 2"
            style="font-size: 20px;color: red;" id="blink"></i> -->
  
  
        <!-- <button type="button" class="btn btn" data-bs-dismiss="modal"
              style="background-color:#1c84c6;border-color: #1c84c6;color: white ;">Close</button> -->
  
        <!-- </div> -->
      </div>
    </div>
  </div>
  <!-- /////////////////////////////////////////////////////view upload document from desktop/////////////////////////////////// -->
  <div class="modal fade" id="uploadViewModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 550px;">
      <div class="modal-content" style="height: 300px;">
  
        <div class="modal-header" style="background-color: white;">
          <!-- <h5 class="modal-title" id="exampleModalLabel" 
            style="font-weight:500; color :#1c84c6;font-size: 20px;">Files</h5> -->
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div>
            <div style="overflow: auto;overflow-y: auto;max-height:250px;">
              <table class="table table-secondary table-striped" id="ModalTble">
                <thead>
                  <tr>
                    <th scope="col" style="color: black;">S.no</th>
                    <th scope="col" style="color: black;">Create date</th>
                    <th scope="col" style="color: black;">file_title</th>
                    <th scope="col" style="color: black;">Download</th>
                    <!-- <th scope="col" style="color: black;">Trip id</th>
                    <th scope="col" style="color: black;">Mail_to</th> -->
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of uploadDocData;let ind=index;">
                    <td>{{ind+1}}</td>
                    <td>{{item.create_date}}</td>
                    <td>{{item.file_title}}</td>
                    <td>
  
                      <div *ngIf="item.file_path!=''">
                        <a type="button" [href]="item.file_path" target="_blank" download><img [src]="item.file_path"
                            alt="" style="width: 50px;height: 50px;"></a>
                      </div>
  
                      <!-- <a class="btn btn-outline-primary btn-sm" type="button" id="AlertButton" target="_blank" [href]="item.file_path">Download</a> -->
                    </td>
  
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <!-- <div class="modal-footer"> -->
  
  
        <!-- <i class="fe fe-truck" tooltipClass="customActive-tooltip-class" ngbTooltip="Device 1"
            style="font-size: 20px;color: blue;" id="blink"></i>
          <i class="fe fe-truck" tooltipClass="customInStopped-tooltip-class" ngbTooltip="Device 2"
            style="font-size: 20px;color: red;" id="blink"></i> -->
  
  
        <!-- <button type="button" class="btn btn" data-bs-dismiss="modal"
              style="background-color:#1c84c6;border-color: #1c84c6;color: white ;">Close</button> -->
  
        <!-- </div> -->
      </div>
    </div>
  </div>
  <!-- ////////////////////////////////////////////////////upload image from last trogger///////////////////////////// -->
  <div class="modal fade" id="upload_image" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width:550px;margin-left: 260px;">
      <div class="modal-content">
  
        <div class="modal-header" style="height: 60px;background-color: white;">
          <h5 class="modal-title" id="exampleModalLabel" style="font-weight:500; color :#1c84c6;font-size: 20px;">UPLOAD
            FILE</h5>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form #uploadimg="ngForm" (ngSubmit)="uploadImage(uploadimg.value);uploadimg.reset()">
            <div>
              <div class="col-lg-12">
                <div class="row">
                  <div class="col-lg-6" id="newtrip">
                    File-Title
                  </div>
                  <div class="col-lg-6">
                    <input type="text" id="form12" class="form-control" name="file_title" ngModel>
                  </div>
                </div>
              </div>&nbsp;&nbsp;
              <div class="col-lg-12">
                <div class="row">
                  <div class="col-lg-6" id="newtrip">
                    Select-File
                  </div>
                  <div class="col-lg-6">
                    <div class="form">
                      <input type="file" class="form-control form-control-sm" name="file" id="customFile"
                        (change)="selectFile($event)" ngModel>
                    </div>
                    <div class="imagePreview" *ngIf="imageurl!= ''">
                      <img [src]="imageurl">
                    </div>
                  </div>
                </div>
              </div>&nbsp;&nbsp;
              <div class="col-lg-12">
                <button class="btn btn-outline-primary btn-sm" type="submit" id="AlertButton"
                  style="margin-left: 182px;">OK</button>
              </div>
  
            </div>
          </form>
        </div>
        <!-- <div class="modal-footer"> -->
  
  
        <!-- <i class="fe fe-truck" tooltipClass="customActive-tooltip-class" ngbTooltip="Device 1"
            style="font-size: 20px;color: blue;" id="blink"></i>
          <i class="fe fe-truck" tooltipClass="customInStopped-tooltip-class" ngbTooltip="Device 2"
            style="font-size: 20px;color: red;" id="blink"></i> -->
  
  
        <!-- <button type="button" class="btn btn" data-bs-dismiss="modal"
              style="background-color:#1c84c6;border-color: #1c84c6;color: white ;">Close</button> -->
  
        <!-- </div> -->
      </div>
    </div>
  </div>
  <!-- /////////////////////////////////////close poup modal new design from last alert//////////////////////////////////////// -->
  <div class="modal fade" id="closeModalDesk" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 1027px;margin-left: 260px;">
      <div class="modal-content" style="height: 370px; width: 835px;">
  
        <div class="modal-header" style="height: 45px;">
          <button type="button" class="btn btn-sm" data-bs-toggle="modal" data-bs-target="#desklastalertModal"
            aria-label="Close"><i class="fa fa-arrow-left" ngbTooltip="Back"></i></button>
          <h5 class="modal-title" id="exampleModalLabel" style="margin-left: 340px;font-weight:500; ">Close Alert</h5>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="col-lg-12">
  
            <div class="row">
              <div class="col-lg-6">
                <button type="button" *ngIf="!close_history" placement="top" container="body">
                  <i class="fa fa-book" ngbTooltip=" View History" style="font-size: 15px;"
                    (click)="CLoseHistoryF();graceHistory();escalationHistory()"></i></button>
                <button type="button" *ngIf="close_history" placement="top" container="body">
                  <i class="fa fa-arrow-left" ngbTooltip="Close Alert" style="font-size: 15px;"
                    (click)="CLoseHistoryF()"></i></button>
  
              </div>
              <div class="col-lg-6">
                <button type="button" *ngIf="close_tabFlag&&!addMoreFlag"> <i class="fa fa-plus"
                    *ngIf="close_tabFlag&&!addMoreFlag" type="button" ngbTooltip="Add More"
                    style="font-size: 20px;margin-left: 340px;" (click)="addMoreCLose()"></i></button>
                <button type="button" *ngIf="addMoreFlag"> <i class="fa fa-minus" *ngIf="addMoreFlag" type="button"
                    ngbTooltip="Minimize" style="font-size: 20px;margin-left: 340px;"
                    (click)="addMoreCLose()"></i></button>
              </div>
            </div>
  
          </div>&nbsp;
          <!-- ////////////////////////////////////////////starting div for trun false///////////////////////////// -->
          <div *ngIf="close_tabFlag">
            <form #closeForm="ngForm" (ngSubmit)="closeNewf(closeForm.value);closeForm.reset()">
  
  
              <div class="col-lg-12">
                <table class="table table-secondary table-striped" id="ModalTble">
                  <thead>
                    <tr style="text-align: center;vertical-align: middle;">
                      <th>
                        <div class="form-check" style="display: inline-block">
                          <input class="form-check-input closeCheckbox" type="checkbox" disabled>
                        </div>
                      </th>
                      <th scope="col" style="color: black;">Called To</th>
                      <th scope="col" style="color: black;">Name</th>
                      <th scope="col" style="color: black;">AT</th>
                      <th scope="col" style="color: black;">Remarks</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr style="text-align: center;vertical-align: middle;">
                      <td>
                        <div class="form-check" style="display: inline-block">
                          <input class="form-check-input closeCheckbox" type="checkbox" value="" id="Drivern">
                        </div>
                      </td>
                      <td><label for="text">Driver</label></td>
                      <td>
                        <div class="form-outline " style="display: inline-block">
                          <input type="text" id="closeInputBox" class="form-control" name="driverName" ngModel>
  
                        </div>
                      </td>
                      <td>
                        <div class="cs-form" style="display: inline-block">
                          <input type="datetime-local" class="form-control" [value]="currentDateTime" id="closeInputBox"
                            name="driverTime" [max]="currentDateTime" [ngModel]="datetimepicker1">
                        </div>
                      </td>
  
                      <td>
                        <div class="form-outline" style="display: inline-block">
                          <textarea class="form-control" id="closeInputBox" rows="1" name="driverRemarks"
                            ngModel></textarea>
  
                        </div>
                      </td>
  
                    </tr>
                    <tr style="text-align: center;vertical-align: middle;">
                      <td>
                        <div class="form-check" style="display: inline-block">
                          <input class="form-check-input closeCheckbox" type="checkbox" value=""
                            id="Escalation-Transportern">
                        </div>
                      </td>
                      <td>Transporter</td>
                      <td>
                        <div class="form-outline " style="display: inline-block">
                          <input type="text" id="closeInputBox" class="form-control" name="transproterName" ngModel>
  
                        </div>
                      </td>
                      <td>
                        <div class="cs-form" style="display: inline-block">
                          <input type="datetime-local" class="form-control" [value]="currentDateTime" id="closeInputBox"
                            name="transporterTime" [max]="currentDateTime" [ngModel]="datetimepicker1">
                        </div>
                      </td>
                      <td>
                        <div class="form-outline" style="display: inline-block">
                          <textarea class="form-control" id="closeInputBox" rows="1" name="transporterRemarks"
                            ngModel></textarea>
  
                        </div>
                      </td>
                    </tr>
                    <tr *ngIf="addMoreFlag" style="text-align: center;vertical-align: middle;">
                      <td>
                        <div class="form-check" style="display: inline-block">
                          <input class="form-check-input closeCheckbox" type="checkbox" value="" id=" " disabled>
                        </div>
                      </td>
                      <td>
                        <ng-select name="subassets" placeholder="" id="Other" [ngModel]="ShipmentNo" required
                          name="other_list">
                          <ng-option value="" selected>--Select Other--</ng-option>
                          <ng-option value="Manager">Manager</ng-option>
                          <ng-option value="Sr.Manager">Sr.Manager</ng-option>
                          <ng-option value="QR_Team">QR Team</ng-option>
                          <ng-option value="Field_Officer">Field Officer</ng-option>
  
                        </ng-select>
                      </td>
                      <td>
                        <div class="form-outline " style="display: inline-block">
                          <input type="text" id="closeInputBox" class="form-control" name="OtherName" ngModel>
  
                        </div>
                      </td>
                      <td>
                        <div class="cs-form" style="display: inline-block">
                          <input type="datetime-local" class="form-control" [value]="currentDateTime" id="closeInputBox"
                            name="OtherTime" [max]="currentDateTime" [ngModel]="datetimepicker1">
                        </div>
                      </td>
                      <td>
                        <div class="form-outline" style="display: inline-block">
                          <textarea class="form-control" id="closeInputBox" rows="1" name="OtherRemarks"
                            ngModel></textarea>
  
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="col-lg-12">
                <div class="row">
                  <div class="col-lg-2" id="newtrip">
                    Upload Image
                  </div>
                  <div class="col-lg-6">
                    <div class="form" style="display: inline-block">
                      <input type="file" class="form-control form-control-sm" name="file" id="customFile"
                        (change)="selectFile($event)" ngModel>
                    </div>
  
                    <div class="imagePreview" *ngIf="imageurl!= ''">
                      <img [src]="imageurl">
                    </div>
                  </div>
                  <div class="col-lg-4">
                    <button class="btn btn-outline-primary btn-sm" type="submit" id="AlertButton"
                      style="margin-left: 182px;">Submit</button>
                  </div>
  
                </div>
              </div>
  
            </form>
          </div>
  
          <div *ngIf="close_history">
            <div class="col-lg-12" style="overflow: auto;overflow-x: auto;max-height: 250px;">
              <table class="table table-secondary table-striped" id="ModalTble">
                <thead>
                  <tr>
                    <th scope="col" style="color: black;">Trigger type</th>
                    <th scope="col" style="color: black;">Grace_period_requested</th>
                    <th scope="col" style="color: black;">Grace_period_starttime</th>
                    <th scope="col" style="color: black;">Grace_taken</th>
                    <th scope="col" style="color: black;">Trip id</th>
                    <th scope="col" style="color: black;">Mail_to</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of graceHistoryData[0]">
                    <td>{{item.trigger_type}}</td>
                    <td>{{item.grace_period_requested}}</td>
                    <td>{{item.grace_period_starttime}}</td>
                    <td>{{item.grace_taken}}</td>
                    <td>{{item.trip_id}}</td>
                    <td>{{item.mail_to}}</td>
                  </tr>
                </tbody>
              </table>
  
            </div>
  
            <!-- ///////////////////////////////////////for history view -->
          </div>
        </div>
  
      </div>
    </div>
  </div>
  <!-- ////////////////////////////////assign qrt from desktop above all trigger/////////////////////// -->
  <!-- /////////////////////////////////////////////////////////////////// -->
  <div class="modal fade" id="qrtModalabove" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 730px;margin-left: 458px;">
      <div class="modal-content" style="height: 325px;">
  
        <div class="modal-header" style="background-color: white;">
          <button type="button" class="btn btn-sm" data-bs-toggle="modal" data-bs-target="#triggerModal"
            aria-label="Close"><i class="fa fa-arrow-left" ngbTooltip="Back"></i></button>
          <h3 class="modal-title" id="exampleModalLabel"
            style="margin-left: 220px;font-weight:700; color :#1c84c6;font-size: initial;"></h3>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form #qrtFormabove="ngForm" (ngSubmit)="qrtSubmitAboveF(qrtFormabove.value);qrtFormabove.reset()">
  
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-2" id="newtrip">
                  Shipment(ID)
                </div>
                <div class="col-lg-4">{{graceShipment}}
                  <!-- <ng-select name="subassets" placeholder="" ngModel name="shipment_No" (change)="shipmentSelectF($event)"
                    required>
                    <ng-option value="" selected>--Select Trip--</ng-option>
                    <ng-option *ngFor="let item of alltrip |keyvalue" [value]="item.key">{{item.key}}</ng-option>
  
  
  
                  </ng-select> -->
                </div>
                <div class="col-lg-2" id="newtrip">
                  Vehicle(NO)
                </div>
                <div class="col-lg-4">
                  <label type="text">{{graceVehicle}}</label>
                  <!-- name="vehicle_no" ngModel -->
                  <!-- <ng-select name="subassets" placeholder="" ngModel name="vehicle_No" required>
                    <ng-option value="" selected>--Select Vehicle--</ng-option>
                    <ng-option *ngFor="let item of AlltripValue "
                      [value]="item.vehicle_no">{{item.vehicle_no}}</ng-option>
  
  
  
                  </ng-select> -->
                </div>
              </div>
            </div>&nbsp;&nbsp;
  
  
            <div class="col-lg-12">
              <div class="row">
  
                <div class="col-lg-2" id="newtrip">
                  List QRT
                </div>
                <div class="col-lg-6">
                  <ng-select name="subassets" placeholder="" ngModel name="qrtUser" required>
                    <ng-option value="" selected>--Select Name--</ng-option>
                    <ng-option *ngFor="let item of qrtListData"
                      [value]="item.id">{{item.code}}/{{item.name}}/{{item.location}}</ng-option>
  
  
  
                  </ng-select>
                </div>
                <!-- <div class="col-lg-2" id="newtrip">
                  Remarks
                </div> -->
                <div class="col-lg-4">
                  <div class="form-outline">
                    <textarea class="form-control" id="msgarea" rows="2" [ngModel]="msgarea" name="remarks"
                      placeholder="Remarks" required></textarea>
  
                  </div>
                </div>
              </div>
            </div>&nbsp;&nbsp;
            <div class="col-lg-12">
              <button class="btn btn-outline-primary btn-sm" type="submit" id="AlertButton"
                style="margin-top: 15px;margin-left: 242px;" [disabled]="!qrtFormabove.form.valid">Submit</button>
              <!-- [disabled]="!newTrip.form.valid" -->
            </div>&nbsp;&nbsp;
  
          </form>
        </div>
  
      </div>
    </div>
  </div>
  <!-- //////////////////////////////////////////////////grace pop model on above//////////////////////////////////// -->
  <div class="modal fade" id="graceModalabove" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 500px;margin-left: 260px;">
      <div class="modal-content" style="height: 320px; width: 440px;">
  
        <div class="modal-header" style="background-color: white;">
          <button type="button" class="btn btn-sm" data-bs-toggle="modal" href="#triggerModal" aria-label="Close"><i
              class="fa fa-arrow-left" ngbTooltip="Back"></i></button>
          <h3 class="modal-title" id="exampleModalLabel"
            style="margin-left: 220px;font-weight:700; color :#1c84c6;font-size: initial;"></h3>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
  
          <form #gracePeriodabove="ngForm" (ngSubmit)="gracPeriodF(gracePeriodabove.value);gracePeriodabove.reset()">
            <div class="col-lg-12">
              <div class="row">
                <!-- <div class="col-lg-6" style="font-size: 15px;">Prev. Status:&nbsp;&nbsp;<i class="fa fa-square"
                    ngbTooltip="Prev. Status" style="color: yellow;font-size: 15px;"></i>
                </div> -->
                <!-- <div class="col-lg-6" style="font-size: 15px;">History View:&nbsp;&nbsp;&nbsp;&nbsp;<a role="button"
                    (click)="graceHistory()"><i class="fa fa-eye" ngbTooltip="Click Here"
                      style="color: black;font-size: 18px;cursor: pointer;font-style: bold;"></i></a>
                  <div *ngIf="graceHistoryFlag" style="overflow: auto;overflow-y: auto;max-height: 160px;">
                    <table class="table table-secondary table-striped" style="width: 400px;" id="ModalTble">
                      <thead>
                        <tr>
                          <th scope="col" style="color: black;">Trigger type</th>
                          <th scope="col" style="color: black;">Grace_period_requested</th>
                          <th scope="col" style="color: black;">Grace_period_starttime</th>
                          <th scope="col" style="color: black;">Grace_taken</th>
                          <th scope="col" style="color: black;">Trip id</th>
                          <th scope="col" style="color: black;">Mail_to</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let item of graceHistoryData[0]">
                          <td>{{item.trigger_type}}</td>
                          <td>{{item.grace_period_requested}}</td>
                          <td>{{item.grace_period_starttime}}</td>
                          <td>{{item.grace_taken}}</td>
                          <td>{{item.trip_id}}</td>
                          <td>{{item.mail_to}}</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div> -->
  
              </div>
              <!-- <div style="font-size: 15px;">Escalation Level:&nbsp;&nbsp;2</div>
              <div style="margin-top: 10px;color: black;">
                <h4>+Start Grace Period</h4>
              </div> -->
              <div class="row">
  
                <div style="font-size: 15px;">Round: {{GraceLoop}}</div>
  
                <div style="font-size: 15px;margin-top: 30px;">Remaining Grace
                  Period:&nbsp;&nbsp;&nbsp;{{remainngGrace}}
                  &nbsp;MINUTES
  
                </div>
              </div>
              <div class="row">
  
                <div style="font-size: 15px;">Enter Time(MINUTES)</div>
              </div>
  
              <div class="row">
                <!-- <div class="col-lg-6">
                  <table class="table table-secondary table-striped" style="width: 400px;" id="ModalTble">
                    <thead>
                      <tr>
                        <th scope="col" style="color: black;">User</th>
                        <th scope="col" style="color: black;">Sms</th>
                        <th scope="col" style="color: black;">Email</th>
                        <th scope="col" style="color: black;">Level</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let item of grace_infoTbl">
                        <td scope="row">{{item.name}}</td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" [disabled]="item.checked_sms"
                              (change)="graceTblCheckSms($event,item.phone_no)">
  
                          </div>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input graceCheckBox" type="checkbox" [disabled]="item.checked_email"
                              (change)="graceTblCheckEmail($event,item.email_id)">
  
                          </div>
                        </td>
                        <td>{{item.role}}</td>
                      </tr>
    
                    </tbody>
                  </table>
                </div> -->
                <div class="row">
                  <div class="form-outline">
                    <input type="number" class="form-control graceCheckBox" name="grace_hour" id="grace_hour" value=""
                      [ngModel]="grace_hour" required>
  
                  </div>&nbsp;
                  <div class="form-outline">
                    <textarea class="form-control" rows="4" placeholder="Enter Remarks Here.." name="graceRemarks"
                      [ngModel]="graceRemarks" required></textarea>
  
                  </div>
                  <div class="row">
                    <button class="btn btn-outline-primary btn-sm" type="submit" id="AlertButton" style="max-width: 100px;
                    margin-top: 32px;color: black;margin-left: 145px" aria-expanded="false"
                      [disabled]="!gracePeriodabove.form.valid">SUBMIT</button>
                  </div>
                </div>
              </div>
  
            </div>
          </form>
  
        </div>
  
      </div>
    </div>
  </div>
  <!-- ///////////////////////////////////////close modal for above////////////////////////////////////////////////////////// -->
  <div class="modal fade" id="closeModalabove" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 1027px;margin-left: 260px;">
      <div class="modal-content" style="height: 370px; width: 835px;">
  
        <div class="modal-header">
          <button type="button" class="btn btn-sm" data-bs-toggle="modal" data-bs-target="#triggerModal"
            aria-label="Close"><i class="fa fa-arrow-left" ngbTooltip="Back"></i></button>
          <h5 class="modal-title" id="exampleModalLabel" style="margin-left: 340px;font-weight:500; ">Close Alert</h5>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="col-lg-12">
  
            <div class="row">
              <div class="col-lg-6">
                <button type="button" *ngIf="!close_history" placement="top" container="body">
                  <i class="fa fa-book" ngbTooltip=" View History" style="font-size: 20px;"
                    (click)="CLoseHistoryF();graceHistory();escalationHistory()"></i></button>
                <button type="button" *ngIf="close_history" placement="top" container="body">
                  <i class="fa fa-arrow-left" ngbTooltip="Close Alert" style="font-size: 20px;"
                    (click)="CLoseHistoryF()"></i></button>
  
              </div>
              <div class="col-lg-6">
                <button type="button" *ngIf="close_tabFlag&&!addMoreFlag"> <i class="fa fa-plus"
                    *ngIf="close_tabFlag&&!addMoreFlag" type="button" ngbTooltip="Add More"
                    style="font-size: 20px;margin-left: 340px;" (click)="addMoreCLose()"></i></button>
                <button type="button" *ngIf="addMoreFlag"> <i class="fa fa-minus" *ngIf="addMoreFlag" type="button"
                    ngbTooltip="Minimize" style="font-size: 20px;margin-left: 340px;"
                    (click)="addMoreCLose()"></i></button>
              </div>
            </div>
  
          </div>&nbsp;
          <!-- ////////////////////////////////////////////starting div for trun false///////////////////////////// -->
          <div *ngIf="close_tabFlag">
            <form #closeFormAbove="ngForm" (ngSubmit)="closeNewAbovef(closeFormAbove.value)">
  
  
              <div class="col-lg-12">
                <table class="table table-secondary table-striped" id="ModalTble">
                  <thead>
                    <tr style="text-align: center;vertical-align: middle;">
                      <th>
                        <div class="form-check" style="display: inline-block">
                          <input class="form-check-input closeCheckbox" type="checkbox" disabled>
                        </div>
                      </th>
                      <th scope="col" style="color: black;">Called To</th>
                      <th scope="col" style="color: black;">Name</th>
                      <th scope="col" style="color: black;">AT</th>
                      <th scope="col" style="color: black;">Remarks</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr style="text-align: center;vertical-align: middle;">
                      <td>
                        <div class="form-check" style="display: inline-block">
                          <input class="form-check-input closeCheckbox" type="checkbox" value="" id="DrivernA">
                        </div>
                      </td>
                      <td><label for="text">Driver</label></td>
                      <td>
                        <div class="form-outline " style="display: inline-block">
                          <input type="text" id="closeInputBox" class="form-control" name="driverName" ngModel>
  
                        </div>
                      </td>
                      <td>
                        <div class="cs-form" style="display: inline-block">
                          <input type="datetime-local" class="form-control" [value]="currentDateTime" id="closeInputBox"
                            name="driverTime" [max]="currentDateTime" [ngModel]="datetimepicker1">
                        </div>
                      </td>
  
                      <td>
                        <div class="form-outline" style="display: inline-block">
                          <textarea class="form-control" id="closeInputBox" rows="2" name="driverRemarks"
                            ngModel></textarea>
  
                        </div>
                      </td>
  
                    </tr>
                    <tr style="text-align: center;vertical-align: middle;">
                      <td>
                        <div class="form-check" style="display: inline-block">
                          <input class="form-check-input closeCheckbox" type="checkbox" value=""
                            id="Escalation-TransporternA">
                        </div>
                      </td>
                      <td>Transporter</td>
                      <td>
                        <div class="form-outline " style="display: inline-block">
                          <input type="text" id="closeInputBox" class="form-control" name="transproterName" ngModel>
  
                        </div>
                      </td>
                      <td>
                        <div class="cs-form" style="display: inline-block">
                          <input type="datetime-local" class="form-control" [value]="currentDateTime" id="closeInputBox"
                            name="transporterTime" [max]="currentDateTime" [ngModel]="datetimepicker1">
                        </div>
                      </td>
                      <td>
                        <div class="form-outline" style="display: inline-block">
                          <textarea class="form-control" id="closeInputBox" rows="2" name="transporterRemarks"
                            ngModel></textarea>
  
                        </div>
                      </td>
                    </tr>
                    <tr *ngIf="addMoreFlag" style="text-align: center;vertical-align: middle;">
                      <td>
                        <div class="form-check" style="display: inline-block">
                          <input class="form-check-input closeCheckbox" type="checkbox" value="" id=" " disabled>
                        </div>
                      </td>
                      <td>
                        <ng-select name="subassets" placeholder="" id="Other" [ngModel]="ShipmentNo" required
                          name="other_list">
                          <ng-option value="" selected>--Select Other--</ng-option>
                          <ng-option value="Manager">Manager</ng-option>
                          <ng-option value="Sr.Manager">Sr.Manager</ng-option>
                          <ng-option value="QR_Team">QR Team</ng-option>
                          <ng-option value="Field_Officer">Field Officer</ng-option>
  
                        </ng-select>
                      </td>
                      <td>
                        <div class="form-outline " style="display: inline-block">
                          <input type="text" id="closeInputBox" class="form-control" name="OtherName" ngModel>
  
                        </div>
                      </td>
                      <td>
                        <div class="cs-form" style="display: inline-block">
                          <input type="datetime-local" class="form-control" [value]="currentDateTime" id="closeInputBox"
                            name="OtherTime" [max]="currentDateTime" [ngModel]="datetimepicker1">
                        </div>
                      </td>
                      <td>
                        <div class="form-outline" style="display: inline-block">
                          <textarea class="form-control" id="closeInputBox" rows="2" name="OtherRemarks"
                            ngModel></textarea>
  
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="col-lg-12">
                <div class="row">
                  <div class="col-lg-2" id="newtrip">
                    Upload Image
                  </div>
                  <div class="col-lg-6">
                    <div class="form" style="display: inline-block">
                      <input type="file" class="form-control form-control-sm" name="file" id="customFile"
                        (change)="selectFile($event)" ngModel>
  
  
                    </div>
                    <div class="imagePreview" *ngIf="imageurl!= ''">
                      <img [src]="imageurl">
                    </div>
  
                  </div>
                  <div class="col-lg-4">
                    <button class="btn btn-outline-primary btn-sm" type="submit" id="AlertButton"
                      style="margin-left: 182px;">Submit</button>
                  </div>
  
                </div>
              </div>
  
  
            </form>
          </div>
  
          <div *ngIf="close_history">
            <div class="col-lg-12" style="overflow: auto;">
              <table class="table table-secondary table-striped" id="ModalTble">
                <thead>
                  <tr>
                    <th scope="col" style="color: black;">Trigger type</th>
                    <th scope="col" style="color: black;">Grace_period_requested</th>
                    <th scope="col" style="color: black;">Grace_period_starttime</th>
                    <th scope="col" style="color: black;">Grace_taken</th>
                    <th scope="col" style="color: black;">Trip id</th>
                    <th scope="col" style="color: black;">Mail_to</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of graceHistoryData[0]">
                    <td>{{item.trigger_type}}</td>
                    <td>{{item.grace_period_requested}}</td>
                    <td>{{item.grace_period_starttime}}</td>
                    <td>{{item.grace_taken}}</td>
                    <td>{{item.trip_id}}</td>
                    <td>{{item.mail_to}}</td>
                  </tr>
                </tbody>
              </table>
  
            </div>
            <!-- ///////////////////////////////////////for history view -->
          </div>
        </div>
  
      </div>
    </div>
  </div>
  <!-- //////////////////////////////view history from desktop////////////////////////////////////////// -->
  <div class="modal fade" id="viewHistorydsk" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 1295px;">
      <div class="modal-content">
  
        <div class="modal-header" style="background-color: white;">
          <h5 class="modal-title" id="exampleModalLabel" style="font-weight:500;margin-left: 435px;">Shipment History</h5>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <ngx-spinner name="history" bdColor="rgba(51, 51, 51, 0.8)" size="default" [fullScreen]="false"
            type="ball-spin-clockwise">
            <p style="color: black">Please Wait.. </p>
          </ngx-spinner>
          <div>
            <div style="overflow: auto;overflow-y: auto;max-height:250px;">
              <table class="table table-secondary table-striped">
                <thead>
                  <tr>
                    <th scope="col" style="color: black;">S.no</th>
                    <!-- <th scope="col" style="color: black;">Create_date</th> -->
                    <th scope="col" style="color: black;">Color</th>
                    <th scope="col" style="color: black;">Level</th>
  
                    <th scope="col" style="color: black;">Log_Time</th>
                    <!-- <th scope="col" style="color: black;">Run_Date</th> -->
                    <th scope="col" style="color: black;">Status</th>
                    <th scope="col" style="color: black;">Trigger</th>
                    <th scope="col" style="color: black;">VehicleNo</th>
                    <th scope="col" style="color: black;">Mode</th>
                    <th scope="col" style="color: black;">Time(From-To)</th>
                    <th scope="col" style="color: black;">Time(Escaltion)</th>
  
                    <!-- <th scope="col" style="color: black;">Message</th> -->
                    <!-- <th scope="col" style="color: black;">Trip id</th>
                    <th scope="col" style="color: black;">Mail_to</th> -->
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of history_dsk;let ind=index;">
                    <td>{{ind+1}}</td>
                    <!-- <td>{{item.create_date}}</td> -->
                    <td>
                      <label *ngFor="let col of item.colorS" style="display: inline-block;"><i class="fa fa-square"
                          [style.color]="col">&nbsp;</i></label>&nbsp;
                      <!-- <label *ngIf="item.colorS[1]"><i class="fa fa-square" [style.color]="item.colorS[1]"></i></label> -->
  
                    </td>
                    <td>
                      <label *ngFor="let lev of item.levelS" style="display: inline-block;">{{lev}}&nbsp;</label>&nbsp;
                      <!-- <label *ngIf="item.levelS[1]">{{item.levelS[1]}}</label> -->
  
  
                    </td>
                    <td>{{item.log_time}}</td>
                    <!-- <td>{{item.run_date}}</td> -->
                    <td>{{item.status}}</td>
                    <td>{{item.trigger}}</td>
                    <td>{{item.vehicle_name}}</td>
                    <td><label for="" *ngFor="let sub of item.history.escalate_history"
                        style="display: inline-block;">{{sub.mode}}</label></td>
                    <td><label for="" *ngFor="let sub of item.history.escalate_history"
                        style="display: inline-block;">{{sub.escalate_duration}}</label></td>
                    <td><label for="" *ngFor="let sub of item.history.escalate_history"
                        style="display: inline-block;">{{sub.escalate_time}}</label></td>
  
  
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
  
      </div>
    </div>
  </div>
  <!-- ////////////////////////////////////////////history on last alert////////////////////////////////////////////////////// -->
  <div class="modal fade" id="historyLastAlertDesk" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 1000px;">
      <div class="modal-content">
  
        <div class="modal-header" style="background-color: white;">
          <button type="button" class="btn btn-sm" data-bs-toggle="modal" data-bs-target="#desklastalertModal"
            aria-label="Close"><i class="fa fa-arrow-left" ngbTooltip="Back"></i></button>
          <h5 class="modal-title" id="exampleModalLabel" style="font-weight:500;margin-left: 305px;">Alert History</h5>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <Div class="col-lg-12">
            <label for="" style="background-color: grey;color: white;font-weight: 500;">Escalation History</label>&nbsp;
          </Div>
          <div>
            <div style="overflow: auto;overflow-y: auto;max-height:250px;">
              <table class="table table-secondary table-striped">
                <thead>
                  <tr>
                    <th scope="col" style="color: black;">S.no</th>
                    <th scope="col" style="color: black;">Escalation_Time</th>
                    <th scope="col" style="color: black;">Mail-To</th>
                    <th scope="col" style="color: black;">Level</th>
  
                    <th scope="col" style="color: black;">Mode</th>
                    <th scope="col" style="color: black;">Remark</th>
                    <th scope="col" style="color: black;">Status</th>
                    <th scope="col" style="color: black;">Trigger</th>
                    <th scope="col" style="color: black;">Trip-id</th>
                    <!-- <th scope="col" style="color: black;">Message</th> -->
                    <!-- <th scope="col" style="color: black;">Trip id</th>
                    <th scope="col" style="color: black;">Mail_to</th> -->
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of escaHistoryData[0];let ind=index;">
                    <td>{{ind+1}}</td>
                    <td>{{item.escalate_time}}</td>
                    <td>{{item.mail_to}}
                      <!-- <label >P:<i class="fa fa-square" [style.color]="item.colorS[0]"></i></label>&nbsp;
                     <label >L:<i class="fa fa-square" [style.color]="item.colorS[1]"></i></label> -->
  
                    </td>
                    <td>{{item.level}}
                      <!-- <label >P:{{item.levelS[0]}}</label>&nbsp;
                      <label >L:{{item.levelS[1]}}</label> -->
  
  
                    </td>
                    <td>{{item.mode}}</td>
                    <td>{{item.remarks}}</td>
                    <td>{{item.status}}</td>
                    <td>{{item.trigger_type}}</td>
                    <td>{{item.trip_id}}</td>
                    <!-- <td>{{item.message}}</td> -->
  
                    <!-- <td>{{item.grace_taken}}</td>
                    <td>{{item.trip_id}}</td>
                    <td>{{item.mail_to}}</td> -->
                  </tr>
                </tbody>
              </table>
            </div>
          </div>&nbsp;
          <!-- ///////////////////////////////////grace history/////////////////////////////////////// -->
          <Div class="col-lg-12">
            <label for="" style="background-color: grey;color: white;font-weight: 500;">Grace History</label>
          </Div>
          <div>
            <div style="overflow: auto;overflow-y: auto;max-height:250px;">
              <table class="table table-secondary table-striped">
                <thead>
                  <tr>
                    <th scope="col" style="color: black;">S.no</th>
                    <th scope="col" style="color: black;">Grace_requested</th>
                    <th scope="col" style="color: black;">Start_time</th>
                    <th scope="col" style="color: black;">Grace_taken</th>
  
                    <th scope="col" style="color: black;">mail_to</th>
                    <th scope="col" style="color: black;">Remark</th>
                    <th scope="col" style="color: black;">Status</th>
                    <th scope="col" style="color: black;">Trigger</th>
                    <th scope="col" style="color: black;">Trip_id</th>
                    <!-- <th scope="col" style="color: black;">Message</th> -->
                    <!-- <th scope="col" style="color: black;">Trip id</th>
                    <th scope="col" style="color: black;">Mail_to</th> -->
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of graceHistoryData[0];let ind=index;">
                    <td>{{ind+1}}</td>
                    <td>{{item.grace_period_requested}}</td>
                    <td>{{item.grace_period_starttime}}
                      <!-- <label >P:<i class="fa fa-square" [style.color]="item.colorS[0]"></i></label>&nbsp;
                     <label >L:<i class="fa fa-square" [style.color]="item.colorS[1]"></i></label> -->
  
                    </td>
                    <td>{{item.grace_taken}}
                      <!-- <label >P:{{item.levelS[0]}}</label>&nbsp;
                      <label >L:{{item.levelS[1]}}</label> -->
  
  
                    </td>
                    <td>{{item.mail_to}}</td>
                    <td>{{item.remarks}}</td>
                    <td>{{item.status}}</td>
                    <td>{{item.trigger_type}}</td>
                    <td>{{item.trip_id}}</td>
                    <!-- <td>{{item.message}}</td> -->
  
                    <!-- <td>{{item.grace_taken}}</td>
                    <td>{{item.trip_id}}</td>
                    <td>{{item.mail_to}}</td> -->
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
  
      </div>
    </div>
  </div>
  <!-- //////////////////////////////////history on threat////////////////////////////////////////////////////////////// -->
  <div class="modal fade" id="threatHistorymodal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 1000px;">
      <div class="modal-content">
  
        <div class="modal-header" style="background-color: white;">
          <button type="button" class="btn btn-sm" data-bs-toggle="modal" data-bs-target="#threatsModal"
            aria-label="Close"><i class="fa fa-arrow-left" ngbTooltip="Back"></i></button>
          <h5 class="modal-title" id="exampleModalLabel" style="font-weight:500;margin-left: 308px;">Threat History</h5>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div>
            <div style="overflow: auto;overflow-y: auto;max-height:250px;">
              <table class="table table-secondary table-striped">
                <thead>
                  <tr>
                    <th scope="col" style="color: black;">S.no</th>
                    <th scope="col" style="color: black;">Create_date</th>
                    <th scope="col" style="color: black;">Color</th>
                    <th scope="col" style="color: black;">Location</th>
                    <th scope="col" style="color: black;">Type</th>
  
                    <th scope="col" style="color: black;">Log_Time</th>
                    <th scope="col" style="color: black;">Run_Date</th>
                    <th scope="col" style="color: black;">Status</th>
                    <th scope="col" style="color: black;">Threat_type</th>
                    <th scope="col" style="color: black;">VehicleNo</th>
                    <th scope="col" style="color: black;">Message</th>
                    <!-- <th scope="col" style="color: black;">Trip id</th>
                    <th scope="col" style="color: black;">Mail_to</th> -->
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of threatHistorydata;let ind=index;">
                    <td>{{ind+1}}</td>
                    <td>{{item.create_date}}</td>
                    <td>
                      <label><i class="fa fa-square" [style.color]="item.color"></i></label>
                      <!-- <label >L:<i class="fa fa-square" [style.color]="item.colorS[1]"></i></label> -->
  
                    </td>
                    <td>
                      {{item.location}}
  
                    </td>
                    <td>
                      {{item.type}}
  
                    </td>
                    <td>{{item.log_time}}</td>
                    <td>{{item.run_date}}</td>
                    <td>{{item.status}}</td>
                    <td>{{item.threat_type}}</td>
                    <td>{{item.vehicle_name}}</td>
                    <td>{{item.message}}</td>
                    <td>
  
                    </td>
                    <!-- <td>{{item.grace_taken}}</td>
                    <td>{{item.trip_id}}</td>
                    <td>{{item.mail_to}}</td> -->
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <!-- <div class="modal-footer"> -->
  
  
        <!-- <i class="fe fe-truck" tooltipClass="customActive-tooltip-class" ngbTooltip="Device 1"
            style="font-size: 20px;color: blue;" id="blink"></i>
          <i class="fe fe-truck" tooltipClass="customInStopped-tooltip-class" ngbTooltip="Device 2"
            style="font-size: 20px;color: red;" id="blink"></i> -->
  
  
        <!-- <button type="button" class="btn btn" data-bs-dismiss="modal"
              style="background-color:#1c84c6;border-color: #1c84c6;color: white ;">Close</button> -->
  
        <!-- </div> -->
      </div>
    </div>
  </div>
  <!-- ///////////////////////////////////////////history on above alert////////////////////////////////// -->
  <div class="modal fade" id="historyAboveAlertDesk" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 1000px;">
      <div class="modal-content">
  
        <div class="modal-header" style="background-color: white;">
          <button type="button" class="btn btn-sm" data-bs-toggle="modal" data-bs-target="#triggerModal"
            aria-label="Close"><i class="fa fa-arrow-left" ngbTooltip="Back"></i></button>
          <h5 class="modal-title" id="exampleModalLabel" style="font-weight:500;margin-left: 305px;">Alert History</h5>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <Div class="col-lg-12">
            <label for="" style="background-color: grey;color: white;font-weight: 500;">Escalation History</label>&nbsp;
          </Div>
          <div>
            <div style="overflow: auto;overflow-y: auto;max-height:250px;">
              <table class="table table-secondary table-striped">
                <thead>
                  <tr>
                    <th scope="col" style="color: black;">S.no</th>
                    <th scope="col" style="color: black;">Escalation_Time</th>
                    <th scope="col" style="color: black;">Mail-To</th>
                    <th scope="col" style="color: black;">Level</th>
  
                    <th scope="col" style="color: black;">Mode</th>
                    <th scope="col" style="color: black;">Remark</th>
                    <th scope="col" style="color: black;">Status</th>
                    <th scope="col" style="color: black;">Trigger</th>
                    <th scope="col" style="color: black;">Trip-id</th>
                    <!-- <th scope="col" style="color: black;">Message</th> -->
                    <!-- <th scope="col" style="color: black;">Trip id</th>
                    <th scope="col" style="color: black;">Mail_to</th> -->
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of escaHistoryData[0];let ind=index;">
                    <td>{{ind+1}}</td>
                    <td>{{item.escalate_time}}</td>
                    <td>{{item.mail_to}}
                      <!-- <label >P:<i class="fa fa-square" [style.color]="item.colorS[0]"></i></label>&nbsp;
                     <label >L:<i class="fa fa-square" [style.color]="item.colorS[1]"></i></label> -->
  
                    </td>
                    <td>{{item.level}}
                      <!-- <label >P:{{item.levelS[0]}}</label>&nbsp;
                      <label >L:{{item.levelS[1]}}</label> -->
  
  
                    </td>
                    <td>{{item.mode}}</td>
                    <td>{{item.remarks}}</td>
                    <td>{{item.status}}</td>
                    <td>{{item.trigger_type}}</td>
                    <td>{{item.trip_id}}</td>
                    <!-- <td>{{item.message}}</td> -->
                    <td>
  
                    </td>
                    <!-- <td>{{item.grace_taken}}</td>
                    <td>{{item.trip_id}}</td>
                    <td>{{item.mail_to}}</td> -->
                  </tr>
                </tbody>
              </table>
            </div>
          </div>&nbsp;
          <!-- ///////////////////////////////////grace history/////////////////////////////////////// -->
          <Div class="col-lg-12">
            <label for="" style="background-color: grey;color: white;font-weight: 500;">Grace History</label>
          </Div>
          <div>
            <div style="overflow: auto;overflow-y: auto;max-height:250px;">
              <table class="table table-secondary table-striped">
                <thead>
                  <tr>
                    <th scope="col" style="color: black;">S.no</th>
                    <th scope="col" style="color: black;">Grace_requested</th>
                    <th scope="col" style="color: black;">Start_time</th>
                    <th scope="col" style="color: black;">Grace_taken</th>
  
                    <th scope="col" style="color: black;">mail_to</th>
                    <th scope="col" style="color: black;">Remark</th>
                    <th scope="col" style="color: black;">Status</th>
                    <th scope="col" style="color: black;">Trigger</th>
                    <th scope="col" style="color: black;">Trip_id</th>
                    <!-- <th scope="col" style="color: black;">Message</th> -->
                    <!-- <th scope="col" style="color: black;">Trip id</th>
                    <th scope="col" style="color: black;">Mail_to</th> -->
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of graceHistoryData[0];let ind=index;">
                    <td>{{ind+1}}</td>
                    <td>{{item.grace_period_requested}}</td>
                    <td>{{item.grace_period_starttime}}
                      <!-- <label >P:<i class="fa fa-square" [style.color]="item.colorS[0]"></i></label>&nbsp;
                     <label >L:<i class="fa fa-square" [style.color]="item.colorS[1]"></i></label> -->
  
                    </td>
                    <td>{{item.grace_taken}}
                      <!-- <label >P:{{item.levelS[0]}}</label>&nbsp;
                      <label >L:{{item.levelS[1]}}</label> -->
  
  
                    </td>
                    <td>{{item.mail_to}}</td>
                    <td>{{item.remarks}}</td>
                    <td>{{item.status}}</td>
                    <td>{{item.trigger_type}}</td>
                    <td>{{item.trip_id}}</td>
                    <!-- <td>{{item.message}}</td> -->
  
  
  
                    <!-- <td>{{item.grace_taken}}</td>
                    <td>{{item.trip_id}}</td>
                    <td>{{item.mail_to}}</td> -->
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
  
      </div>
    </div>
  </div>
  <!-- /////////////////////////////////alert model/////////////////////////////////////////////////////////////////////////////// -->
  
  <div class="modal fade" id="alertPopUp">
    <div class="modal-dialog">
      <div class="alert alert-primary" role="alert">
        <a class="close" data-dismiss="modal" aria-label="close">&times;</a>
        <strong>{{alertMessage}}</strong> 'UPDATED SUCCESSFULLY'
      </div>
    </div>
  </div>
  <!-- ////////////////////////////////////////history of qrt////////////////////////// -->
  <div class="modal fade" id="historyqrt" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 1000px;">
      <div class="modal-content">
  
        <div class="modal-header" style="background-color: white;">
          <!-- <button type="button" class="btn btn-sm" data-bs-toggle="modal" data-bs-target="#triggerModal"
          aria-label="Close"><i class="fa fa-arrow-left" ngbTooltip="Back"></i></button> -->
          <h5 class="modal-title" id="exampleModalLabel" style="font-weight:500;margin-left: 305px;">Qrt History</h5>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <!-- <Div class="col-lg-12">
            <label for="" style="background-color: grey;color: white;font-weight: 500;">Escalation History</label>&nbsp;
          </Div> -->
          <div>
            <div style="overflow: auto;overflow-y: auto;max-height:250px;">
              <table class="table table-secondary table-striped">
                <thead>
                  <tr>
                    <th scope="col" style="color: black;">S.no</th>
                    <th scope="col" style="color: black;">Time</th>
                    <th scope="col" style="color: black;">File</th>
                    <th scope="col" style="color: black;">Group_Id</th>
  
                    <th scope="col" style="color: black;">User</th>
                    <th scope="col" style="color: black;">Remark</th>
                    <th scope="col" style="color: black;">Trip_Id</th>
                    <th scope="col" style="color: black;">Status</th>
                    <!-- <th scope="col" style="color: black;">Trip-id</th> -->
  
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of qrtHistoryData;let ind=index;">
                    <td>{{ind+1}}</td>
                    <td>{{item.datetime}}</td>
                    <td>
                      <div *ngIf="item.file!=''">
                        <a type="button" [href]="item.file" target="_blank" download><img [src]="item.file" alt=""
                            style="width: 50px;height: 50px;"></a>
                      </div>
  
  
                    </td>
                    <td>{{item.group_id}}
  
  
  
                    </td>
                    <td>{{item.qrt_user}}</td>
                    <td>{{item.remarks}}</td>
                    <td>{{item.trip_id}}</td>
                    <td>{{item.type}}</td>
  
  
  
                  </tr>
                </tbody>
              </table>
            </div>
          </div>&nbsp;
          <div><button class="btn btn-outline-primary btn-sm" (click)="Closeqrt(qrtHistoryData[0].trip_id)"
              type="button">Close</button> </div>
          <!-- ///////////////////////////////////grace history/////////////////////////////////////// -->
  
        </div>
  
      </div>
    </div>
  </div>
  <!-- ///////////////////////////////////////////////alert show///////////////////////////////// -->
  <div class="modal fade" id="editwzalert">
    <div class="modal-dialog">
      <div class="alert alert-primary" role="alert">
        <a class="close" data-dismiss="modal" aria-label="close">&times;</a>
        {{alertMessage}}
      </div>
    </div>
  </div>
  <!-- ///////////////////////trigger log history dashboard/////////////////////////////////////////////////////////////////////// -->
  <div class="modal fade" id="triggerHistoryModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 1500px;margin-left: 140px;">
      <div class="modal-content" style="height: 634px; width: 835px;">
  
        <div class="modal-header" style="height: 45px;">
  
          <label for="" style="margin-left: 480px;font-weight: 500;font-size: 16px;">Trigger Report</label>
  
          <!-- <form #triggerHistoryForm="ngForm" (ngSubmit)="triggerHstSubmit(triggerHistoryForm.value)"> -->
  
  
  
          <!-- </form> -->
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
  
  
          <div class="col-lg-12">
            <div class="row">
              <div class="col-lg-2">
                <label for="" style="font-weight: 600;">Type</label>
              </div>
              <div class="col-lg-3">
                <label for="" style="font-weight: 600;">Threat/Trigger</label>
              </div>
              <div class="col-lg-3">
                <label for="" style="font-weight: 600;">From Date</label>
              </div>
              <div class="col-lg-3">
                <label for="" style="font-weight: 600;">To Date</label>
              </div>
            </div>
          </div>
          <div>
            <form #triggerHistoryForm="ngForm" (ngSubmit)="triggerHstSubmit(triggerHistoryForm.value)">
              <div class="col-lg-12">
                <div class="row">
                  <div class="col-lg-2">
                    <ng-select placeholder="" ngModel (change)="triggerreportTypf($event)" name="type">
                      <ng-option value="" selected>--Select Type--</ng-option>
                      <ng-option value="2">Threat</ng-option>
                      <ng-option value="1">Trigger</ng-option>
                      <ng-option value="all">All</ng-option>
  
                    </ng-select>
                  </div>
                  <div class="col-lg-3">
                    <ng-select *ngIf="triggerReportFlag==true" name="trigger_type" placeholder="Select Trigger"
                      id="ShipmentNo" (change)="trigerHistorycheckF($event)" [ngModel]="ShipmentNo" [multiple]="true"
                      [closeOnSelect]="true" [disabled]="ReportTypeFlag">
                      <!-- <ng-option value="" selected>--Select Shipment--</ng-option> -->
                      <ng-option *ngFor="let item of alertData  | keyvalue"
                        [value]="item.value">{{item.value}}</ng-option>
  
                    </ng-select>
                    <ng-select *ngIf="treatReportFlag==true" name="trigger_type" placeholder="Select Threat"
                      id="ShipmentNo" (change)="threatHistorycheckF($event)" [ngModel]="ShipmentNo" [multiple]="true"
                      [closeOnSelect]="true">
                      <!-- <ng-option value="" selected>--Select Shipment--</ng-option> -->
                      <ng-option *ngFor="let key of Object.keys(threatsdata)"
                        [value]="threatsdata[key].name">{{threatsdata[key].name}}</ng-option>
  
  
                    </ng-select>
                  </div>
                  <div class="col-lg-3">
                    <div class='input-group date' id='datetimepicker1'>
                      <input type="datetime-local" step="1" class="form-control" [ngModel]="datetimepicker1" required
                        name="from_time" />
  
                    </div>
                  </div>
                  <div class="col-lg-3">
                    <div class='input-group date' id='datetimepicker1'>
                      <input type="datetime-local" step="1" class="form-control" [ngModel]="datetimepicker1" required
                        name="to_time" />
  
                    </div>
                  </div>
                  <div class="col-lg-1">
                    <button class="btn btn-outline-primary btn-sm" type="submit" id="csvDownload">View</button>
                  </div>
                </div>
              </div>
            </form>
          </div>
          <hr>
          <div style="overflow-y: auto;">
            <ngx-spinner bdColor="rgba(51, 51, 51, 0.8)" size="default" [fullScreen]="true" type="ball-spin-clockwise">
              <p style="color: black">Please Wait.. </p>
            </ngx-spinner>
            <table class="display nowrap  table" cellspacing="0" id="triggerHistoryTable">
  
  
              <thead>
                <tr style="text-align: center;">
                  <th class="table-primary">S.No.</th>
  
                  <th class="table-primary">Type</th>
                  <th class="table-primary">Alert Type</th>
                  <!-- <th class="table-primary">Created By</th> -->
                  <th class="table-primary">Vehicle</th>
                  <th class="table-primary">GPS Device Imei</th>
                  <!-- <th class="table-primary">Fixed Elock Imei</th>
                  <th class="table-primary">Portable Elock Imei</th> -->
                  <th class="table-primary">Trip Id</th>
                  <th class="table-primary">Run Date</th>
                  <th class="table-primary">Source</th>
                  <th class="table-primary">Destination</th>
                  <th class="table-primary">Route Sequence</th>
  
  
                  <th class="table-primary">Transporter</th>
  
                  <th class="table-primary">Trigger Status</th>
                  <th class="table-primary">Trigger Start Date</th>
                  <th class="table-primary">Trigger End Date</th>
                  <th class="table-primary">Trigger Recieve Date</th>
                  <th class="table-primary">Close Date</th>
                  <th class="table-primary">Trigger Loc Address</th>
                  <th class="table-primary">Trigger Closed BY(Name)</th>
                  <th class="table-primary">Remarks</th>
                  <th class="table-primary">Driver</th>
                  <!-- <th class="table-primary">Trigger Start Date</th> -->
                  <!-- <th class="table-primary">Fixed Elock Imei</th> -->
                  <!-- <th class="table-primary">Portable Elock Imei</th> -->
  
                  <th class="table-primary">Count of Grace Period</th>
                  <!-- <th class="table-primary">Trip Status</th> -->
                  <!-- <th class="table-primary">Created By</th> -->
                  <!-- <th class="table-primary">Trip End Date</th> -->
  
                  <!-- //////////////////////////////////////////////////////////////////////////////////// -->
  
  
  
                </tr>
  
              </thead>
              <tbody>
                <tr *ngFor="let item of triggerFulldataReport[0];let ind=index" style="text-align: center;">
                  <td>{{ind+1}}</td>
  
                  <td>
                    {{item.type}}
                  </td>
                  <!-- <td> {{item.AlertType}}</td> -->
                  <td style="text-align:left ;">{{item.trigger}}
  
                    <!-- </td>
                  <td> -->
  
                  </td>
                  <td>{{item.vehicle_name}}</td>
                  <td>{{item.imei_no}}</td>
                  <!-- <td>
  
                  </td>
                  <td>
  
                  </td> -->
                  <td>{{item.trip_id}}</td>
  
                  <td>{{item.run_date}}</td>
                  <td>{{item.source}}</td>
                  <td>{{item.destination}}</td>
                  <td>{{item.route_sequence}}</td>
  
                  <!-- <td>{{item.push_by}}</td> -->
                  <td>{{item.transporter_name}}</td>
  
                  <td>{{item.status}}</td>
                  <td>{{item.start_time}}</td>
                  <td>{{item.end_time}}</td>
                  <td>{{item.log_time}}</td>
                  <td>
                    {{item.close_date}}
                  </td>
                  <td>{{item.location}}</td>
                  <td>{{item.alert_closeby}}</td>
                  <td>{{item.remarks}}</td>
                  <td>{{item.driver_name}}</td>
                  <td>
  
                    <!-- </td>
                  <td>
  
                  </td>
                  
                  
                  <td> -->
                    {{item.grace_period_taken}}
                  </td>
                  <!-- <td>
                    
                  </td>
                  <td>
                    
                  </td>
                  <td>
                    
                  </td> -->
  
  
  
                </tr>
              </tbody>
            </table>
          </div>
  
        </div>
  
        <!-- <div class="modal-footer" >
  
  
             <i class="fe fe-truck" tooltipClass="customActive-tooltip-class" ngbTooltip="Device 1"
            style="font-size: 20px;color: blue;" id="blink"></i>
           <i class="fe fe-truck" tooltipClass="customInStopped-tooltip-class" ngbTooltip="Device 2"
            style="font-size: 20px;color: red;" id="blink"></i> -->
  
  
        <!-- <button type="button" class="btn btn" data-bs-dismiss="modal"
              style="background-color:#1c84c6;border-color: #1c84c6;color: white ;">Close</button> -->
  
        <!-- </div> -->
  
      </div>
  
    </div>
  </div>
  <!-- ///////////////////////////////////////assign priorety/////////////////////////////////////////////////// -->
  <div class="modal fade" id="prioretyModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width: 500px;margin-left: 458px;">
      <div class="modal-content" style="height: 120px;">
  
        <div class="modal-header" style="background-color: white;height: 45px;">
          <label for="" style="color: red;margin-left: 103px;">Make High Priority Trip</label>
          <!-- <button type="button" class="btn btn-sm" data-bs-toggle="modal" aria-label="Close"><i class="fa fa-arrow-left"
              ngbTooltip="Back"></i></button> -->
          <!-- <h3 class="modal-title" id="exampleModalLabel"
            style="margin-left: 220px;font-weight:700; color :#1c84c6;font-size: initial;"></h3> -->
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form #priorety="ngForm" (ngSubmit)="prioretySubmit(priorety.value)">
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-6">
                  <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio1"
                      value="shipment" (change)="changeHighP($event)" checked>
                    <label class="form-check-label" for="inlineRadio1">Shipment No.</label>
                  </div>
                </div>
                <div class="col-lg-6">
                  <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio2"
                      value="vehicle" (change)="changeHighP($event)">
                    <label class="form-check-label" for="inlineRadio2">Vehicle No.</label>
                  </div>
                </div>
              </div>
  
  
            </div>&nbsp;
  
  
            <div class="col-lg-12">
              <div class="row">
                <div class="col-lg-4" id="newtrip" *ngIf="shipmentcheckFlag">
                  Shipment(ID)
                </div>
                <div class="col-lg-4" id="newtrip" *ngIf="vehicleCheckFlag">
                  Vehicle No.
                </div>
                <div class="col-lg-8">
                  <ng-select name="subassets" *ngIf="shipmentcheckFlag" placeholder="" ngModel name="shipment_No"
                    (change)="prioretySetF($event)" required [multiple]="true" [closeOnSelect]="true">
                    <ng-option value="" selected>--Select Trip--</ng-option>
                    <ng-option *ngFor="let item of alltrip |keyvalue" [value]="item.value">{{item.key}}</ng-option>
                    <!-- <ng-option *ngFor="let item of Object.keys(alltrip)" [value]="alltrip[item]
                    ">{{alltrip[item].vehicle_no}}</ng-option> -->
  
  
  
  
                  </ng-select>
                  <ng-select name="subassets" *ngIf="vehicleCheckFlag" placeholder="" ngModel name="shipment_No"
                    (change)="prioretySetF($event)" required [multiple]="true" [closeOnSelect]="true">
                    <ng-option value="" selected>--Select Vehicle--</ng-option>
                    <!-- <ng-option *ngFor="let item of alltrip |keyvalue" [value]="item.value">{{item.key}}</ng-option> -->
                    <ng-option *ngFor="let item of Object.keys(alltrip)" [value]="alltrip[item] 
                  ">{{alltrip[item].vehicle_no}}</ng-option>
  
  
  
  
                  </ng-select>
                </div>
  
  
              </div>
            </div>&nbsp;&nbsp;
  
  
  
            <div class="col-lg-12">
              <button class="btn btn-outline-primary btn-sm" type="submit" id="AlertButton"
                style="margin-top: 15px;margin-left: 242px;">Submit</button>
              <!-- [disabled]="!newTrip.form.valid" -->
            </div>&nbsp;&nbsp;
  
          </form>
        </div>
  
      </div>
    </div>
  </div>
  <!-- ////////////////////////////////////////unset priority////////////////////////////////////////////////////// -->
  <div class="modal fade " id="remove_priority" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="staticBackdropLabel" aria-hidden="true">
  
  
    <div class="modal-dialog" style="margin-top: 245px;">
      <div class="modal-content">
        <form>
  
          <!-- Modal Header -->
          <!-- <div class="modal-header" style="background-color: white;">
                      
                  
                     
                  </div> -->
  
          <!-- Modal body -->
          <div class="modal-body">
            <div class="col-lg-12">
              <label for="" style="margin-top: 5px;color: red;">This Trip is in High Priority! Do you want to
                Set on Normal Mode?</label>
            </div>
  
  
  
  
          </div>
          <div class="modal-footer" style="height: 50px;background-color: white;">
            <button type="button" class="btn btn-outline-danger btn-sm" (click)="RemoveprioretySubmit()"
              style="margin-top: -3px;">Yes</button>&nbsp;
            <button type="button" class="btn btn-outline-primary btn-sm" data-bs-dismiss="modal"
              style="margin-top: -3px;">No</button>
          </div>
  
  
  
  
  
  
        </form>
  
      </div>
    </div>
  </div>
  <div class="modal fade" id="gracealert">
    <div class="modal-dialog">
      <div class="alert alert-primary" role="alert">
        <a class="close" data-dismiss="modal" aria-label="close">&times;</a>
  
  
  
        Grace Time Expired: &nbsp;Alert:{{graceAlert.alert_type}},&nbsp;Shipment Number:{{graceAlert.shipment_no}}
      </div>
    </div>
  </div>
  <!-- /////////////////////////////////////////////chart////////////////////////////////////////////////////// -->
  <div class="modal fade " id="chart" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="staticBackdropLabel" aria-hidden="true">
  
  
    <div class="modal-dialog" style="margin-top: 245px;max-width: 1000px;">
      <div class="modal-content">
        <form>
  
          <!-- Modal Header -->
          <div class="modal-header" style="background-color: white;">
  
            <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
  
          </div>
  
          <!-- Modal body -->
          <div class="modal-body">
            <div class="col-lg-12">
  
            </div>
            <div class="col-lg-12">
              <div>
                <canvas id="myChart"></canvas>
              </div>
            </div>
  
  
  
  
          </div>
          <div class="modal-footer" style="height: 50px;background-color: white;">
  
          </div>
  
  
  
  
  
  
        </form>
  
      </div>
    </div>
  </div>
  <!-- //////////////////////////////////////////////////critical msg notification//////////////////////////////////////////////// -->
  <div class="modal fade" id="criticalMsg" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="alert alert-secondary" role="alert">
  
          <h4 style="font-size: 25px;" id="criticalMsgid">Critical Alert <i class="fa fa-exclamation-triangle"
              style="size: 25px; color: red;"></i></h4>
        </div>
        <div style="position: relative;z-index: 100;margin-top: -64px;">
          <!-- <button  class="btn btn-outline-danger" ></button> -->
          <button type="button" class="btn btn-outline-primary btn-sm" style="margin-left: 305px;"
            (click)="hideCriticlamsg()">View</button>
          <button type="button" class="btn btn-outline-danger btn-sm" style="margin-left: 365px;margin-top: -52px;"
            (click)="ClosehideCriticlamsg()">
            <i class="fa fa-close" ngbTooltip="close"></i></button>
        </div>
      </div>
    </div>
  </div>
  
  
  
  <!-- view chart  -->
  <div class="modal fade" id="ViewModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" style=" max-width:1658px;height: 45px;     margin-left: 171px;
      width: 1658px;">
      <div class="modal-content">
  
        <div class="modal-header" style="height: 60px;background-color: white;">
          <h5 class="modal-title" id="exampleModalLabel" style="    font-weight: 500;
          margin-left: 22px;
          color: #1D4380;">
            Alert Dashboard</h5>
          <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="container-fluid" style="    height: 500px;
      overflow: auto;">
            <div class="row">
              <ng-container *ngFor="let ch of alert_keys">
                <!-- <div [id]="ch.id" style="height:300px;width:510px; padding:0px  !important;margin:0px  !important;background:none !important">
            </div> -->
                <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12 mb-0">
                  <div class="card status-card">
                    <div class="card-body">
                      <h6 class="card-title" style="    width: 85%;">{{ch}}</h6>
                      <div class="row">
                        <div class="col-6">
                          <div id="consSt" class="chart-container" _echarts_instance_="ec_1729747370784"
                            style="height: 200px; width: 100%; -webkit-tap-highlight-color: transparent; user-select: none; position: relative;">
                            <div
                              style="position: relative; width: 137px; height: 200px; padding: 0px; margin: 0px; border-width: 0px; cursor: default;">
                             
                              <canvas data-zr-dom-id="zr_0" width="171" height="250" [id]="ch"
                                style="position: absolute;     left: -12px;top: 15px; width: 137px; height: 200px; user-select: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); padding: 0px; margin: 0px; border-width: 0px;"></canvas>
                            </div>
                            <div class=""
                              style="position: absolute; display: block; border-style: solid; white-space: nowrap; z-index: 9999999; box-shadow: rgba(0, 0, 0, 0.2) 1px 2px 10px; transition: opacity 0.2s cubic-bezier(0.23, 1, 0.32, 1), visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), transform 0.4s cubic-bezier(0.23, 1, 0.32, 1); background-color: rgb(255, 255, 255); border-width: 1px; border-radius: 4px; color: rgb(102, 102, 102); font: 14px / 21px ; padding: 10px; top: 0px; left: 0px; transform: translate3d(-172px, 97px, 0px); border-color: grey; pointer-events: none; visibility: hidden; opacity: 0;">
                              Vehicle Status <br>In-Active: 2105 (54.32%)</div>
                          </div>
                        </div>
                        <div _ngcontent-dki-c122="" class="col-6" style="margin-top: -33px; ">
                          <!-- <img  src="assets/images/vehiclestatusnew.png" alt="Vehicle Status"style="height: 50%;"> -->
                          <button class=" dropdown-toggle viewall-icon" type="button" id="dropdownMenuButton"
                            data-bs-toggle="dropdown" aria-expanded="false" style="    margin-left: 74px;">
                            <img [src]="getIconUrlByTitle(ch)" class="img-view">
                          </button>
                          <ul class="dropdown-menu scrollable" aria-labelledby="dropdownMenuButton" id="myDropdownroute">
                            <li style="font-weight: bold;">{{ch}}</li>
                            <li _ngcontent-mrr-c230=""> 
                              <a class="dropdown-item a-score" (click)="filterAlerts(ch,30,0)">
                                &lt; 30 Minutes
                                <div class="score-show" style="background: #E77817;">{{alert_dashboard[ch]?.min_30}}</div>
                              </a>
                            </li>
                          
                            <li><a class="dropdown-item  a-score" (click)="filterAlerts(ch,60,30)">
                                < 1 Hours <div class="score-show" style="background:#1D4380 ;">{{alert_dashboard[ch]?.hr_1}}
                                  </div>
                              </a>
                            </li>
                            <li><a class="dropdown-item  a-score" (click)="filterAlerts(ch,120,60)">
                                < 2 Hours <div class="score-show" style="background: #00C0F3;">{{alert_dashboard[ch]?.hr_2}}
                                  </div>
                              </a>
                            </li>
                            <li><a class="dropdown-item  a-score" (click)="filterAlerts(ch,180,120)">
                                < 4 Hours <div class="score-show" style="background: #F4858E;">{{alert_dashboard[ch]?.hr_3}}
                                  </div>
                              </a>
                            </li>
                            <li><a class="dropdown-item  a-score" (click)="filterAlerts(ch,240,180)">
                                > 4 Hours
                                <div class="score-show" style="background: #917BB9;">{{alert_dashboard[ch]?.hr_4}}</div>
                              </a>
                            </li>
                          </ul>
                  </div>
                  <div _ngcontent-dki-c122="" class="col-12 mt-0 custom">
                    <!-- <ng-container *ngFor="let ch of alert_keys"> -->
                    <span _ngcontent-dki-c122="" id="numberH"
                      class="status-text" style="color: #E77817;">{{alert_dashboard[ch]?.min_30}}</span>/ <span _ngcontent-dki-c122="" id="numberH"
                      class="status-text" style="color: #00C0F3;">{{alert_dashboard[ch]?.hr_1}}</span>/ <span _ngcontent-dki-c122="" id="numberH"
                      class="status-text" style="color: #1D4380;">{{alert_dashboard[ch]?.hr_2}}</span>/
                    <span _ngcontent-dki-c122="" id="numberH" class="status-text" style="color: #F4858E;">{{alert_dashboard[ch]?.hr_3}}</span>/
                    <span _ngcontent-dki-c122="" id="numberH" class="status-text" style="color: #917BB9;">{{alert_dashboard[ch]?.hr_4}}</span>
                    <!-- </ng-container> -->
                  </div>
                </div>
                <div _ngcontent-dki-c122="" class=" mt-2 row">
                  <div class="col-lg-6">
                    <span><i class="fa fa-circle" style="margin-right: 2px;color: #E77817; "></i>
                      < 30 Minutes </span><br>
  
                        <span><i class="fa fa-circle" style="margin-right: 2px; color: #00C0F3 ;"></i>
                          < 2 Hours </span><br>
                            <span><i class="fa fa-circle" style="margin-right: 2px; color: #F4858E;"></i>
                              < 4 Hours </span>
                  </div>
                  <div class="col-lg-6">
                    <span><i class="fa fa-circle" style="margin-right: 2px ; color: #1D4380; "></i>
                      < 1 Hours</span><br>
                        <span><i class="fa fa-circle" style="margin-right: 2px ; color: #F4858E; "></i> > 4 Hours
                        </span><br>
                  </div>
                </div>
            </div>
          </div>
        </div>
        </ng-container>
      </div>
    </div>
  </div>
  
  </div>
  
  </div>
  </div>